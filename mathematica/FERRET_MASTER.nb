(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    218450,       5880]
NotebookOptionsPosition[    198058,       5508]
NotebookOutlinePosition[    198451,       5524]
CellTagsIndexPosition[    198408,       5521]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Ferret Kernels", "Title",
 CellChangeTimes->{{3.823147949585373*^9, 3.8231479625615892`*^9}, {
  3.8231482825621843`*^9, 
  3.8231482983462257`*^9}},ExpressionUUID->"ebc18a75-c4e1-49dd-838b-\
d0c8ff912763"],

Cell[CellGroupData[{

Cell["    Preliminary functions", "Chapter",
 CellChangeTimes->{{3.8231479859528847`*^9, 3.823147988441524*^9}, {
  3.823148022767866*^9, 
  3.823148027497468*^9}},ExpressionUUID->"5441bba2-423a-4c0d-9ffc-\
e5edeeb48100"],

Cell[CellGroupData[{

Cell["        Unit conversion", "Section",
 CellChangeTimes->{{3.8231479988646517`*^9, 
  3.8231480311988077`*^9}},ExpressionUUID->"12bd110e-b09a-44f8-841e-\
9c5d197e841e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"func", "[", 
   RowBox[{"value_", ",", "inputUnits_", ",", "outputUnits_"}], "]"}], ":=", 
  RowBox[{"UnitConvert", "[", 
   RowBox[{
    RowBox[{"Quantity", "[", 
     RowBox[{"value", ",", "inputUnits"}], "]"}], ",", "outputUnits"}], 
   "]"}]}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"6d9b666e-5dbb-46fd-94e7-33aef6aafa8a"],

Cell["An example:", "Text",
 CellChangeTimes->{{3.823148151317663*^9, 
  3.823148152597856*^9}},ExpressionUUID->"ca3e17df-ac3b-40d1-aa84-\
f547bd858c35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MassScale", "=", "\"\<Picograms\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeScale", "=", "\"\<Microseconds\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LengthScale", "=", "\"\<Micrometers\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.823148164695219*^9, 3.823148203932562*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"605aba92-17ae-4205-91d8-9a7659e9a384"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"func", "[", 
  RowBox[{
   RowBox[{"1.30", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "11"}]]}], ",", 
   FractionBox[
    RowBox[{"\"\<Kilograms\>\"", 
     SuperscriptBox["\"\<Meters\>\"", "2"]}], 
    RowBox[{
     SuperscriptBox["\"\<Seconds\>\"", "2"], "\"\<Meters\>\""}]], ",", 
   FractionBox[
    RowBox[{"MassScale", " ", 
     SuperscriptBox["LengthScale", "2"]}], 
    RowBox[{
     SuperscriptBox["TimeScale", "2"], "LengthScale"}]]}], "]"}]], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"1892d17d-27b2-4b8b-94dc-87869d71f4fa"],

Cell[BoxData[
 TemplateBox[{"0.013000000000000001`", 
   RowBox[{
    "\"pg\"", "\[ThinSpace]", "\"\[Micro]m\"", "\[InvisibleSpace]", "\"/\"", 
     "\[InvisibleSpace]", 
     SuperscriptBox["\"\[Micro]s\"", "2"]}], 
   "picogram micrometers per microsecond squared", 
   FractionBox[
    RowBox[{"\"Micrometers\"", " ", "\"Picograms\""}], 
    SuperscriptBox["\"Microseconds\"", "2"]]},
  "Quantity"]], "Output",
 CellChangeTimes->{3.823148210258013*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"77e9a8ef-d9a0-4014-ac75-8d5c8a14140a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        Symmetry operations and notations", "Section",
 CellChangeTimes->{{3.823148013520158*^9, 3.823148033711926*^9}, {
  3.823148121190465*^9, 
  3.8231481224701643`*^9}},ExpressionUUID->"db5ce5f6-8789-4b65-95a7-\
18a927eaeca8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VT2", "[", 
    RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Transform", " ", "rank", " ", "2", " ", "tensor", " ", "to", " ", 
        "Voight", " ", 
        RowBox[{"notation", ".", " ", "\[IndentingNewLine]", "Note"}], " ", 
        "we", " ", "use", " ", "11"}], "\[Rule]", "1"}], ",", 
      RowBox[{"22", "\[Rule]", "2"}], ",", 
      RowBox[{"33", "\[Rule]", "3"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"23", ",", "32"}], "}"}], "\[Rule]", "4"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "31"}], "}"}], "\[Rule]", "5"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"12", ",", "21"}], "}"}], "\[Rule]", 
       RowBox[{"6", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "6", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "5", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "4", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "6", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "5", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "4", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "3", "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7944800737222223`*^9, 3.794480088125193*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"1ca755ac-49aa-43df-b917-d8a909ba1ddf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VT4", "[", 
    RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Transform", " ", "rank", " ", "4", " ", "tensor", " ", "to", " ", 
        "Voight", " ", 
        RowBox[{"notation", ".", " ", "\[IndentingNewLine]", "Note"}], " ", 
        "we", " ", "use", " ", "11"}], "\[Rule]", "1"}], ",", 
      RowBox[{"22", "\[Rule]", "2"}], ",", 
      RowBox[{"33", "\[Rule]", "3"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"23", ",", "32"}], "}"}], "\[Rule]", "4"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "31"}], "}"}], "\[Rule]", "5"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"12", ",", "21"}], "}"}], "\[Rule]", 
       RowBox[{"6", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "6"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "5"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "5"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "2"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "4"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "4"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "4"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "4"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "3"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "2"}], "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.794222797075919*^9, 3.7942228260771847`*^9}, {
   3.794222930105603*^9, 3.794222946199676*^9}, {3.794223700003508*^9, 
   3.794223714626367*^9}, 3.8231480777005787`*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"c5ff5347-cd13-4494-820b-16853e833e42"],

Cell[BoxData[
 RowBox[{"genSym", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", "C11"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", "C22"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"3", ",", "3"}], "]"}], "\[Rule]", "C33"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"4", ",", "4"}], "]"}], "\[Rule]", "C44"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"5", ",", "5"}], "]"}], "\[Rule]", "C55"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"6", ",", "6"}], "]"}], "\[Rule]", "C66"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", "C12"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "C12"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"1", ",", "3"}], "]"}], "\[Rule]", "C13"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"3", ",", "1"}], "]"}], "\[Rule]", "C13"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"1", ",", "4"}], "]"}], "\[Rule]", "C14"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"4", ",", "1"}], "]"}], "\[Rule]", "C14"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"1", ",", "5"}], "]"}], "\[Rule]", "C15"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"5", ",", "1"}], "]"}], "\[Rule]", "C15"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"1", ",", "6"}], "]"}], "\[Rule]", "C16"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"6", ",", "1"}], "]"}], "\[Rule]", "C16"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"2", ",", "3"}], "]"}], "\[Rule]", "C23"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"3", ",", "2"}], "]"}], "\[Rule]", "C23"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"2", ",", "4"}], "]"}], "\[Rule]", "C24"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"4", ",", "2"}], "]"}], "\[Rule]", "C24"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"2", ",", "5"}], "]"}], "\[Rule]", "C25"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"5", ",", "2"}], "]"}], "\[Rule]", "C25"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"2", ",", "6"}], "]"}], "\[Rule]", "C26"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"6", ",", "2"}], "]"}], "\[Rule]", "C26"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"3", ",", "4"}], "]"}], "\[Rule]", "C34"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"4", ",", "3"}], "]"}], "\[Rule]", "C34"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"3", ",", "5"}], "]"}], "\[Rule]", "C35"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"5", ",", "3"}], "]"}], "\[Rule]", "C35"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"3", ",", "6"}], "]"}], "\[Rule]", "C36"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"6", ",", "3"}], "]"}], "\[Rule]", "C36"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"4", ",", "5"}], "]"}], "\[Rule]", "C45"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"5", ",", "4"}], "]"}], "\[Rule]", "C45"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"4", ",", "6"}], "]"}], "\[Rule]", "C46"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"6", ",", "4"}], "]"}], "\[Rule]", "C46"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"5", ",", "6"}], "]"}], "\[Rule]", "C56"}], ",", 
    RowBox[{
     RowBox[{"cij", "[", 
      RowBox[{"6", ",", "5"}], "]"}], "\[Rule]", "C56"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", "\[Lambda]11"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", "\[Lambda]22"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"3", ",", "3"}], "]"}], "\[Rule]", "\[Lambda]33"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"4", ",", "4"}], "]"}], "\[Rule]", "\[Lambda]44"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"5", ",", "5"}], "]"}], "\[Rule]", "\[Lambda]55"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"6", ",", "6"}], "]"}], "\[Rule]", "\[Lambda]66"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", "\[Lambda]12"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "\[Lambda]12"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"1", ",", "3"}], "]"}], "\[Rule]", "\[Lambda]13"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"3", ",", "1"}], "]"}], "\[Rule]", "\[Lambda]13"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"1", ",", "4"}], "]"}], "\[Rule]", "\[Lambda]14"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"4", ",", "1"}], "]"}], "\[Rule]", "\[Lambda]14"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"1", ",", "5"}], "]"}], "\[Rule]", "\[Lambda]15"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"5", ",", "1"}], "]"}], "\[Rule]", "\[Lambda]15"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"1", ",", "6"}], "]"}], "\[Rule]", "\[Lambda]16"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"6", ",", "1"}], "]"}], "\[Rule]", "\[Lambda]16"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"2", ",", "3"}], "]"}], "\[Rule]", "\[Lambda]23"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"3", ",", "2"}], "]"}], "\[Rule]", "\[Lambda]23"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"2", ",", "4"}], "]"}], "\[Rule]", "\[Lambda]24"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"4", ",", "2"}], "]"}], "\[Rule]", "\[Lambda]24"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"2", ",", "5"}], "]"}], "\[Rule]", "\[Lambda]25"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"5", ",", "2"}], "]"}], "\[Rule]", "\[Lambda]25"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"2", ",", "6"}], "]"}], "\[Rule]", "\[Lambda]26"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"6", ",", "2"}], "]"}], "\[Rule]", "\[Lambda]26"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"3", ",", "4"}], "]"}], "\[Rule]", "\[Lambda]34"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"4", ",", "3"}], "]"}], "\[Rule]", "\[Lambda]34"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"3", ",", "5"}], "]"}], "\[Rule]", "\[Lambda]35"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"5", ",", "3"}], "]"}], "\[Rule]", "\[Lambda]35"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"3", ",", "6"}], "]"}], "\[Rule]", "\[Lambda]36"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"6", ",", "3"}], "]"}], "\[Rule]", "\[Lambda]36"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"4", ",", "5"}], "]"}], "\[Rule]", "\[Lambda]45"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"5", ",", "4"}], "]"}], "\[Rule]", "\[Lambda]45"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"4", ",", "6"}], "]"}], "\[Rule]", "\[Lambda]46"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"6", ",", "4"}], "]"}], "\[Rule]", "\[Lambda]46"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"5", ",", "6"}], "]"}], "\[Rule]", "\[Lambda]56"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"6", ",", "5"}], "]"}], "\[Rule]", "\[Lambda]56"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"e", "[", "1", "]"}], "\[Rule]", "exx"}], ",", 
    RowBox[{
     RowBox[{"e", "[", "2", "]"}], "\[Rule]", "eyy"}], ",", 
    RowBox[{
     RowBox[{"e", "[", "3", "]"}], "\[Rule]", "ezz"}], ",", 
    RowBox[{
     RowBox[{"e", "[", "4", "]"}], "\[Rule]", "exy"}], ",", 
    RowBox[{
     RowBox[{"e", "[", "5", "]"}], "\[Rule]", "exz"}], ",", 
    RowBox[{
     RowBox[{"e", "[", "6", "]"}], "\[Rule]", "eyz"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.794483014767729*^9, 3.794483021996986*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"41463e50-7284-440c-8cc6-a950be1e6611"],

Cell[BoxData[{
 RowBox[{"cubicSymC", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"C14", "\[Rule]", "0"}], ",", 
    RowBox[{"C15", "\[Rule]", "0"}], ",", 
    RowBox[{"C16", "\[Rule]", "0"}], ",", 
    RowBox[{"C24", "\[Rule]", "0"}], ",", 
    RowBox[{"C25", "\[Rule]", "0"}], ",", 
    RowBox[{"C26", "\[Rule]", "0"}], ",", 
    RowBox[{"C34", "\[Rule]", "0"}], ",", 
    RowBox[{"C35", "\[Rule]", "0"}], ",", 
    RowBox[{"C36", "\[Rule]", "0"}], ",", 
    RowBox[{"C45", "\[Rule]", "0"}], ",", 
    RowBox[{"C46", "\[Rule]", "0"}], ",", 
    RowBox[{"C56", "\[Rule]", "0"}], ",", 
    RowBox[{"C22", "\[Rule]", "C11"}], ",", 
    RowBox[{"C33", "\[Rule]", "C11"}], ",", 
    RowBox[{"C55", "\[Rule]", "C44"}], ",", 
    RowBox[{"C66", "\[Rule]", "C44"}], ",", 
    RowBox[{"C23", "\[Rule]", "C12"}], ",", 
    RowBox[{"C13", "\[Rule]", "C12"}], ",", 
    RowBox[{"C23", "\[Rule]", "C12"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"cubicSym\[Lambda]", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Lambda]14", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Lambda]15", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Lambda]16", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Lambda]24", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Lambda]25", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Lambda]26", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Lambda]34", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Lambda]35", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Lambda]36", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Lambda]45", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Lambda]46", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Lambda]56", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Lambda]22", "\[Rule]", "\[Lambda]11"}], ",", 
    RowBox[{"\[Lambda]33", "\[Rule]", "\[Lambda]11"}], ",", 
    RowBox[{"\[Lambda]55", "\[Rule]", "\[Lambda]44"}], ",", 
    RowBox[{"\[Lambda]66", "\[Rule]", "\[Lambda]44"}], ",", 
    RowBox[{"\[Lambda]23", "\[Rule]", "\[Lambda]12"}], ",", 
    RowBox[{"\[Lambda]13", "\[Rule]", "\[Lambda]12"}], ",", 
    RowBox[{"\[Lambda]23", "\[Rule]", "\[Lambda]12"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.794482474064372*^9, 3.79448250176993*^9}, {
  3.794482834882882*^9, 3.794482858120916*^9}, {3.794482972859342*^9, 
  3.794482984618991*^9}, {3.794483030923977*^9, 3.794483147678667*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"3f3ef607-eab7-49df-be8a-c4b276db9b8a"]
}, Closed]],

Cell[CellGroupData[{

Cell["        Weak form algebra ", "Section",
 CellChangeTimes->{{3.823148216637491*^9, 
  3.823148238833702*^9}},ExpressionUUID->"2e54c9af-338a-4b60-a60b-\
94baa3d3602f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"varvec", "=", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "y", ",", "z", ",", "x", ",", "y", ",", "z", ",", "x", ",", "y",
      ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intByParts1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d2mxdx2", "\[Rule]", 
      RowBox[{"-", "dmxdx"}]}], ",", 
     RowBox[{"d2mxdy2", "\[Rule]", 
      RowBox[{"-", "dmxdy"}]}], ",", 
     RowBox[{"d2mxdz2", "\[Rule]", 
      RowBox[{"-", "dmxdz"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"d2mydx2", "\[Rule]", 
      RowBox[{"-", "dmydx"}]}], ",", 
     RowBox[{"d2mydy2", "\[Rule]", 
      RowBox[{"-", "dmydy"}]}], ",", 
     RowBox[{"d2mydz2", "\[Rule]", 
      RowBox[{"-", "dmydz"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"d2mzdx2", "\[Rule]", 
      RowBox[{"-", "dmzdx"}]}], ",", 
     RowBox[{"d2mzdy2", "\[Rule]", 
      RowBox[{"-", "dmzdy"}]}], ",", 
     RowBox[{"d2mzdz2", "\[Rule]", 
      RowBox[{"-", "dmzdz"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"mx", "\[Rule]", 
      RowBox[{"mx", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
     RowBox[{"my", "\[Rule]", 
      RowBox[{"my", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
     RowBox[{"mz", "\[Rule]", 
      RowBox[{"mz", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", 
      RowBox[{"\[Psi]h", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intByParts2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdx"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydx"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdx"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdy"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydy"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdy"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdz"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydz"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mx", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "mx"}], ",", 
     RowBox[{
      RowBox[{"my", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "my"}], ",", 
     RowBox[{
      RowBox[{"mz", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "mz"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Psi]h", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "d\[Psi]hdx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Psi]h", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "d\[Psi]hdy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Psi]h", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "d\[Psi]hdz"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Psi]h", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "\[Psi]h"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"algFEM1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mx", "\[Rule]", 
      RowBox[{"mx", "[", "m0x", "]"}]}], ",", 
     RowBox[{"my", "\[Rule]", 
      RowBox[{"my", "[", "m0y", "]"}]}], ",", 
     RowBox[{"mz", "\[Rule]", 
      RowBox[{"mz", "[", "m0z", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"dmxdx", "\[Rule]", 
      RowBox[{"dmxdx", "[", "m0x", "]"}]}], ",", 
     RowBox[{"dmxdy", "\[Rule]", 
      RowBox[{"dmxdy", "[", "m0x", "]"}]}], ",", 
     RowBox[{"dmxdz", "\[Rule]", 
      RowBox[{"dmxdz", "[", "m0x", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"dmydx", "\[Rule]", 
      RowBox[{"dmydx", "[", "m0y", "]"}]}], ",", 
     RowBox[{"dmydy", "\[Rule]", 
      RowBox[{"dmydy", "[", "m0y", "]"}]}], ",", 
     RowBox[{"dmydz", "\[Rule]", 
      RowBox[{"dmydz", "[", "m0y", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"dmzdx", "\[Rule]", 
      RowBox[{"dmzdx", "[", "m0z", "]"}]}], ",", 
     RowBox[{"dmzdy", "\[Rule]", 
      RowBox[{"dmzdy", "[", "m0z", "]"}]}], ",", 
     RowBox[{"dmzdz", "\[Rule]", 
      RowBox[{"dmzdz", "[", "m0z", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"algFEM2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["dmxdx", "\[Prime]",
        MultilineFunction->None], "[", "m0x", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmxdy", "\[Prime]",
        MultilineFunction->None], "[", "m0x", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmxdz", "\[Prime]",
        MultilineFunction->None], "[", "m0x", "]"}], "\[Rule]", "dphidz"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmydx", "\[Prime]",
        MultilineFunction->None], "[", "m0y", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmydy", "\[Prime]",
        MultilineFunction->None], "[", "m0y", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmydz", "\[Prime]",
        MultilineFunction->None], "[", "m0y", "]"}], "\[Rule]", "dphidz"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmzdx", "\[Prime]",
        MultilineFunction->None], "[", "m0z", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmzdy", "\[Prime]",
        MultilineFunction->None], "[", "m0z", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmzdz", "\[Prime]",
        MultilineFunction->None], "[", "m0z", "]"}], "\[Rule]", "dphidz"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mx", "[", "m0x", "]"}], "\[Rule]", "mx"}], ",", 
     RowBox[{
      RowBox[{"my", "[", "m0y", "]"}], "\[Rule]", "my"}], ",", 
     RowBox[{
      RowBox[{"mz", "[", "m0z", "]"}], "\[Rule]", "mz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dmxdx", "[", "m0x", "]"}], "->", "dmxdx"}], ",", 
     RowBox[{
      RowBox[{"dmxdy", "[", "m0x", "]"}], "\[Rule]", "dmxdy"}], ",", 
     RowBox[{
      RowBox[{"dmxdz", "[", "m0x", "]"}], "\[Rule]", "dmxdz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dmydx", "[", "m0y", "]"}], "->", "dmydx"}], ",", 
     RowBox[{
      RowBox[{"dmydy", "[", "m0y", "]"}], "\[Rule]", "dmydy"}], ",", 
     RowBox[{
      RowBox[{"dmydz", "[", "m0y", "]"}], "\[Rule]", "dmydz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dmzdx", "[", "m0z", "]"}], "->", "dmzdx"}], ",", 
     RowBox[{
      RowBox[{"dmzdy", "[", "m0z", "]"}], "\[Rule]", "dmzdy"}], ",", 
     RowBox[{
      RowBox[{"dmzdz", "[", "m0z", "]"}], "\[Rule]", "dmzdz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", "\[Prime]",
        MultilineFunction->None], "[", "m0x", "]"}], "\[Rule]", "phi"}], ",", 
     
     RowBox[{
      RowBox[{
       SuperscriptBox["my", "\[Prime]",
        MultilineFunction->None], "[", "m0y", "]"}], "\[Rule]", "phi"}], ",", 
     
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", "\[Prime]",
        MultilineFunction->None], "[", "m0z", "]"}], "\[Rule]", "phi"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deriv", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdz"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydz"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdy"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydy"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdy"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdx"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydx"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdx"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jsub", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ux", "\[Rule]", 
      RowBox[{
       FractionBox["\[Mu]B", 
        RowBox[{"2", " ", "e", " ", "\[Gamma]B", " ", "Ms", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Xi]", "2"]}], ")"}]}]], "jx"}]}], ",", 
     RowBox[{"uy", "\[Rule]", 
      RowBox[{
       FractionBox["\[Mu]B", 
        RowBox[{"2", " ", "e", " ", "\[Gamma]B", " ", "Ms", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Xi]", "2"]}], ")"}]}]], "jy"}]}], ",", 
     RowBox[{"uz", "\[Rule]", 
      RowBox[{
       FractionBox["\[Mu]B", 
        RowBox[{"2", " ", "e", " ", "\[Gamma]B", " ", "Ms", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Xi]", "2"]}], ")"}]}]], "jz"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.788765212372756*^9, 3.7887652160535097`*^9}, {
  3.7887654168575077`*^9, 3.788765419065247*^9}, {3.794140319359366*^9, 
  3.7941403200253*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"ee610166-5c22-4f17-8c56-1c170d3f5627"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dispFEM1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"e11", "\[Rule]", 
      RowBox[{"duxdx", "[", "u0x", "]"}]}], ",", 
     RowBox[{"e22", "\[Rule]", 
      RowBox[{"duydy", "[", "u0y", "]"}]}], ",", 
     RowBox[{"e33", "\[Rule]", 
      RowBox[{"duzdz", "[", "u0z", "]"}]}], ",", 
     RowBox[{"e12", "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"duxdy", "[", "u0x", "]"}], "+", 
         RowBox[{"duydx", "[", "u0y", "]"}]}], ")"}]}]}], ",", 
     RowBox[{"e13", "->", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"duxdz", "[", "u0x", "]"}], "+", 
         RowBox[{"duzdx", "[", "u0z", "]"}]}], ")"}]}]}], ",", 
     RowBox[{"e23", "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"duydz", "[", "u0y", "]"}], "+", 
         RowBox[{"duzdy", "[", "u0z", "]"}]}], ")"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dispFEM2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["duxdx", "\[Prime]",
        MultilineFunction->None], "[", "u0x", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duxdy", "\[Prime]",
        MultilineFunction->None], "[", "u0x", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duxdz", "\[Prime]",
        MultilineFunction->None], "[", "u0x", "]"}], "\[Rule]", "dphidz"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duydx", "\[Prime]",
        MultilineFunction->None], "[", "u0y", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duydy", "\[Prime]",
        MultilineFunction->None], "[", "u0y", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duydz", "\[Prime]",
        MultilineFunction->None], "[", "u0y", "]"}], "\[Rule]", "dphidz"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duzdx", "\[Prime]",
        MultilineFunction->None], "[", "u0z", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duzdy", "\[Prime]",
        MultilineFunction->None], "[", "u0z", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duzdz", "\[Prime]",
        MultilineFunction->None], "[", "u0z", "]"}], "\[Rule]", "dphidz"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.795173609251067*^9, 3.795173611054225*^9}, {
  3.795173658690208*^9, 3.7951736640215387`*^9}, {3.7951742908846416`*^9, 
  3.795174369336994*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"96b479c7-9851-4b81-a4b7-5213ad725f43"]
}, Closed]],

Cell[CellGroupData[{

Cell["        Substitutions", "Section",
 CellChangeTimes->{{3.8231492560884247`*^9, 
  3.823149263857574*^9}},ExpressionUUID->"0cab8b2a-af49-48c4-9bb9-\
ad7d3853943c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"effectiveFieldSubstitute", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Hx", "\[Rule]", 
      RowBox[{
       RowBox[{"Hexc", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", 
       RowBox[{"Hint", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", 
       RowBox[{"Hanis", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Hy", "\[Rule]", 
      RowBox[{
       RowBox[{"Hexc", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", 
       RowBox[{"Hint", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", 
       RowBox[{"Hanis", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Hz", "\[Rule]", 
      RowBox[{
       RowBox[{"Hexc", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "+", 
       RowBox[{"Hint", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "+", 
       RowBox[{"Hanis", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], " ", ",", "\[IndentingNewLine]", 
     RowBox[{"HxLL", "\[Rule]", 
      RowBox[{
       RowBox[{"\[CapitalSigma]excLL", 
        FractionBox[
         RowBox[{"Hexc", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[CapitalSigma]exc"]}], "+", 
       RowBox[{"\[CapitalSigma]intLL", 
        FractionBox[
         RowBox[{"Hint", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[CapitalSigma]int"]}], "+", 
       RowBox[{"\[CapitalSigma]anisLL", 
        FractionBox[
         RowBox[{"Hanis", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[CapitalSigma]anis"]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HyLL", "\[Rule]", 
      RowBox[{
       RowBox[{"\[CapitalSigma]excLL", 
        FractionBox[
         RowBox[{"Hexc", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[CapitalSigma]exc"]}], "+", 
       RowBox[{"\[CapitalSigma]intLL", 
        FractionBox[
         RowBox[{"Hint", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[CapitalSigma]int"]}], "+", 
       RowBox[{"\[CapitalSigma]anisLL", 
        FractionBox[
         RowBox[{"Hanis", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[CapitalSigma]anis"]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HzLL", "\[Rule]", 
      RowBox[{
       RowBox[{"\[CapitalSigma]excLL", 
        FractionBox[
         RowBox[{"Hexc", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[CapitalSigma]exc"]}], "+", 
       RowBox[{"\[CapitalSigma]intLL", 
        FractionBox[
         RowBox[{"Hint", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[CapitalSigma]int"]}], "+", 
       RowBox[{"\[CapitalSigma]anisLL", 
        FractionBox[
         RowBox[{"Hanis", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[CapitalSigma]anis"]}]}]}]}], 
    "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[104]:=",ExpressionUUID->"5c2c7011-a069-438e-8163-5636797022fe"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["    Ferroelectrics", "Chapter",
 CellChangeTimes->{{3.823147968473817*^9, 3.8231479698640842`*^9}, 
   3.823148034623803*^9, {3.823161227208509*^9, 
   3.823161256415927*^9}},ExpressionUUID->"7a035d01-4419-4dfa-8464-\
9f36e563fa83"],

Cell[CellGroupData[{

Cell["        Material coefficients", "Section",
 CellChangeTimes->{{3.823148319041975*^9, 
  3.823148324535351*^9}},ExpressionUUID->"28cfd32f-5d2f-4679-ba3f-\
71ab50c7c33c"],

Cell[CellGroupData[{

Cell[TextData[{
 "        ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["PbTiO", "3"], "(", 
    RowBox[{
     StyleBox["P",
      FontWeight->"Bold"], ",", 
     RowBox[{"\[Epsilon]", " ", "coupled"}]}], ")"}], TraditionalForm]],
  ExpressionUUID->"64b24ee3-82f8-40b0-9670-c6a0d7bcafb5"],
 ":"
}], "Subsection",
 CellChangeTimes->{{3.8231484348164787`*^9, 3.823148453155772*^9}, {
  3.823161265048024*^9, 
  3.8231612922086687`*^9}},ExpressionUUID->"e63d1d95-158a-406e-bb47-\
4d3dd76d7507"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MassScale", "=", "\"\<Kilograms\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeScale", "=", "\"\<Seconds\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LengthScale", "=", "\"\<Nanometers\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ChargeScale", "=", "\"\<Attocoulombs\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", "298"}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.823149052140353*^9, 
  3.823149052767412*^9}},ExpressionUUID->"9d78ea87-567c-4f7f-92de-\
f0bbef9ef26a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Landau", " ", "coefficients"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]1", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"3.8", 
          RowBox[{"(", 
           RowBox[{"T", "-", "752"}], ")"}], 
          SuperscriptBox["10", "5"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "2"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "2"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "2"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "2"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"T", " ", "=", " ", 
     RowBox[{"300", " ", "K"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]11", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.72530"}], "*", 
          SuperscriptBox["10", "8"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "6"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "4"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "6"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "4"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]12", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"7.50", "*", 
          SuperscriptBox["10", "8"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "6"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "4"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "6"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "4"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]111", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"2.60", "*", 
          SuperscriptBox["10", "8"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "10"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "6"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "10"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "6"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]112", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"6.10", "*", 
          SuperscriptBox["10", "8"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "10"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "6"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "10"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "6"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]123", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "37.0"}], "*", 
          SuperscriptBox["10", "8"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "10"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "6"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "10"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "6"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Domain", " ", "Wall", " ", "term"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G110", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"1.73", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "4"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "2"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "4"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "2"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Electrostrictive", " ", "coefficients"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q11", " ", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{"0.089", ",", 
         RowBox[{"(", 
          FractionBox[
           SuperscriptBox["\"\<Meters\>\"", "4"], 
           SuperscriptBox["\"\<Coulombs\>\"", "2"]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         SuperscriptBox["LengthScale", "4"], 
         SuperscriptBox["ChargeScale", "2"]], ")"}]}], "]"}]}], ";", 
    RowBox[{"Q12", " ", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"-", "0.026"}], ",", 
         RowBox[{"(", 
          FractionBox[
           SuperscriptBox["\"\<Meters\>\"", "4"], 
           SuperscriptBox["\"\<Coulombs\>\"", "2"]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         SuperscriptBox["LengthScale", "4"], 
         SuperscriptBox["ChargeScale", "2"]], ")"}]}], "]"}]}], ";", 
    RowBox[{"Q33", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{"0.0675", ",", 
         RowBox[{"(", 
          FractionBox[
           SuperscriptBox["\"\<Meters\>\"", "4"], 
           SuperscriptBox["\"\<Coulombs\>\"", "2"]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         SuperscriptBox["LengthScale", "4"], 
         SuperscriptBox["ChargeScale", "2"]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Electrostatics", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]0", " ", "=", " ", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"10", "*", "8.854187", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "2"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}], 
           RowBox[{"\"\<Kilograms\>\"", "\"\<Meters\>\"", " ", 
            SuperscriptBox["\"\<Meters\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["ChargeScale", "2"], 
          SuperscriptBox["TimeScale", "2"]}], 
         RowBox[{"MassScale", " ", 
          SuperscriptBox["LengthScale", "3"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Elastic", " ", "stiffness", " ", "tensor", " ", "components"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C11s", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"380.0", "*", 
          SuperscriptBox["10", "9"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"\"\<Kilograms\>\"", "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "2"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"MassScale", " ", "LengthScale"}], 
         RowBox[{
          SuperscriptBox["LengthScale", "2"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C12s", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"150.0", "*", 
          SuperscriptBox["10", "9"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"\"\<Kilograms\>\"", "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "2"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"MassScale", " ", "LengthScale"}], 
         RowBox[{
          SuperscriptBox["LengthScale", "2"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C33s", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"110.0", "*", 
          SuperscriptBox["10", "9"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"\"\<Kilograms\>\"", "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "2"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"MassScale", " ", "LengthScale"}], 
         RowBox[{
          SuperscriptBox["LengthScale", "2"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     SubscriptBox["P", "max"], " ", "or", " ", "approximate", " ", "value", 
     " ", "of", " ", "polarization", " ", "at", " ", "each", " ", "node", " ",
      "at", " ", "end", " ", "of", " ", "simulation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UnitConvert", "[", 
     RowBox[{
      RowBox[{"Quantity", "[", 
       RowBox[{"0.65", ",", 
        RowBox[{"(", 
         FractionBox["\"\<Coulombs\>\"", 
          SuperscriptBox["\"\<Meters\>\"", "2"]], ")"}]}], "]"}], ",", 
      RowBox[{"(", 
       FractionBox["ChargeScale", 
        SuperscriptBox["LengthScale", "2"]], ")"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "\"\<[GlobalParams]\>\"", "<>", "\"\< \n \>\"", "<>", "\n", 
    "\"\<len_scale = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "lenS", "]"}], "]"}], " ", "]"}], 
    "<>", "\"\< \n\>\"", "<>", "\n", "\"\<alpha1 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "\[Alpha]1", "]"}], "]"}], "]"}], 
    "<>", "\"\< # (3.766(T-765.1)*10^5) C^{-2} nm^2 (T = 300 K)\>\"", "<>", 
    "\"\<\n\>\"", "<>", "\n", "\"\<alpha11 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "\[Alpha]11", "]"}], "]"}], "]"}], 
    " ", "<>", " ", "\"\<\n\>\"", "<>", "\n", "\"\<alpha111 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "\[Alpha]111", "]"}], "]"}], "]"}], 
    "<>", "\"\<\n\>\"", "<>", "\n", "\"\<alpha12 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "\[Alpha]12", "]"}], "]"}], "]"}], 
    "<>", "\"\< \n\>\"", "<>", "\n", "\"\<alpha112 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "\[Alpha]112", "]"}], "]"}], "]"}], 
    "<>", "\"\<\n\>\"", "<>", "\n", "\"\<alpha123 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "\[Alpha]123", "]"}], "]"}], "]"}], 
    "<>", "\"\<\n\>\"", "<>", "\n", "\"\<G110 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"NumberForm", "[", 
      RowBox[{
       RowBox[{"FortranForm", "[", 
        RowBox[{"QuantityMagnitude", "[", "G110", "]"}], "]"}], ",", "2"}], 
      "]"}], "]"}], "<>", "\"\<\n\>\"", "<>", "\n", "\"\<G11/G110 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", "0.6", "]"}], "]"}], "<>", "\"\<\n\>\"", "<>",
     "\n", "\"\<G12/G110 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", "0", "]"}], "]"}], "<>", "\"\< \n\>\"", "<>",
     "\n", "\"\<G44/G110 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", "0.3", "]"}], "]"}], "<>", "\"\<\n\>\"", "<>",
     " ", "\n", "\"\<G44P/G110 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", "0.3", "]"}], "]"}], "<>", "\"\<\n \>\"", "<>",
     "\n", "\"\<Q_mnkl = '\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q11", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q12", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q12", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q11", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q12", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q11", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q33", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q33", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q33", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\<'\>\"", "<>", "\"\<\n\>\"", "<>", "\n", 
    "\"\<permittivity = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", 
       RowBox[{"1.0", "*", "\[Epsilon]0"}], "]"}], "]"}], "]"}], "<>", 
    "\"\<\n\>\"", "<>", "\n", "\"\<polar_x = polar_x\>\"", "<>", "\"\<\n\>\"",
     "<>", "\n", "\"\<polar_y = polar_y\>\"", "<>", "\"\<\n\>\"", "<>", "\n", 
    "\"\<polar_z = polar_z\>\"", "<>", "\"\<\n\>\"", "<>", "\n", 
    "\"\<potential_int = potential_int\>\"", "<>", "\"\<\n\>\"", "<>", "\n", 
    "\"\<potential_ext = potential_ext\>\"", "<>", "\"\<\n\>\"", "<>", "\n", 
    "\"\<disp_x=disp_x\>\"", "<>", "\[IndentingNewLine]", "\"\<\n\>\"", "<>", 
    "\n", "\"\<disp_y=disp_y\>\"", "<>", "\[IndentingNewLine]", "\"\<\n\>\"", 
    "<>", "\n", "\"\<disp_z=disp_z\>\"", "<>", "\"\<\n\>\"", "<>", "\n", 
    "\"\<displacements='disp_x disp_y disp_z'\>\"", "<>", "\"\<\n\>\"", "<>", 
    "\n", "\"\<use_displaced_mesh = false\>\"", "<>", "\"\<\n\>\"", "<>", 
    "\n", "\"\<C_ijkl = '\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C11s", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C12s", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C12s", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C11s", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C12s", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C11s", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C33s", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C33s", "]"}], "]"}], " ", "]"}], 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C33s", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\<'\>\"", "<>", "\[IndentingNewLine]", "\"\<\n\>\"", "<>", "\n", 
    "\"\<[]\>\""}]}]}]], "Input",
 CellChangeTimes->{{3.646863040055949*^9, 3.6468630849062557`*^9}, {
   3.6477102134873667`*^9, 3.647710218874804*^9}, {3.6477103879562674`*^9, 
   3.647710388922699*^9}, {3.6477108245839977`*^9, 3.647710828153778*^9}, 
   3.647710887018095*^9, {3.6477109737425537`*^9, 3.647711006355276*^9}, {
   3.647711183809458*^9, 3.647711206271381*^9}, {3.647711338418755*^9, 
   3.647711413146394*^9}, {3.647711682036887*^9, 3.64771168966891*^9}, {
   3.647711728097595*^9, 3.647711773485506*^9}, {3.647711868280829*^9, 
   3.64771197224361*^9}, {3.647712016637435*^9, 3.6477120331422462`*^9}, {
   3.647712092416791*^9, 3.647712099197598*^9}, {3.647712140182198*^9, 
   3.647712160186522*^9}, 3.647712465589872*^9, 3.647712510959057*^9, {
   3.647712656427106*^9, 3.647712711133376*^9}, {3.647713127836959*^9, 
   3.647713129394238*^9}, {3.6477132035647087`*^9, 3.6477132087959213`*^9}, {
   3.647713279198717*^9, 3.6477133160971947`*^9}, {3.647713405628389*^9, 
   3.647713443102078*^9}, {3.647713475076442*^9, 3.647713517023387*^9}, {
   3.647714259378776*^9, 3.6477142803597307`*^9}, {3.647714354541769*^9, 
   3.647714357775249*^9}, {3.6477149091509113`*^9, 3.647714993745089*^9}, {
   3.647715066369506*^9, 3.647715110769836*^9}, 3.647790233509611*^9, {
   3.647790345502666*^9, 3.647790346918983*^9}, {3.647790594302248*^9, 
   3.64779059898962*^9}, {3.647790694110265*^9, 3.647790972240089*^9}, {
   3.6477916110286703`*^9, 3.64779161439681*^9}, {3.647883296756894*^9, 
   3.647883302658976*^9}, {3.6478856362085733`*^9, 3.647885638599304*^9}, {
   3.647887699767662*^9, 3.6478877011871023`*^9}, {3.647968680157094*^9, 
   3.6479686808620577`*^9}, {3.647970504876733*^9, 3.647970505547999*^9}, {
   3.6481349774646893`*^9, 3.648134977718112*^9}, {3.648393925414888*^9, 
   3.648393932644059*^9}, {3.648598226814809*^9, 3.6485982682696457`*^9}, {
   3.648598334001397*^9, 3.648598336352055*^9}, {3.648813845511849*^9, 
   3.6488138468166027`*^9}, {3.648816366017646*^9, 3.648816389288848*^9}, {
   3.648995362750836*^9, 3.648995432568611*^9}, {3.648995462599793*^9, 
   3.648995469229823*^9}, {3.6489956598662033`*^9, 3.648995680506147*^9}, {
   3.648995716111557*^9, 3.648995738533271*^9}, {3.648996394490115*^9, 
   3.648996414121767*^9}, {3.649000624665512*^9, 3.649000667228282*^9}, {
   3.649001528205715*^9, 3.6490015439501133`*^9}, {3.6490148831739817`*^9, 
   3.6490148915574903`*^9}, {3.649015525402555*^9, 3.649015526153455*^9}, {
   3.64902770473005*^9, 3.64902770783773*^9}, {3.649081434142069*^9, 
   3.6490814717377996`*^9}, {3.649084269429542*^9, 3.649084270347389*^9}, 
   3.649084301282524*^9, {3.649169374315112*^9, 3.649169442381168*^9}, {
   3.649172780920265*^9, 3.649172861220356*^9}, {3.649347814274878*^9, 
   3.649347825235147*^9}, {3.649347856173175*^9, 3.6493478815185204`*^9}, {
   3.654716380219863*^9, 3.6547164165998793`*^9}, {3.65486364208572*^9, 
   3.65486365234307*^9}, {3.655731331589226*^9, 3.6557313357788486`*^9}, {
   3.6635214283190823`*^9, 3.663521431885901*^9}, {3.6635214707314453`*^9, 
   3.663521471730034*^9}, {3.663521512468419*^9, 3.663521512856346*^9}, {
   3.66352159403833*^9, 3.663521595218871*^9}, {3.666029352401372*^9, 
   3.666029376828683*^9}, {3.668848762805831*^9, 3.668848763114154*^9}, {
   3.66922488479662*^9, 3.66922491311274*^9}, {3.6695022166315536`*^9, 
   3.6695022412245398`*^9}, {3.700302085861393*^9, 3.700302090850518*^9}, {
   3.7044048966048527`*^9, 3.704404900452491*^9}, {3.721052922357299*^9, 
   3.721052922529764*^9}, {3.721052955000379*^9, 3.721052955332302*^9}, {
   3.721052988383613*^9, 3.721052988660133*^9}, {3.721053032308648*^9, 
   3.7210530783875723`*^9}, {3.7210531129472847`*^9, 3.721053113361534*^9}, {
   3.7210531448207893`*^9, 3.721053145119864*^9}, {3.721053175363171*^9, 
   3.721053178856759*^9}, {3.721053470815824*^9, 3.721053471580323*^9}, {
   3.721053511482424*^9, 3.7210535116598387`*^9}, {3.721055096787768*^9, 
   3.7210551000535192`*^9}, 3.721056295069292*^9, {3.82314841672358*^9, 
   3.8231484270905657`*^9}, {3.823148458938603*^9, 3.823148462015953*^9}, {
   3.823148508592978*^9, 3.823148539047521*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"df2db43e-de59-4b2e-8507-d61dc375a349"],

Cell[BoxData["\<\"[GlobalParams] \\n len_scale = QuantityMagnitude(lenS) \
\\nalpha1 = -0.17251999999999998 # (3.766(T-765.1)*10^5) C^{-2} nm^2 (T = 300 \
K)\\nalpha11 = -0.07253000000000001\\nalpha111 = 0.26\\nalpha12 = 0.75 \
\\nalpha112 = 0.61\\nalpha123 = -3.7\\nG110 = 0.173\\nG11/G110 = \
0.6\\nG12/G110 = 0 \\nG44/G110 = 0.3\\nG44P/G110 = 0.3\\n Q_mnkl = '0.089 \
-0.026 -0.026 0.089 -0.026 0.089 0.0675 0.0675 0.0675'\\npermittivity = \
0.08854187\\npolar_x = polar_x\\npolar_y = polar_y\\npolar_z = \
polar_z\\npotential_int = potential_int\\npotential_ext = \
potential_ext\\ndisp_x=disp_x\\ndisp_y=disp_y\\ndisp_z=disp_z\\ndisplacements=\
'disp_x disp_y disp_z'\\nuse_displaced_mesh = false\\nC_ijkl = '380. 150. \
150. 380. 150. 380. 110. 110. 110.'\\n[]\"\>"], "Output",
 CellChangeTimes->{{3.823148510076063*^9, 3.823148539733964*^9}},
 CellLabel->"Out[70]=",ExpressionUUID->"1e16d244-119b-411f-acf6-26c1af7ce245"]
}, Open  ]]
}, Closed]],

Cell[TextData[{
 "        ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["BaTiO", "3"], "(", 
    RowBox[{
     StyleBox["P",
      FontWeight->"Bold"], ",", 
     RowBox[{"\[Epsilon]", " ", "coupled"}]}], ")"}], TraditionalForm]],
  ExpressionUUID->"b4354b9b-0f6c-4201-8760-5ada82b5e95d"],
 ":"
}], "Subsection",
 CellChangeTimes->{{3.823148649148109*^9, 3.823148658369581*^9}, {
  3.823161296984604*^9, 
  3.823161299431357*^9}},ExpressionUUID->"72e10825-d014-413f-a842-\
21d38a5da6ad"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"          ", 
    RowBox[{
     SubscriptBox["BiFeO", "3"], "(", 
     RowBox[{
      StyleBox["P",
       FontWeight->"Bold"], ",", "A", ",", 
      RowBox[{"\[Epsilon]", " ", "coupled"}]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"308b4e60-bb6f-44c7-a1e8-644b195f21b4"],
 ":"
}], "Subsection",
 CellChangeTimes->{{3.8231613031110897`*^9, 3.823161330387838*^9}, {
  3.823172327245996*^9, 
  3.8231723277172422`*^9}},ExpressionUUID->"3235dd6f-e7ea-4ea8-8b26-\
8d6dc36b42b9"]
}, Open  ]],

Cell[TextData[{
 "        Governing equation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["[",
     FontWeight->"Bold"], 
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       StyleBox["P",
        FontWeight->"Bold"]}], 
      RowBox[{"\[PartialD]", "t"}]], " ", "=", " ", 
     RowBox[{"-", " ", 
      SubscriptBox["\[CapitalGamma]", 
       StyleBox["P",
        FontWeight->"Bold"]]}]}]}], TraditionalForm]],ExpressionUUID->
  "cb9ce8e1-b6b8-4f52-bff9-6d67eee3e19a"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox[
     FractionBox[
      StyleBox["\[Delta]F",
       FontWeight->"Plain"], 
      StyleBox[
       RowBox[{
        StyleBox["\[Delta]",
         FontWeight->"Plain"], "P"}]]],
     FontWeight->"Bold"], "]"}], TraditionalForm]],ExpressionUUID->
  "c69918c2-bd9b-4c31-aba6-2983ce6d587b"]
}], "Section",
 CellChangeTimes->{{3.823148922206627*^9, 3.823148928390716*^9}, {
  3.823151094901904*^9, 
  3.823151165749791*^9}},ExpressionUUID->"5da2ae0b-5d70-4c56-9cc9-\
e071bf0a896b"],

Cell[TextData[{
 "        Free energy  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["[",
     FontWeight->"Bold"], 
    RowBox[{"F", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["F", "bulk"], "(", 
        StyleBox["P",
         FontWeight->"Bold"], ")"}], "+", 
       RowBox[{
        SubscriptBox["F", "gradient"], "(", 
        StyleBox["P",
         FontWeight->"Bold"], ")"}], "+", 
       RowBox[{
        SubscriptBox["F", "elastic"], "(", "\[Epsilon]", ")"}], "+", 
       RowBox[{
        SubscriptBox["F", "electrostrictive"], "(", 
        RowBox[{
         StyleBox["P",
          FontWeight->"Bold"], ",", "\[Epsilon]"}], ")"}], "+", 
       RowBox[{
        SubscriptBox["F", "elec"], "(", 
        StyleBox["P",
         FontWeight->"Bold"], ")"}]}], "=", 
      RowBox[{"+", "..."}]}]}], 
    StyleBox["]",
     FontWeight->"Bold"]}], TraditionalForm]],ExpressionUUID->
  "e1c95662-2bfd-44b4-a39b-aee37ae33431"]
}], "Section",
 CellChangeTimes->{{3.8231510815977983`*^9, 3.823151092721257*^9}, {
  3.823153109471333*^9, 3.823153186349564*^9}, {3.823161338455106*^9, 
  3.8231613569949636`*^9}},ExpressionUUID->"0318d1e5-1e36-41ba-8187-\
e92dbe09de49"]
}, Open  ]],

Cell[CellGroupData[{

Cell["    Ferromagnets", "Chapter",
 CellChangeTimes->{{3.82314797402414*^9, 3.823147975537004*^9}, 
   3.823148035279624*^9},ExpressionUUID->"758459e7-ef4f-49dc-882e-\
bb6956ca3e88"],

Cell[CellGroupData[{

Cell["        Material coefficients", "Section",
 CellChangeTimes->{{3.823148328834231*^9, 
  3.823148332764502*^9}},ExpressionUUID->"80812cd6-b1bb-449f-886b-\
21fc76e7e084"],

Cell[CellGroupData[{

Cell["        Py (permalloy)", "Subsection",
 CellChangeTimes->{{3.823148771265864*^9, 
  3.823148790059431*^9}},ExpressionUUID->"1bcf7195-f09f-4887-bfbb-\
b621f6b5a139"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MassScale", "=", "\"\<Picograms\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeScale", "=", "\"\<Microseconds\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LengthScale", "=", "\"\<Micrometers\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ChargeScale", "=", "\"\<Microcoulombs\>\""}], ";"}]}], "Input",Expr\
essionUUID->"293d8cfc-eb2a-48ab-bf96-252eb9b9f6a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"func", "[", 
   RowBox[{
    RowBox[{"1.30", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "11"}]]}], ",", 
    FractionBox[
     RowBox[{"\"\<Kilograms\>\"", 
      SuperscriptBox["\"\<Meters\>\"", "2"]}], 
     RowBox[{
      SuperscriptBox["\"\<Seconds\>\"", "2"], "\"\<Meters\>\""}]], ",", 
    FractionBox[
     RowBox[{"MassScale", " ", 
      SuperscriptBox["LengthScale", "2"]}], 
     RowBox[{
      SuperscriptBox["TimeScale", "2"], "LengthScale"}]]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"func", "[", 
   RowBox[{"1200000.0", ",", 
    FractionBox["\"\<Coulombs\>\"", 
     RowBox[{"\"\<Seconds\>\"", "\"\<Meters\>\""}]], ",", 
    FractionBox["ChargeScale", 
     RowBox[{"TimeScale", " ", "LengthScale"}]]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]H", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"func", "[", 
   RowBox[{
    RowBox[{"2.2101", "\[Times]", 
     SuperscriptBox["10", "5"]}], ",", 
    FractionBox[
     RowBox[{"\"\<Meters\>\"", " ", "\"\<Seconds\>\""}], 
     RowBox[{"\"\<Coulombs\>\"", "\"\<Seconds\>\""}]], ",", 
    FractionBox[
     RowBox[{"LengthScale", " ", "TimeScale"}], 
     RowBox[{"ChargeScale", " ", "TimeScale"}]]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]0", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"func", "[", 
   RowBox[{
    RowBox[{"1.2566370614", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}], ",", 
    FractionBox[
     RowBox[{"\"\<Kilograms\>\"", "\"\<Meters\>\"", 
      SuperscriptBox["\"\<Seconds\>\"", "2"]}], 
     RowBox[{
      SuperscriptBox["\"\<Seconds\>\"", "2"], 
      SuperscriptBox["\"\<Coulombs\>\"", "2"]}]], ",", 
    FractionBox[
     RowBox[{"MassScale", " ", "LengthScale", " ", 
      SuperscriptBox["TimeScale", "2"]}], 
     RowBox[{
      SuperscriptBox["TimeScale", "2"], 
      SuperscriptBox["ChargeScale", "2"]}]]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8231488749277153`*^9, 3.8231488950357103`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"eaa32d20-00aa-49a9-b23a-9848f6dff607"],

Cell[BoxData[
 RowBox[{
  RowBox[{"set", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{"\"\<A=\>\"", ",", 
    RowBox[{"A", "[", 
     RowBox[{
     "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
     "]"}], ",", "\[IndentingNewLine]", "\"\<\[Gamma]H=\>\"", ",", 
    RowBox[{"\[Gamma]H", "[", 
     RowBox[{
     "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
     "]"}], ",", "\[IndentingNewLine]", "\"\<\[Mu]0=\>\"", ",", 
    RowBox[{"\[Mu]0", "[", 
     RowBox[{
     "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
     "]"}], ",", "\[IndentingNewLine]", "\"\<Ms=\>\"", ",", 
    RowBox[{"M", "[", 
     RowBox[{
     "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
     "]"}]}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.823148845456642*^9, 3.823148869791877*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"0072e5dc-e422-4590-81fb-279ce4ab917f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"set", "[", 
  RowBox[{
  "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.82314889875379*^9, 3.823148912663929*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"14cb2a2c-4afd-4553-b69e-8b150e9b939c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"A=\"\>", ",", 
   TemplateBox[{"0.013000000000000001`", 
     RowBox[{
      "\"pg\"", "\[ThinSpace]", "\"\[Micro]m\"", "\[InvisibleSpace]", "\"/\"",
        "\[InvisibleSpace]", 
       SuperscriptBox["\"\[Micro]s\"", "2"]}], 
     "picogram micrometers per microsecond squared", 
     FractionBox[
      RowBox[{"\"Micrometers\"", " ", "\"Picograms\""}], 
      SuperscriptBox["\"Microseconds\"", "2"]]},
    "Quantity"], ",", "\<\"\[Gamma]H=\"\>", ",", 
   TemplateBox[{"221010.00000000003`", 
     RowBox[{
      "\"\[Micro]m\"", "\[InvisibleSpace]", "\"/\"", "\[InvisibleSpace]", 
       "\"\[Micro]C\""}], "micrometers per microcoulomb", 
     FractionBox["\"Micrometers\"", "\"Microcoulombs\""]},
    "Quantity"], ",", "\<\"\[Mu]0=\"\>", ",", 
   TemplateBox[{"1256.6370614`", 
     RowBox[{
      "\"pg\"", "\[ThinSpace]", "\"\[Micro]m\"", "\[InvisibleSpace]", "\"/\"",
        "\[InvisibleSpace]", 
       SuperscriptBox["\"\[Micro]C\"", "2"]}], 
     "picogram micrometers per microcoulomb squared", 
     FractionBox[
      RowBox[{"\"Micrometers\"", " ", "\"Picograms\""}], 
      SuperscriptBox["\"Microcoulombs\"", "2"]]},
    "Quantity"], ",", "\<\"Ms=\"\>", ",", 
   TemplateBox[{"1.2`", 
     RowBox[{
      "\"\[Micro]C\"", "\[InvisibleSpace]", "\"/(\"", "\[InvisibleSpace]", 
       "\"\[Micro]m\"", "\[ThinSpace]", "\"\[Micro]s\"", "\[InvisibleSpace]", 
       "\")\""}], "microcoulombs per micrometer microsecond", 
     FractionBox["\"Microcoulombs\"", 
      RowBox[{"\"Micrometers\"", " ", "\"Microseconds\""}]]},
    "Quantity"]}], "}"}]], "Output",
 CellChangeTimes->{3.823148913120969*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"68e97e53-2187-48da-8878-3b6a7dfba0bf"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "        Effective fields ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["[",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["H",
      FontWeight->"Bold"], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        StyleBox["H",
         FontWeight->"Bold"], "exch"], "(", 
       StyleBox["m",
        FontWeight->"Bold"], ")"}], "+", 
      RowBox[{
       SubscriptBox[
        StyleBox["H",
         FontWeight->"Bold"], "demag"], "(", 
       StyleBox["m",
        FontWeight->"Bold"], ")"}], "+", 
      SubscriptBox[
       StyleBox["H",
        FontWeight->"Bold"], "appl"], "+", 
      RowBox[{
       SubscriptBox[
        StyleBox["H",
         FontWeight->"Bold"], "anis"], "(", 
       StyleBox["m",
        FontWeight->"Bold"], ")"}]}]}], 
    StyleBox["]",
     FontWeight->"Bold"]}], TraditionalForm]],ExpressionUUID->
  "afab536f-072e-4775-bb79-24da021f697c"]
}], "Section",
 CellChangeTimes->{{3.823149004069243*^9, 3.823149009574404*^9}, {
  3.823150999048298*^9, 3.823151040583872*^9}, {3.823161409557742*^9, 
  3.8231614291912317`*^9}},ExpressionUUID->"71df5d96-f5a9-4ffe-9519-\
46d556f98fe6"],

Cell[CellGroupData[{

Cell[TextData[{
 "        Exchange field ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox[
       StyleBox["H",
        FontWeight->"Bold"], "exch"], "=", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", 
         SubscriptBox["A", "e"]}], 
        RowBox[{
         SubscriptBox["M", "s"], " "}]], 
       RowBox[{
        SuperscriptBox["\[Del]", "2"], 
        StyleBox["m",
         FontWeight->"Bold"]}]}]}], ")"}], " "}], TraditionalForm]],
  ExpressionUUID->"098a6c06-40f9-41ad-a6f4-c5c91a65c6b6"]
}], "Subsection",
 CellChangeTimes->{{3.823149091755207*^9, 3.823149102351474*^9}, {
  3.8231528754911203`*^9, 
  3.8231529222104053`*^9}},ExpressionUUID->"f29e61f8-efa7-4034-8c60-\
0dfcb50811e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hexc", "=", 
   RowBox[{"\[CapitalSigma]exc", "  ", 
    FractionBox[
     RowBox[{"2", " ", "Ae"}], 
     RowBox[{"Ms", " "}]], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d2mxdx2", "+", "d2mxdy2", "+", "d2mxdz2"}], ",", 
      RowBox[{"d2mydx2", "+", "d2mydy2", "+", "d2mydz2"}], ",", 
      RowBox[{"d2mzdx2", "+", "d2mzdy2", "+", "d2mzdz2"}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.749445910486377*^9, 3.749446069078456*^9}, 
   3.752230091804883*^9, {3.752230226708441*^9, 3.7522302340193243`*^9}, {
   3.7531832929552517`*^9, 3.753183325690769*^9}, {3.757506627867985*^9, 
   3.757506628155224*^9}, {3.768127856791979*^9, 3.768127857445191*^9}, {
   3.768128499558729*^9, 3.768128501069751*^9}, {3.768131423347054*^9, 
   3.768131426940933*^9}, 3.7693148151011333`*^9, {3.777881307320821*^9, 
   3.777881318632682*^9}, {3.777881642613761*^9, 3.777881681364541*^9}, {
   3.777881765199153*^9, 3.777881769293357*^9}, {3.7782404304768877`*^9, 
   3.7782404426344557`*^9}, {3.778837227583349*^9, 3.778837228333824*^9}, {
   3.778998271176955*^9, 3.778998271847414*^9}, {3.779258008778675*^9, 
   3.7792580092750263`*^9}, {3.788759228184538*^9, 3.788759307844858*^9}, {
   3.789211397600712*^9, 3.789211397982698*^9}, {3.78971251474741*^9, 
   3.789712527161633*^9}, {3.7909373487327213`*^9, 3.7909373519755898`*^9}, {
   3.79095073127884*^9, 3.790950731875654*^9}, {3.793682415186614*^9, 
   3.793682427839735*^9}, 3.823149170811215*^9},
 CellLabel->"In[99]:=",ExpressionUUID->"3f090a8b-d3a9-43c5-bd63-48b9f79b95dd"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "        Demagnetization field ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox[
      StyleBox["H",
       FontWeight->"Bold"], "int"], "=", 
     RowBox[{"-", 
      RowBox[{"\[Del]", 
       SubscriptBox["\[CapitalPhi]", 
        StyleBox["H",
         FontWeight->"Bold"]]}]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "e4cd0b1b-4874-48d3-9451-c4a508e987a7"]
}], "Subsection",
 CellChangeTimes->{{3.8231491118261127`*^9, 3.823149135637599*^9}, {
  3.8231529370739107`*^9, 
  3.8231529638989964`*^9}},ExpressionUUID->"0b862b60-4ea9-4549-aba8-\
2e8a1f253fa3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hint", "=", 
   RowBox[{
    RowBox[{"-", "\[CapitalSigma]int"}], 
    RowBox[{"{", " ", 
     RowBox[{
     "d\[CapitalPhi]dx", ",", "d\[CapitalPhi]dy", ",", "d\[CapitalPhi]dz"}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.749446533831688*^9, 3.749446666945119*^9}, {
   3.749446789733314*^9, 3.7494467936051817`*^9}, {3.749446865439075*^9, 
   3.749446869390739*^9}, {3.749447292309141*^9, 3.749447299829809*^9}, {
   3.751102658108469*^9, 3.7511026792265387`*^9}, {3.7511119076078777`*^9, 
   3.7511119077673063`*^9}, {3.753008077691921*^9, 3.753008080011551*^9}, 
   3.7530081368903713`*^9, {3.7531790797906723`*^9, 3.753179093789392*^9}, {
   3.75318350159783*^9, 3.753183513086712*^9}, {3.7575063145661583`*^9, 
   3.757506322916897*^9}, {3.757508239852392*^9, 3.757508242331109*^9}, {
   3.768109466951543*^9, 3.768109468326877*^9}, {3.7681317784545393`*^9, 
   3.7681317960848618`*^9}, {3.768147708813032*^9, 3.768147727696533*^9}, 
   3.769314831002612*^9, {3.7698508359339*^9, 3.7698508375155087`*^9}, {
   3.774954236172525*^9, 3.7749542418518677`*^9}, {3.778837810325754*^9, 
   3.778837810661017*^9}, {3.778998284646345*^9, 3.778998285013022*^9}, {
   3.7897125622312403`*^9, 3.789712562615157*^9}, 3.823149171813486*^9},
 CellLabel->
  "In[100]:=",ExpressionUUID->"edb61ec0-adcb-4fc1-a042-daf0dcd0c26e"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "        Magnetocrystalline anisotropy ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox[
      StyleBox["H",
       FontWeight->"Bold"], "anis"], "=", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SubscriptBox["K", "1"], 
        SuperscriptBox[
         SubscriptBox["M", "s"], "2"]]}], 
      FractionBox[
       RowBox[{"\[Delta]", "(", 
        RowBox[{
         StyleBox["m",
          FontWeight->"Bold"], "\[CenterDot]", 
         StyleBox["n",
          FontWeight->"Bold"]}], ")"}], 
       RowBox[{"\[Delta]", " ", 
        StyleBox["m",
         FontWeight->"Bold"]}]]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "7dc40786-00c4-4799-80fb-3b704e9b0ce1"]
}], "Subsection",
 CellChangeTimes->{{3.8231491527302732`*^9, 3.823149164116877*^9}, {
  3.8231530193282633`*^9, 
  3.8231530882240877`*^9}},ExpressionUUID->"e1e712fa-5e27-4002-a746-\
cd3cb4e4b2ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hanis", " ", "=", " ", 
   RowBox[{"\[CapitalSigma]anis", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", " ", 
           FractionBox["K1", 
            SuperscriptBox["Ms", "2"]]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"mx", " ", "nx"}], "+", 
             RowBox[{"my", " ", "ny"}], "+", 
             RowBox[{"mz", " ", "nz"}]}], ")"}], "2"]}], ")"}], ",", "mx"}], 
       "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", " ", 
           FractionBox["K1", 
            SuperscriptBox["Ms", "2"]]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"mx", " ", "nx"}], "+", 
             RowBox[{"my", " ", "ny"}], "+", 
             RowBox[{"mz", " ", "nz"}]}], ")"}], "2"]}], ")"}], ",", "my"}], 
       "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["K1", 
            SuperscriptBox["Ms", "2"]]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"mx", " ", "nx"}], "+", 
             RowBox[{"my", " ", "ny"}], "+", 
             RowBox[{"mz", " ", "nz"}]}], ")"}], "2"]}], ")"}], ",", "mz"}], 
       "]"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{3.823149172619276*^9},
 CellLabel->
  "In[101]:=",ExpressionUUID->"71c6f74c-c9c3-4bdc-bbbe-9bda21a966b0"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "        Governing equation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["[",
     FontWeight->"Bold"], " ", 
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       StyleBox["m",
        FontWeight->"Bold"]}], 
      RowBox[{"\[PartialD]", "t"}]], "=", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "\[Gamma]"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[Alpha]", "2"]}], ")"}]], 
      StyleBox["m",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], "\[Times]", " ", 
      StyleBox["H",
       FontWeight->"Bold"]}]}]}], TraditionalForm]],ExpressionUUID->
  "592457b7-3af7-4fc2-a7c3-81845ba14726"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[Gamma]", " ", "\[Alpha]"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[Alpha]", "2"]}], ")"}]]}], 
      StyleBox["m",
       FontWeight->"Bold"], "\[Times]", 
      RowBox[{"(", 
       RowBox[{
        StyleBox["m",
         FontWeight->"Bold"], "\[Times]", 
        StyleBox["H",
         FontWeight->"Bold"]}], ")"}]}], "+", " ", 
     RowBox[{
      SubscriptBox["\[Alpha]", "LL"], "(", 
      RowBox[{
       StyleBox["m",
        FontWeight->"Bold"], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["H",
        FontWeight->"Bold"]}], ")"}], "+", 
     RowBox[{"s", ".", "t", "."}]}], 
    StyleBox["]",
     FontWeight->"Bold"]}], TraditionalForm]],ExpressionUUID->
  "8acb5e15-7fc2-4429-935a-52fe4b68bb6c"]
}], "Section",
 CellChangeTimes->{{3.823148922206627*^9, 3.823148928390716*^9}, {
  3.823150615111183*^9, 3.8231506293599167`*^9}, {3.823150747950761*^9, 
  3.823150748549569*^9}, {3.823150795684841*^9, 3.8231509262696753`*^9}, {
  3.8231512481797132`*^9, 
  3.8231512984116573`*^9}},ExpressionUUID->"561ed868-d16a-4d18-90b8-\
e77a1b0b776b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HRHS", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"-", "\[Gamma]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["\[Alpha]", "2"]}], ")"}], "Ms"}]], " ", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mx", ",", "my", ",", "mz"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Hx", ",", "Hy", ",", "Hz"}], "}"}]}], "]"}]}], "-", " ", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Alpha]", " ", "\[Gamma]"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Alpha]", "2"]}], ")"}]], 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mx", ",", "my", ",", "mz"}], "}"}], ",", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mx", ",", "my", ",", "mz"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Hx", ",", "Hy", ",", "Hz"}], "}"}]}], "]"}]}], 
         "]"}]}]}], ")"}], "+", "st\[Tau]"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.82314919662469*^9, 3.823149212122205*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"4aa8480d-077c-4767-9edf-99b149a12936"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RHSmx", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]h", " ", 
      RowBox[{"HRHS", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "/.", "effectiveFieldSubstitute"}], "/.", 
    RowBox[{"{", 
     RowBox[{"st\[Tau]", "\[Rule]", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmy", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]h", " ", 
      RowBox[{"HRHS", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "/.", "effectiveFieldSubstitute"}], "/.", 
    RowBox[{"{", 
     RowBox[{"st\[Tau]", "\[Rule]", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmz", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]h", " ", 
      RowBox[{"HRHS", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "/.", "effectiveFieldSubstitute"}], "/.", 
    RowBox[{"{", 
     RowBox[{"st\[Tau]", "\[Rule]", "0"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.823149275834787*^9, 3.823149298710684*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"98b89b1a-5b50-439c-afd9-3dbe3b7c1ce0"],

Cell["\<\
Interesting... we moved over 1/Ms to both sides, this canceled the Ms on the \
damping term but brought it to the precessional term. This could be a \
problem...\
\>", "Text",
 CellChangeTimes->{{3.823150186607751*^9, 
  3.823150231702965*^9}},ExpressionUUID->"1d7de1d0-64a7-4719-9696-\
82d1e6f8f268"]
}, Closed]],

Cell[CellGroupData[{

Cell["        Algebra for exchange term", "Section",
 CellChangeTimes->{{3.8231493209040737`*^9, 
  3.823149327819518*^9}},ExpressionUUID->"2396f8a0-dd60-420e-8cce-\
072d7c0547aa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expandRHSmx", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"RHSmx", ",", "\[CapitalSigma]exc"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
       "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
       "d2mzdz2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numTermsRHSmx", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"RHSmx", ",", "\[CapitalSigma]exc"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
        "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
        "d2mzdz2"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"RHSmxEXCH", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"expandRHSmx", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "/.", "intByParts1"}], ",", 
        RowBox[{"varvec", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "numTermsRHSmx"}], "}"}]}], "]"}], "/.", 
    "intByParts2"}], "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.82314995118071*^9, 3.823149957781766*^9}, {
  3.823150058644405*^9, 3.823150059255477*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"ee17ac49-a45f-4c6a-8f4d-d3cace439586"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["Ms", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], 
  RowBox[{"2", " ", "Ae", " ", "\[Gamma]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"dmzdx", " ", "d\[Psi]hdx", " ", "my"}], "+", 
     RowBox[{"dmzdy", " ", "d\[Psi]hdy", " ", "my"}], "+", 
     RowBox[{"dmzdz", " ", "d\[Psi]hdz", " ", "my"}], "-", 
     RowBox[{"dmydx", " ", "d\[Psi]hdx", " ", "mz"}], "-", 
     RowBox[{"dmydy", " ", "d\[Psi]hdy", " ", "mz"}], "-", 
     RowBox[{"dmydz", " ", "d\[Psi]hdz", " ", "mz"}], "+", 
     RowBox[{
     "dmydx", " ", "d\[Psi]hdx", " ", "Ms", " ", "mx", " ", "my", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmydy", " ", "d\[Psi]hdy", " ", "Ms", " ", "mx", " ", "my", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmydz", " ", "d\[Psi]hdz", " ", "Ms", " ", "mx", " ", "my", " ", 
      "\[Alpha]"}], "-", 
     RowBox[{"dmxdx", " ", "d\[Psi]hdx", " ", "Ms", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmxdy", " ", "d\[Psi]hdy", " ", "Ms", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmxdz", " ", "d\[Psi]hdz", " ", "Ms", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]"}], "+", 
     RowBox[{
     "dmzdx", " ", "d\[Psi]hdx", " ", "Ms", " ", "mx", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmzdy", " ", "d\[Psi]hdy", " ", "Ms", " ", "mx", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmzdz", " ", "d\[Psi]hdz", " ", "Ms", " ", "mx", " ", "mz", " ", 
      "\[Alpha]"}], "-", 
     RowBox[{"dmxdx", " ", "d\[Psi]hdx", " ", "Ms", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmxdy", " ", "d\[Psi]hdy", " ", "Ms", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmxdz", " ", "d\[Psi]hdz", " ", "Ms", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]"}], "+", 
     RowBox[{"Ms", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["dmydx", "2"], " ", "mx"}], "+", 
        RowBox[{
         SuperscriptBox["dmydy", "2"], " ", "mx"}], "+", 
        RowBox[{
         SuperscriptBox["dmydz", "2"], " ", "mx"}], "+", 
        RowBox[{
         SuperscriptBox["dmzdx", "2"], " ", "mx"}], "+", 
        RowBox[{
         SuperscriptBox["dmzdy", "2"], " ", "mx"}], "+", 
        RowBox[{
         SuperscriptBox["dmzdz", "2"], " ", "mx"}], "-", 
        RowBox[{"dmxdx", " ", "dmydx", " ", "my"}], "-", 
        RowBox[{"dmxdy", " ", "dmydy", " ", "my"}], "-", 
        RowBox[{"dmxdz", " ", "dmydz", " ", "my"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dmxdx", " ", "dmzdx"}], "+", 
           RowBox[{"dmxdy", " ", "dmzdy"}], "+", 
           RowBox[{"dmxdz", " ", "dmzdz"}]}], ")"}], " ", "mz"}]}], ")"}], 
      " ", "\[Alpha]", " ", "\[Psi]h"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.823150061973235*^9},
 CellLabel->
  "Out[119]=",ExpressionUUID->"884f9faf-a682-49a8-9936-cdd13d17a58c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expandRHSmy", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"RHSmy", ",", "\[CapitalSigma]exc"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
       "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
       "d2mzdz2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numTermsRHSmy", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"RHSmy", ",", "\[CapitalSigma]exc"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
        "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
        "d2mzdz2"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"RHSmyEXCH", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"expandRHSmy", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "/.", "intByParts1"}], ",", 
        RowBox[{"varvec", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "numTermsRHSmy"}], "}"}]}], "]"}], "/.", 
    "intByParts2"}], "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{
  3.823149974611458*^9, {3.823150055212843*^9, 3.823150055970642*^9}, {
   3.8231501541609898`*^9, 3.82315015478885*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"ce39e57f-e0a8-4873-a360-41e0d1b16eb3"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["Ms", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], 
  RowBox[{"2", " ", "Ae", " ", "\[Gamma]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "dmzdx"}], " ", "d\[Psi]hdx", " ", "mx"}], "-", 
     RowBox[{"dmzdy", " ", "d\[Psi]hdy", " ", "mx"}], "-", 
     RowBox[{"dmzdz", " ", "d\[Psi]hdz", " ", "mx"}], "+", 
     RowBox[{"dmxdx", " ", "d\[Psi]hdx", " ", "mz"}], "+", 
     RowBox[{"dmxdy", " ", "d\[Psi]hdy", " ", "mz"}], "+", 
     RowBox[{"dmxdz", " ", "d\[Psi]hdz", " ", "mz"}], "-", 
     RowBox[{"dmydx", " ", "d\[Psi]hdx", " ", "Ms", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmydy", " ", "d\[Psi]hdy", " ", "Ms", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmydz", " ", "d\[Psi]hdz", " ", "Ms", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]"}], "+", 
     RowBox[{
     "dmxdx", " ", "d\[Psi]hdx", " ", "Ms", " ", "mx", " ", "my", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmxdy", " ", "d\[Psi]hdy", " ", "Ms", " ", "mx", " ", "my", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmxdz", " ", "d\[Psi]hdz", " ", "Ms", " ", "mx", " ", "my", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmzdx", " ", "d\[Psi]hdx", " ", "Ms", " ", "my", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmzdy", " ", "d\[Psi]hdy", " ", "Ms", " ", "my", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmzdz", " ", "d\[Psi]hdz", " ", "Ms", " ", "my", " ", "mz", " ", 
      "\[Alpha]"}], "-", 
     RowBox[{"dmydx", " ", "d\[Psi]hdx", " ", "Ms", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmydy", " ", "d\[Psi]hdy", " ", "Ms", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmydz", " ", "d\[Psi]hdz", " ", "Ms", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]"}], "+", 
     RowBox[{"Ms", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "dmxdx"}], " ", "dmydx", " ", "mx"}], "-", 
        RowBox[{"dmxdy", " ", "dmydy", " ", "mx"}], "-", 
        RowBox[{"dmxdz", " ", "dmydz", " ", "mx"}], "+", 
        RowBox[{
         SuperscriptBox["dmxdx", "2"], " ", "my"}], "+", 
        RowBox[{
         SuperscriptBox["dmxdy", "2"], " ", "my"}], "+", 
        RowBox[{
         SuperscriptBox["dmxdz", "2"], " ", "my"}], "+", 
        RowBox[{
         SuperscriptBox["dmzdx", "2"], " ", "my"}], "+", 
        RowBox[{
         SuperscriptBox["dmzdy", "2"], " ", "my"}], "+", 
        RowBox[{
         SuperscriptBox["dmzdz", "2"], " ", "my"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dmydx", " ", "dmzdx"}], "+", 
           RowBox[{"dmydy", " ", "dmzdy"}], "+", 
           RowBox[{"dmydz", " ", "dmzdz"}]}], ")"}], " ", "mz"}]}], ")"}], 
      " ", "\[Alpha]", " ", "\[Psi]h"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.8231501562235527`*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"024ad78a-23b0-409a-8e32-b6743b523445"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expandRHSmz", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"RHSmz", ",", "\[CapitalSigma]exc"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
       "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
       "d2mzdz2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numTermsRHSmz", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"RHSmz", ",", "\[CapitalSigma]exc"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
        "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
        "d2mzdz2"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"RHSmzEXCH", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"expandRHSmz", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "/.", "intByParts1"}], ",", 
        RowBox[{"varvec", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "numTermsRHSmz"}], "}"}]}], "]"}], "/.", 
    "intByParts2"}], "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.823150314429163*^9, 3.8231503228251266`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"81edb96c-ba96-4bcf-bc8c-0e3a0e38c00d"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["Ms", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], 
  RowBox[{"2", " ", "Ae", " ", "\[Gamma]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"dmydx", " ", "d\[Psi]hdx", " ", "mx"}], "+", 
     RowBox[{"dmydy", " ", "d\[Psi]hdy", " ", "mx"}], "+", 
     RowBox[{"dmydz", " ", "d\[Psi]hdz", " ", "mx"}], "-", 
     RowBox[{"dmxdx", " ", "d\[Psi]hdx", " ", "my"}], "-", 
     RowBox[{"dmxdy", " ", "d\[Psi]hdy", " ", "my"}], "-", 
     RowBox[{"dmxdz", " ", "d\[Psi]hdz", " ", "my"}], "-", 
     RowBox[{"dmzdx", " ", "d\[Psi]hdx", " ", "Ms", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmzdy", " ", "d\[Psi]hdy", " ", "Ms", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmzdz", " ", "d\[Psi]hdz", " ", "Ms", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmzdx", " ", "d\[Psi]hdx", " ", "Ms", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmzdy", " ", "d\[Psi]hdy", " ", "Ms", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmzdz", " ", "d\[Psi]hdz", " ", "Ms", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]"}], "+", 
     RowBox[{
     "dmxdx", " ", "d\[Psi]hdx", " ", "Ms", " ", "mx", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmxdy", " ", "d\[Psi]hdy", " ", "Ms", " ", "mx", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmxdz", " ", "d\[Psi]hdz", " ", "Ms", " ", "mx", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmydx", " ", "d\[Psi]hdx", " ", "Ms", " ", "my", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmydy", " ", "d\[Psi]hdy", " ", "Ms", " ", "my", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmydz", " ", "d\[Psi]hdz", " ", "Ms", " ", "my", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{"Ms", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "dmxdx"}], " ", "dmzdx", " ", "mx"}], "-", 
        RowBox[{"dmxdy", " ", "dmzdy", " ", "mx"}], "-", 
        RowBox[{"dmxdz", " ", "dmzdz", " ", "mx"}], "-", 
        RowBox[{"dmydx", " ", "dmzdx", " ", "my"}], "-", 
        RowBox[{"dmydy", " ", "dmzdy", " ", "my"}], "-", 
        RowBox[{"dmydz", " ", "dmzdz", " ", "my"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["dmxdx", "2"], "+", 
           SuperscriptBox["dmxdy", "2"], "+", 
           SuperscriptBox["dmxdz", "2"], "+", 
           SuperscriptBox["dmydx", "2"], "+", 
           SuperscriptBox["dmydy", "2"], "+", 
           SuperscriptBox["dmydz", "2"]}], ")"}], " ", "mz"}]}], ")"}], " ", 
      "\[Alpha]", " ", "\[Psi]h"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.823150323844399*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"1856c70f-8637-44b0-b4ce-d728d2af5310"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        Kernel for exchange", "Section",
 CellChangeTimes->{{3.823150338940117*^9, 
  3.823150372039863*^9}},ExpressionUUID->"2f02d2bd-0e0e-4eb3-87f0-\
04e73133a678"],

Cell[CellGroupData[{

Cell["        Residuals:", "Subsection",
 CellChangeTimes->{{3.823150365548266*^9, 
  3.823150375920673*^9}},ExpressionUUID->"2dcb3fed-ca30-4079-8597-\
fe5e0ff5479d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmxEXCH", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.7887665036032877`*^9, 3.788766590205453*^9}, {
   3.789224392003375*^9, 3.789224399088542*^9}, {3.789224691119982*^9, 
   3.789224691695429*^9}, {3.7897212240198193`*^9, 3.789721226389922*^9}, {
   3.7905739546066113`*^9, 3.79057395582373*^9}, {3.7905739956927223`*^9, 
   3.790574017931569*^9}, {3.790574211589744*^9, 3.790574214197143*^9}, {
   3.790937395250658*^9, 3.790937395438311*^9}, {3.790938364846133*^9, 
   3.790938365421235*^9}, 3.790939161021018*^9, {3.790941879820983*^9, 
   3.790941880583666*^9}, {3.7909421549030533`*^9, 3.790942155876746*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"79fd22c5-0677-46b9-9dfc-fe242b778343"],

Cell["\<\
(2*Ae*g0*(dmzdx*dtestdx*my + dmzdy*dtestdy*my + dmzdz*dtestdz*my + \
alpha*dmydx*dtestdx*Ms*mx*my + alpha*dmydy*dtestdy*Ms*mx*my + 
       alpha*dmydz*dtestdz*Ms*mx*my - alpha*dmxdx*dtestdx*Ms*Power(my,2) - \
alpha*dmxdy*dtestdy*Ms*Power(my,2) - 
       alpha*dmxdz*dtestdz*Ms*Power(my,2) - dmydx*dtestdx*mz - \
dmydy*dtestdy*mz - dmydz*dtestdz*mz + alpha*dmzdx*dtestdx*Ms*mx*mz + 
       alpha*dmzdy*dtestdy*Ms*mx*mz + alpha*dmzdz*dtestdz*Ms*mx*mz - \
alpha*dmxdx*dtestdx*Ms*Power(mz,2) - 
       alpha*dmxdy*dtestdy*Ms*Power(mz,2) - \
alpha*dmxdz*dtestdz*Ms*Power(mz,2) + 
       alpha*Ms*(Power(dmydx,2)*mx + Power(dmydy,2)*mx + Power(dmydz,2)*mx + \
Power(dmzdx,2)*mx + Power(dmzdy,2)*mx + 
          Power(dmzdz,2)*mx - dmxdx*dmydx*my - dmxdy*dmydy*my - \
dmxdz*dmydz*my - (dmxdx*dmzdx + dmxdy*dmzdy + dmxdz*dmzdz)*mz)*test))/
   ((1 + Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{{3.788766501308622*^9, 3.788766521499352*^9}, {
   3.788766556232833*^9, 3.788766608306416*^9}, 3.788767592755156*^9, 
   3.7887677924812317`*^9, 3.788767833483213*^9, 3.7888489455002728`*^9, 
   3.788849351143167*^9, 3.788849711750602*^9, 3.78921105357539*^9, 
   3.7892114329160767`*^9, {3.789224389554401*^9, 3.789224399965054*^9}, 
   3.789224650756081*^9, 3.789224692139022*^9, 3.7894601862303534`*^9, 
   3.78971352732668*^9, 3.7897199499595947`*^9, 3.7897212272885323`*^9, {
   3.7905739919062023`*^9, 3.7905740184987993`*^9}, 3.790574214974779*^9, {
   3.7909373914223948`*^9, 3.790937396138855*^9}, 3.790938326460455*^9, 
   3.790938366982645*^9, 3.790939162665497*^9, {3.7909418616601877`*^9, 
   3.7909418818508997`*^9}, 3.7909419651089163`*^9, 3.790942157190597*^9, 
   3.7909507687901897`*^9, 3.79126864068408*^9, 3.79126904829109*^9, 
   3.793683316578801*^9, 3.8067388312593193`*^9, 3.806739720030931*^9, 
   3.806742170579068*^9, 3.8068172280956783`*^9, 3.819453581581943*^9, 
   3.823150391808757*^9, 3.8231504435500507`*^9},
 CellLabel->
  "Out[128]//CForm=",ExpressionUUID->"c6a74596-d201-49f5-9d03-033649021e74"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmyEXCH", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.7887665799184*^9, 3.788766580317924*^9}, {
   3.788766611581106*^9, 3.788766612302409*^9}, {3.789224402573848*^9, 
   3.78922440397211*^9}, {3.789224688343865*^9, 3.789224688967578*^9}, 
   3.78972123073936*^9, {3.790574226290237*^9, 3.7905742293302307`*^9}, {
   3.790937398548139*^9, 3.79093739872077*^9}, {3.790938362795417*^9, 
   3.7909383631040993`*^9}, {3.790941892779089*^9, 3.790941893872539*^9}, {
   3.790942159023299*^9, 3.790942171774754*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"9445b612-1932-49cd-a2dc-1844aebe34ea"],

Cell["\<\
(2*Ae*g0*(-(dmzdx*dtestdx*mx) - dmzdy*dtestdy*mx - dmzdz*dtestdz*mx - \
alpha*dmydx*dtestdx*Ms*Power(mx,2) - 
       alpha*dmydy*dtestdy*Ms*Power(mx,2) - \
alpha*dmydz*dtestdz*Ms*Power(mx,2) + alpha*dmxdx*dtestdx*Ms*mx*my + 
       alpha*dmxdy*dtestdy*Ms*mx*my + alpha*dmxdz*dtestdz*Ms*mx*my + \
dmxdx*dtestdx*mz + dmxdy*dtestdy*mz + dmxdz*dtestdz*mz + 
       alpha*dmzdx*dtestdx*Ms*my*mz + alpha*dmzdy*dtestdy*Ms*my*mz + \
alpha*dmzdz*dtestdz*Ms*my*mz - 
       alpha*dmydx*dtestdx*Ms*Power(mz,2) - \
alpha*dmydy*dtestdy*Ms*Power(mz,2) - alpha*dmydz*dtestdz*Ms*Power(mz,2) + 
       alpha*Ms*(-(dmxdx*dmydx*mx) - dmxdy*dmydy*mx - dmxdz*dmydz*mx + \
Power(dmxdx,2)*my + Power(dmxdy,2)*my + Power(dmxdz,2)*my + 
          Power(dmzdx,2)*my + Power(dmzdy,2)*my + Power(dmzdz,2)*my - \
(dmydx*dmzdx + dmydy*dmzdy + dmydz*dmzdz)*mz)*test))/
   ((1 + Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{
  3.788766580850893*^9, 3.788766612877716*^9, 3.78876759277076*^9, 
   3.788767792599042*^9, 3.788767834582532*^9, 3.788848945795844*^9, 
   3.7888493512499037`*^9, 3.788849712828071*^9, 3.789211054714602*^9, 
   3.789211434198256*^9, 3.789224404399119*^9, 3.789224651415595*^9, 
   3.789224689487124*^9, 3.789460187747799*^9, 3.789713530140608*^9, 
   3.789719951525585*^9, 3.789721264831463*^9, 3.7905742297096024`*^9, 
   3.7909373992327967`*^9, 3.790938329092622*^9, 3.79093836815796*^9, 
   3.790939169121087*^9, 3.790941898334902*^9, 3.7909419643519783`*^9, {
   3.7909421636612997`*^9, 3.79094217574363*^9}, 3.790950769606798*^9, 
   3.791268647165443*^9, 3.791269049841016*^9, 3.793683318255158*^9, 
   3.8067388312701797`*^9, 3.806739720139344*^9, 3.806742170755103*^9, 
   3.806817230303933*^9, 3.8194535865264893`*^9, 3.82315044513526*^9},
 CellLabel->
  "Out[129]//CForm=",ExpressionUUID->"885e7f6c-1296-4c85-b889-121661bd58eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmzEXCH", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.78876658391778*^9, 3.7887665842540894`*^9}, {
   3.788766615116439*^9, 3.788766615503327*^9}, {3.789224406367539*^9, 
   3.789224408569437*^9}, {3.789224685615699*^9, 3.789224686175523*^9}, 
   3.789721232850727*^9, {3.790574232465568*^9, 3.790574234946233*^9}, {
   3.790937401103056*^9, 3.7909374012697773`*^9}, {3.7909383373896437`*^9, 
   3.79093835687037*^9}, {3.790941895142663*^9, 3.7909418958212557`*^9}, {
   3.790942167296096*^9, 3.790942173898416*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"edf23143-6597-46bb-8eda-cab6c7ac2639"],

Cell["\<\
(2*Ae*g0*(dmydx*dtestdx*mx + dmydy*dtestdy*mx + dmydz*dtestdz*mx - \
alpha*dmzdx*dtestdx*Ms*Power(mx,2) - 
       alpha*dmzdy*dtestdy*Ms*Power(mx,2) - \
alpha*dmzdz*dtestdz*Ms*Power(mx,2) - dmxdx*dtestdx*my - dmxdy*dtestdy*my - 
       dmxdz*dtestdz*my - alpha*dmzdx*dtestdx*Ms*Power(my,2) - \
alpha*dmzdy*dtestdy*Ms*Power(my,2) - 
       alpha*dmzdz*dtestdz*Ms*Power(my,2) + alpha*dmxdx*dtestdx*Ms*mx*mz + \
alpha*dmxdy*dtestdy*Ms*mx*mz + 
       alpha*dmxdz*dtestdz*Ms*mx*mz + alpha*dmydx*dtestdx*Ms*my*mz + \
alpha*dmydy*dtestdy*Ms*my*mz + alpha*dmydz*dtestdz*Ms*my*mz + 
       alpha*Ms*(-(dmxdx*dmzdx*mx) - dmxdy*dmzdy*mx - dmxdz*dmzdz*mx - \
dmydx*dmzdx*my - dmydy*dmzdy*my - dmydz*dmzdz*my + 
          (Power(dmxdx,2) + Power(dmxdy,2) + Power(dmxdz,2) + Power(dmydx,2) \
+ Power(dmydy,2) + Power(dmydz,2))*mz)*test))/
   ((1 + Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{
  3.788766584640018*^9, 3.788766616003661*^9, 3.7887675929168*^9, 
   3.7887677927187557`*^9, 3.788767835653442*^9, 3.78884894601062*^9, 
   3.788849351341001*^9, 3.788849713749051*^9, 3.7892110560727673`*^9, 
   3.78921143514633*^9, 3.789224408963687*^9, 3.78922465249994*^9, 
   3.7892246867864103`*^9, 3.7894601891039658`*^9, 3.789713532298283*^9, 
   3.78971995304801*^9, 3.789721266263465*^9, 3.790574235358863*^9, 
   3.790937402128479*^9, {3.7909383306717453`*^9, 3.790938368221581*^9}, 
   3.7909391716723137`*^9, 3.7909418991139603`*^9, 3.790941962759951*^9, 
   3.790942104720394*^9, {3.790942168392202*^9, 3.790942174888774*^9}, 
   3.7909507708673067`*^9, 3.791268649508407*^9, 3.791269051522208*^9, 
   3.793683319986457*^9, 3.8067388314065313`*^9, 3.806739720251569*^9, 
   3.806742171247849*^9, 3.806817232189094*^9, 3.819453591273374*^9, 
   3.823150446943499*^9},
 CellLabel->
  "Out[130]//CForm=",ExpressionUUID->"082f1f32-0d65-4725-ba1b-1c13a3b7fb96"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        On-diagonal jacobian entries", "Subsection",
 CellChangeTimes->{{3.8231505360972223`*^9, 3.8231505462854013`*^9}, {
  3.823150593919609*^9, 
  3.823150594623035*^9}},ExpressionUUID->"abb39c8d-b5de-4d28-8cca-\
f5a4ceb6d036"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxEXCH", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.788766625931375*^9, 3.788766733461341*^9}, {
   3.7887668545278893`*^9, 3.788766855295376*^9}, {3.7887669153900223`*^9, 
   3.788767095058152*^9}, 3.78876719259743*^9, {3.789224658053955*^9, 
   3.7892246818790283`*^9}, 3.789721235331017*^9, {3.790574252592458*^9, 
   3.790574255888419*^9}, 3.790938516647736*^9, {3.7909419000572557`*^9, 
   3.790941909443611*^9}, {3.7909421791951427`*^9, 3.790942179593205*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"8fb1568d-3add-4f45-a525-1c922a2bf45e"],

Cell["\<\
(2*Ae*alpha*g0*(-(dphidz*dtestdz*Power(my,2)) - dphidz*dtestdz*Power(mz,2) + \
dmydx*dtestdx*my*phi + dmydy*dtestdy*my*phi + 
       dmydz*dtestdz*my*phi + dmzdx*dtestdx*mz*phi + dmzdy*dtestdy*mz*phi + \
dmzdz*dtestdz*mz*phi - dphidz*(dmydz*my + dmzdz*mz)*test + 
       (Power(dmydx,2) + Power(dmydy,2) + Power(dmydz,2) + Power(dmzdx,2) + \
Power(dmzdy,2) + Power(dmzdz,2))*phi*test - 
       dphidy*(dtestdy*Power(my,2) + dtestdy*Power(mz,2) + dmydy*my*test + \
dmzdy*mz*test) - 
       dphidx*(dtestdx*(Power(my,2) + Power(mz,2)) + (dmydx*my + \
dmzdx*mz)*test)))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{{3.788766632008133*^9, 3.788766648025016*^9}, 
   3.788766682638452*^9, 3.78876673400174*^9, 3.788766881413435*^9, {
   3.788766916933836*^9, 3.7887671090354977`*^9}, 3.7887671932820673`*^9, 
   3.78876759315943*^9, 3.788767792877295*^9, 3.788767838459116*^9, 
   3.7888489462109737`*^9, 3.788849351495001*^9, 3.788849715493628*^9, 
   3.789211057531961*^9, 3.789211436648541*^9, {3.7892246536620483`*^9, 
   3.789224682467248*^9}, 3.789460190915688*^9, 3.789713534040369*^9, 
   3.789719954486865*^9, {3.789721237586265*^9, 3.7897212625600233`*^9}, {
   3.790574257561987*^9, 3.790574267229103*^9}, 3.790938525216605*^9, 
   3.790939173590217*^9, {3.790941901908885*^9, 3.7909419185484877`*^9}, 
   3.790941961771316*^9, 3.7909421806653547`*^9, 3.79095077202835*^9, 
   3.791268652647053*^9, 3.7912690536871843`*^9, 3.7936833241696663`*^9, 
   3.806738831555254*^9, 3.806739720374791*^9, 3.806742171534554*^9, 
   3.819453596120048*^9, 3.823150559138112*^9},
 CellLabel->
  "Out[131]//CForm=",ExpressionUUID->"0f6a3fdf-b259-449b-9bf2-d998be5d1da8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyEXCH", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.7887671164038982`*^9, 3.788767118465036*^9}, {
   3.788767199684679*^9, 3.7887672033402233`*^9}, {3.7892246623736467`*^9, 
   3.7892246786229877`*^9}, 3.789721236709538*^9, {3.7905742612962933`*^9, 
   3.7905742619733562`*^9}, {3.790938519387527*^9, 3.7909385200750513`*^9}, {
   3.7909419026126757`*^9, 3.790941906923915*^9}, 3.790942182554388*^9},
 CellLabel->
  "In[132]:=",ExpressionUUID->"3daebc25-f3b2-4fdf-8b4a-f8620b9632ca"],

Cell["\<\
(2*Ae*alpha*g0*(-(dphidz*dtestdz*Power(mx,2)) - dphidz*dtestdz*Power(mz,2) + \
dmxdx*dtestdx*mx*phi + dmxdy*dtestdy*mx*phi + 
       dmxdz*dtestdz*mx*phi + dmzdx*dtestdx*mz*phi + dmzdy*dtestdy*mz*phi + \
dmzdz*dtestdz*mz*phi - dphidz*(dmxdz*mx + dmzdz*mz)*test + 
       (Power(dmxdx,2) + Power(dmxdy,2) + Power(dmxdz,2) + Power(dmzdx,2) + \
Power(dmzdy,2) + Power(dmzdz,2))*phi*test - 
       dphidy*(dtestdy*Power(mx,2) + dtestdy*Power(mz,2) + dmxdy*mx*test + \
dmzdy*mz*test) - 
       dphidx*(dtestdx*(Power(mx,2) + Power(mz,2)) + (dmxdx*mx + \
dmzdx*mz)*test)))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.823150569672126*^9},
 CellLabel->
  "Out[132]//CForm=",ExpressionUUID->"bd0c98e0-83d8-4a33-b1dd-b31bed70e9c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzEXCH", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[133]:=",ExpressionUUID->"d114960d-0fc1-442f-8e42-9975784493c8"],

Cell["\<\
(2*Ae*alpha*g0*(-(dphidz*dtestdz*Power(mx,2)) - dphidz*dtestdz*Power(my,2) + \
dmxdx*dtestdx*mx*phi + dmxdy*dtestdy*mx*phi + 
       dmxdz*dtestdz*mx*phi + dmydx*dtestdx*my*phi + dmydy*dtestdy*my*phi + \
dmydz*dtestdz*my*phi - dphidz*(dmxdz*mx + dmydz*my)*test + 
       (Power(dmxdx,2) + Power(dmxdy,2) + Power(dmxdz,2) + Power(dmydx,2) + \
Power(dmydy,2) + Power(dmydz,2))*phi*test - 
       dphidy*(dtestdy*Power(mx,2) + dtestdy*Power(my,2) + dmxdy*mx*test + \
dmydy*my*test) - 
       dphidx*(dtestdx*(Power(mx,2) + Power(my,2)) + (dmxdx*mx + \
dmydx*my)*test)))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.82315057905896*^9},
 CellLabel->
  "Out[133]//CForm=",ExpressionUUID->"66b37e94-8538-4f4c-8da8-84c603aa4edc"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        Off-diagonal jacobian entries", "Subsection",
 CellChangeTimes->{{3.823150585431354*^9, 
  3.823150597271212*^9}},ExpressionUUID->"9c9c765a-c221-4236-9c32-\
b690e2a42e24"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxEXCH", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[134]:=",ExpressionUUID->"744086df-8cb8-4036-bbbe-92dea9a44f85"],

Cell["\<\
(2*Ae*g0*(-((dphidx*dtestdx + dphidy*dtestdy + dphidz*dtestdz)*mz) + \
(dmzdx*dtestdx + dmzdy*dtestdy + dmzdz*dtestdz)*phi + 
       alpha*Ms*(dphidx*dtestdx*mx*my + dphidy*dtestdy*mx*my + \
dphidz*dtestdz*mx*my + dmydx*dtestdx*mx*phi + dmydy*dtestdy*mx*phi + 
          dmydz*dtestdz*mx*phi - 2*dmxdx*dtestdx*my*phi - \
2*dmxdy*dtestdy*my*phi - 2*dmxdz*dtestdz*my*phi + 
          (2*dmydx*dphidx*mx + 2*dmydy*dphidy*mx + 2*dmydz*dphidz*mx - \
dmxdx*dphidx*my - dmxdy*dphidy*my - dmxdz*dphidz*my - 
             (dmxdx*dmydx + dmxdy*dmydy + dmxdz*dmydz)*phi)*test)))/((1 + \
Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{3.8231506928669367`*^9},
 CellLabel->
  "Out[134]//CForm=",ExpressionUUID->"4ebc0444-c9fa-446a-b256-a99e3262e87d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxEXCH", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[135]:=",ExpressionUUID->"e2458c0d-2418-4656-a3d0-6dd0e5a02da5"],

Cell["\<\
(2*Ae*g0*(dphidx*dtestdx*my + dphidy*dtestdy*my + dphidz*dtestdz*my + \
alpha*dphidx*dtestdx*Ms*mx*mz + alpha*dphidy*dtestdy*Ms*mx*mz + 
       alpha*dphidz*dtestdz*Ms*mx*mz - dmydx*dtestdx*phi - dmydy*dtestdy*phi \
- dmydz*dtestdz*phi + alpha*dmzdx*dtestdx*Ms*mx*phi + 
       alpha*dmzdy*dtestdy*Ms*mx*phi + alpha*dmzdz*dtestdz*Ms*mx*phi - \
2*alpha*dmxdx*dtestdx*Ms*mz*phi - 
       2*alpha*dmxdy*dtestdy*Ms*mz*phi - 2*alpha*dmxdz*dtestdz*Ms*mz*phi + 
       alpha*Ms*(2*dmzdx*dphidx*mx + 2*dmzdy*dphidy*mx + 2*dmzdz*dphidz*mx - \
(dmxdx*dphidx + dmxdy*dphidy + dmxdz*dphidz)*mz - 
          (dmxdx*dmzdx + dmxdy*dmzdy + dmxdz*dmzdz)*phi)*test))/((1 + \
Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{3.823150706050523*^9},
 CellLabel->
  "Out[135]//CForm=",ExpressionUUID->"88941e37-0600-4503-b192-0d6f76f69476"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyEXCH", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[136]:=",ExpressionUUID->"ca3c4e90-55b5-412a-ba6c-c8c1bb821186"],

Cell["\<\
(2*Ae*g0*((dphidx*dtestdx + dphidy*dtestdy + dphidz*dtestdz)*mz - \
(dmzdx*dtestdx + dmzdy*dtestdy + dmzdz*dtestdz)*phi + 
       alpha*Ms*(dphidx*dtestdx*mx*my + dphidy*dtestdy*mx*my + \
dphidz*dtestdz*mx*my - 2*dmydx*dtestdx*mx*phi - 2*dmydy*dtestdy*mx*phi - 
          2*dmydz*dtestdz*mx*phi + dmxdx*dtestdx*my*phi + \
dmxdy*dtestdy*my*phi + dmxdz*dtestdz*my*phi - 
          (dmydx*dphidx*mx + dmydy*dphidy*mx + dmydz*dphidz*mx - \
2*dmxdx*dphidx*my - 2*dmxdy*dphidy*my - 2*dmxdz*dphidz*my + 
             dmxdx*dmydx*phi + dmxdy*dmydy*phi + dmxdz*dmydz*phi)*test)))/((1 \
+ Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{3.823150707766218*^9},
 CellLabel->
  "Out[136]//CForm=",ExpressionUUID->"2e52c13e-0bb0-4127-b2c0-9b534a85a1c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyEXCH", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[137]:=",ExpressionUUID->"2f885001-4c92-4b18-96b5-ac6c7d6913e7"],

Cell["\<\
(2*Ae*g0*(-(dphidx*dtestdx*mx) - dphidy*dtestdy*mx - dphidz*dtestdz*mx + \
alpha*dphidx*dtestdx*Ms*my*mz + 
       alpha*dphidy*dtestdy*Ms*my*mz + alpha*dphidz*dtestdz*Ms*my*mz + \
dmxdx*dtestdx*phi + dmxdy*dtestdy*phi + dmxdz*dtestdz*phi + 
       alpha*dmzdx*dtestdx*Ms*my*phi + alpha*dmzdy*dtestdy*Ms*my*phi + \
alpha*dmzdz*dtestdz*Ms*my*phi - 
       2*alpha*dmydx*dtestdx*Ms*mz*phi - 2*alpha*dmydy*dtestdy*Ms*mz*phi - \
2*alpha*dmydz*dtestdz*Ms*mz*phi + 
       alpha*Ms*(2*dmzdx*dphidx*my + 2*dmzdy*dphidy*my + 2*dmzdz*dphidz*my - \
(dmydx*dphidx + dmydy*dphidy + dmydz*dphidz)*mz - 
          (dmydx*dmzdx + dmydy*dmzdy + dmydz*dmzdz)*phi)*test))/((1 + \
Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{3.823150725322674*^9},
 CellLabel->
  "Out[137]//CForm=",ExpressionUUID->"8e8a3b50-54c1-4468-8813-8da1f2ca5a37"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzEXCH", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[138]:=",ExpressionUUID->"4c404825-052f-4a77-b71d-29e1e43b3840"],

Cell["\<\
(2*Ae*g0*(-(dphidx*dtestdx*my) - dphidy*dtestdy*my - dphidz*dtestdz*my + \
alpha*dphidx*dtestdx*Ms*mx*mz + 
       alpha*dphidy*dtestdy*Ms*mx*mz + alpha*dphidz*dtestdz*Ms*mx*mz + \
dmydx*dtestdx*phi + dmydy*dtestdy*phi + dmydz*dtestdz*phi - 
       2*alpha*dmzdx*dtestdx*Ms*mx*phi - 2*alpha*dmzdy*dtestdy*Ms*mx*phi - \
2*alpha*dmzdz*dtestdz*Ms*mx*phi + 
       alpha*dmxdx*dtestdx*Ms*mz*phi + alpha*dmxdy*dtestdy*Ms*mz*phi + \
alpha*dmxdz*dtestdz*Ms*mz*phi - 
       alpha*Ms*(dmzdx*dphidx*mx + dmzdy*dphidy*mx + dmzdz*dphidz*mx - \
2*dmxdx*dphidx*mz - 2*dmxdy*dphidy*mz - 2*dmxdz*dphidz*mz + 
          dmxdx*dmzdx*phi + dmxdy*dmzdy*phi + dmxdz*dmzdz*phi)*test))/((1 + \
Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{3.823150727179471*^9},
 CellLabel->
  "Out[138]//CForm=",ExpressionUUID->"f430233d-6b26-4ba9-9f6f-ef3c642ef6ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzEXCH", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[139]:=",ExpressionUUID->"2901b736-69f9-4f0c-934c-823e47423150"],

Cell["\<\
(2*Ae*g0*(dphidx*dtestdx*mx + dphidy*dtestdy*mx + dphidz*dtestdz*mx + \
alpha*dphidx*dtestdx*Ms*my*mz + alpha*dphidy*dtestdy*Ms*my*mz + 
       alpha*dphidz*dtestdz*Ms*my*mz - dmxdx*dtestdx*phi - dmxdy*dtestdy*phi \
- dmxdz*dtestdz*phi - 2*alpha*dmzdx*dtestdx*Ms*my*phi - 
       2*alpha*dmzdy*dtestdy*Ms*my*phi - 2*alpha*dmzdz*dtestdz*Ms*my*phi + \
alpha*dmydx*dtestdx*Ms*mz*phi + 
       alpha*dmydy*dtestdy*Ms*mz*phi + alpha*dmydz*dtestdz*Ms*mz*phi - 
       alpha*Ms*(dmzdx*dphidx*my + dmzdy*dphidy*my + dmzdz*dphidz*my - \
2*dmydx*dphidx*mz - 2*dmydy*dphidy*mz - 2*dmydz*dphidz*mz + 
          dmydx*dmzdx*phi + dmydy*dmzdy*phi + dmydz*dmzdz*phi)*test))/((1 + \
Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{3.823150738361082*^9},
 CellLabel->
  "Out[139]//CForm=",ExpressionUUID->"56b656a2-79d6-4b65-9ef8-bd0e7f4cb418"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["        Kernel for interaction", "Section",
 CellChangeTimes->{{3.823151223451388*^9, 
  3.823151230767522*^9}},ExpressionUUID->"047aa2f6-b27c-4f3e-b5b0-\
37bb43990839"],

Cell[CellGroupData[{

Cell["        Residuals", "Subsection",
 CellChangeTimes->{{3.8231518724781446`*^9, 
  3.8231518770113993`*^9}},ExpressionUUID->"c33de142-c5fe-4952-85c9-\
acc18d1efc0c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHSmxINT", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"RHSmx", ",", "\[CapitalSigma]int"}], "]"}], "//", 
   "Expand"}]}]], "Input",
 CellChangeTimes->{{3.789719989727571*^9, 3.789719990847418*^9}, 
   3.790574309037211*^9, {3.790942214124803*^9, 3.790942214371675*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"194e88a0-6c82-4e75-8688-c8e7ec9ae10a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"d\[CapitalPhi]dz", " ", "my", " ", "\[Gamma]", " ", "\[Psi]h"}], 
   RowBox[{"Ms", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"d\[CapitalPhi]dy", " ", "mz", " ", "\[Gamma]", " ", "\[Psi]h"}], 
   RowBox[{"Ms", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
   "d\[CapitalPhi]dy", " ", "mx", " ", "my", " ", "\[Alpha]", " ", "\[Gamma]",
     " ", "\[Psi]h"}], 
   RowBox[{"1", "+", 
    SuperscriptBox["\[Alpha]", "2"]}]], "-", 
  FractionBox[
   RowBox[{"d\[CapitalPhi]dx", " ", 
    SuperscriptBox["my", "2"], " ", "\[Alpha]", " ", "\[Gamma]", " ", 
    "\[Psi]h"}], 
   RowBox[{"1", "+", 
    SuperscriptBox["\[Alpha]", "2"]}]], "+", 
  FractionBox[
   RowBox[{
   "d\[CapitalPhi]dz", " ", "mx", " ", "mz", " ", "\[Alpha]", " ", "\[Gamma]",
     " ", "\[Psi]h"}], 
   RowBox[{"1", "+", 
    SuperscriptBox["\[Alpha]", "2"]}]], "-", 
  FractionBox[
   RowBox[{"d\[CapitalPhi]dx", " ", 
    SuperscriptBox["mz", "2"], " ", "\[Alpha]", " ", "\[Gamma]", " ", 
    "\[Psi]h"}], 
   RowBox[{"1", "+", 
    SuperscriptBox["\[Alpha]", "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.788768371632365*^9, 3.788848948677628*^9, 3.788849352694433*^9, 
   3.788849728255604*^9, 3.789211066981797*^9, 3.7892114477929153`*^9, 
   3.789224772232357*^9, 3.789460202815075*^9, 3.789712913599732*^9, {
   3.789719971925721*^9, 3.789719991186401*^9}, 3.7897224335937643`*^9, {
   3.790574310385408*^9, 3.790574317812516*^9}, 3.790577305334509*^9, 
   3.790577383583762*^9, 3.790938920492763*^9, 3.790939185494164*^9, 
   3.790942215065105*^9, 3.790945692165905*^9, 3.791268669736842*^9, 
   3.791269069819805*^9, 3.793683604206596*^9, 3.8067388332840023`*^9, 
   3.806739721539978*^9, 3.806742174395669*^9, 3.819453650754521*^9, 
   3.823151812998564*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"047e7cc0-7a84-4b5c-b872-e0cfb4e93fe0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmxINT", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[148]:=",ExpressionUUID->"d1d9d50f-cc42-4e5a-9223-21a3ceb6388e"],

Cell["\<\
(g0*(-(dPotdy*mz) + dPotdz*(my + alpha*Ms*mx*mz) + alpha*Ms*(dPotdy*mx*my - \
dPotdx*(Power(my,2) + Power(mz,2))))*test)/
   ((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.823151822914668*^9, 3.823151865415551*^9},
 CellLabel->
  "Out[148]//CForm=",ExpressionUUID->"d4e36dd5-f178-4a14-b8fb-88322731aff2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHSmyINT", "=", 
  RowBox[{"D", "[", 
   RowBox[{"RHSmy", ",", "\[CapitalSigma]int"}], "]"}]}]], "Input",
 CellLabel->
  "In[149]:=",ExpressionUUID->"fef6e744-d8ee-4796-95fa-5f4a2415a3e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"d\[CapitalPhi]dz", " ", "mx", " ", "\[Gamma]"}], 
      RowBox[{"Ms", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]]}], "+", 
    FractionBox[
     RowBox[{"d\[CapitalPhi]dx", " ", "mz", " ", "\[Gamma]"}], 
     RowBox[{"Ms", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"d\[CapitalPhi]dy", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]", " ", "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "+", 
    FractionBox[
     RowBox[{
     "d\[CapitalPhi]dx", " ", "mx", " ", "my", " ", "\[Alpha]", " ", 
      "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "+", 
    FractionBox[
     RowBox[{
     "d\[CapitalPhi]dz", " ", "my", " ", "mz", " ", "\[Alpha]", " ", 
      "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "-", 
    FractionBox[
     RowBox[{"d\[CapitalPhi]dy", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]", " ", "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]]}], ")"}], " ", "\[Psi]h"}]], "Output",\

 CellChangeTimes->{{3.823151838686267*^9, 3.82315186611779*^9}},
 CellLabel->
  "Out[149]=",ExpressionUUID->"44078560-d20a-4a05-9779-8e2bcadf291f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmyINT", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[147]:=",ExpressionUUID->"1b4cd2d3-9915-4293-8527-dd7e4addac93"],

Cell["\<\
(g0*(dPotdx*mz + dPotdz*(-mx + alpha*Ms*my*mz) + alpha*Ms*(dPotdx*mx*my - \
dPotdy*(Power(mx,2) + Power(mz,2))))*test)/
   ((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{{3.823151839807111*^9, 3.8231518639351587`*^9}},
 CellLabel->
  "Out[147]//CForm=",ExpressionUUID->"8ac9fe2d-ff1a-4488-82ff-f548709e8075"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHSmzINT", "=", 
  RowBox[{"D", "[", 
   RowBox[{"RHSmz", ",", "\[CapitalSigma]int"}], "]"}]}]], "Input",
 CellLabel->
  "In[146]:=",ExpressionUUID->"49aa4302-5dac-4ad3-8d44-d64c3ad0c7e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{"d\[CapitalPhi]dy", " ", "mx", " ", "\[Gamma]"}], 
     RowBox[{"Ms", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"d\[CapitalPhi]dx", " ", "my", " ", "\[Gamma]"}], 
     RowBox[{"Ms", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"d\[CapitalPhi]dz", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]", " ", "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "-", 
    FractionBox[
     RowBox[{"d\[CapitalPhi]dz", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]", " ", "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "+", 
    FractionBox[
     RowBox[{
     "d\[CapitalPhi]dx", " ", "mx", " ", "mz", " ", "\[Alpha]", " ", 
      "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "+", 
    FractionBox[
     RowBox[{
     "d\[CapitalPhi]dy", " ", "my", " ", "mz", " ", "\[Alpha]", " ", 
      "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]]}], ")"}], " ", "\[Psi]h"}]], "Output",\

 CellChangeTimes->{{3.823151849381711*^9, 3.823151863347665*^9}},
 CellLabel->
  "Out[146]=",ExpressionUUID->"17d33e19-a22d-48f3-9673-aa87726ea5fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmzINT", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[145]:=",ExpressionUUID->"f1755b89-03dd-4ba0-b81e-50bdfda97df2"],

Cell["\<\
(g0*(-(dPotdx*my) + alpha*Ms*(-(dPotdz*(Power(mx,2) + Power(my,2))) + \
dPotdx*mx*mz) + dPotdy*(mx + alpha*Ms*my*mz))*test)/
   ((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.823151862293811*^9},
 CellLabel->
  "Out[145]//CForm=",ExpressionUUID->"88a34cc3-9ee9-4722-addb-6fabc0277098"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        On-diagonal jacobian entries", "Subsection",
 CellChangeTimes->{{3.823151882742093*^9, 
  3.8231518961697817`*^9}},ExpressionUUID->"c1c54794-7876-4f07-86a4-\
c16a3b25c713"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxINT", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[150]:=",ExpressionUUID->"6643024b-06ee-4b94-9e3c-a506dbe602e2"],

Cell["\<\
(alpha*g0*(dPotdy*my + dPotdz*mz)*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{3.823152007398583*^9},
 CellLabel->
  "Out[150]//CForm=",ExpressionUUID->"7f2710fa-eba4-4084-b1b5-df9e8bd0e075"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyINT", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[151]:=",ExpressionUUID->"27d9e5f9-0efd-4419-bc7b-ccf5decee5b3"],

Cell["\<\
(alpha*g0*(dPotdx*mx + dPotdz*mz)*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{3.823152015385253*^9},
 CellLabel->
  "Out[151]//CForm=",ExpressionUUID->"ec6820f6-f322-4f22-896f-860335cededc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzINT", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[152]:=",ExpressionUUID->"b8f30609-920e-483c-881a-6a5ee0816950"],

Cell["\<\
(alpha*g0*(dPotdx*mx + dPotdy*my)*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{3.823152022656448*^9},
 CellLabel->
  "Out[152]//CForm=",ExpressionUUID->"9b0e21a2-ee64-49b8-9458-9e7284fb648b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        Off-diagonal jacobian entries", "Subsection",
 CellChangeTimes->{{3.82315188971838*^9, 
  3.8231518965418987`*^9}},ExpressionUUID->"c15ae1f0-d8d7-4437-8ff6-\
4861cddc5991"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxINT", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[153]:=",ExpressionUUID->"2fee91e9-9fb7-4b56-81ac-e599d3bdddc0"],

Cell["\<\
(g0*(dPotdz + alpha*Ms*(dPotdy*mx - 2*dPotdx*my))*phi*test)/((1 + \
Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.82315204599724*^9},
 CellLabel->
  "Out[153]//CForm=",ExpressionUUID->"27f0722a-5f93-4306-a3a6-23a817669a05"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxINT", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[154]:=",ExpressionUUID->"85eed928-eb68-4283-8ee5-fdb84daba9c5"],

Cell["\<\
(g0*(-dPotdy + alpha*Ms*(dPotdz*mx - 2*dPotdx*mz))*phi*test)/((1 + \
Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.82315204696579*^9},
 CellLabel->
  "Out[154]//CForm=",ExpressionUUID->"bb1fab76-80fd-438a-a454-90e4bc20e59f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"RHSmxINT", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d\[CapitalPhi]dx", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dx", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dy", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dy", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dz", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dz", "[", "\[CapitalPhi]0", "]"}]}]}], 
        "}"}]}], ",", "\[CapitalPhi]0"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dx", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidx"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dy", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidy"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dz", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidz"}]}], "}"}]}], "//", "FullSimplify"}], "//", 
  "CForm"}]], "Input",
 CellLabel->
  "In[155]:=",ExpressionUUID->"c5310808-7a86-4aca-86f1-2dc8b03a5a71"],

Cell["\<\
(g0*(-(dphidy*mz) + dphidz*(my + alpha*Ms*mx*mz) + alpha*Ms*(dphidy*mx*my - \
dphidx*(Power(my,2) + Power(mz,2))))*test)/
   ((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.8231520604855413`*^9},
 CellLabel->
  "Out[155]//CForm=",ExpressionUUID->"7dbe93dc-2281-4ddd-b8be-e01c189814c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyINT", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[156]:=",ExpressionUUID->"54478118-094d-4150-a7a0-fd0ba26d26ee"],

Cell["\<\
-((g0*(dPotdz + alpha*Ms*(2*dPotdy*mx - dPotdx*my))*phi*test)/((1 + \
Power(alpha,2))*Ms))\
\>", "Output",
 CellChangeTimes->{3.8231520957585173`*^9},
 CellLabel->
  "Out[156]//CForm=",ExpressionUUID->"8b8d4dc8-63bf-43f8-bced-b53644c87b8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyINT", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[157]:=",ExpressionUUID->"f21aa3ee-56b4-4544-8332-e60833e1073f"],

Cell["\<\
(g0*(dPotdx + alpha*Ms*(dPotdz*my - 2*dPotdy*mz))*phi*test)/((1 + \
Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.8231521035428762`*^9},
 CellLabel->
  "Out[157]//CForm=",ExpressionUUID->"9e7bad4d-e012-46e0-9d48-48d4d8776594"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"RHSmyINT", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d\[CapitalPhi]dx", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dx", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dy", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dy", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dz", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dz", "[", "\[CapitalPhi]0", "]"}]}]}], 
        "}"}]}], ",", "\[CapitalPhi]0"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dx", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidx"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dy", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidy"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dz", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidz"}]}], "}"}]}], "//", "FullSimplify"}], "//", 
  "CForm"}]], "Input",
 CellLabel->
  "In[158]:=",ExpressionUUID->"fe961710-f123-46dd-a4a7-2b32ecb51a64"],

Cell["\<\
(g0*(dphidx*mz + dphidz*(-mx + alpha*Ms*my*mz) + alpha*Ms*(dphidx*mx*my - \
dphidy*(Power(mx,2) + Power(mz,2))))*test)/
   ((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.8231521128381243`*^9},
 CellLabel->
  "Out[158]//CForm=",ExpressionUUID->"f08596f2-0be0-4098-9fd9-03fb2f5ab5f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzINT", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[159]:=",ExpressionUUID->"026b227b-06d5-4b86-b817-fbe30d84c9a3"],

Cell["\<\
(g0*(dPotdy + alpha*Ms*(-2*dPotdz*mx + dPotdx*mz))*phi*test)/((1 + \
Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.823152131826785*^9},
 CellLabel->
  "Out[159]//CForm=",ExpressionUUID->"8fc9139b-4fa1-4342-a364-52951259d3b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzINT", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[160]:=",ExpressionUUID->"75072a16-1b23-449c-80bf-180ba8bf557b"],

Cell["\<\
-((g0*(dPotdx + alpha*Ms*(2*dPotdz*my - dPotdy*mz))*phi*test)/((1 + \
Power(alpha,2))*Ms))\
\>", "Output",
 CellChangeTimes->{3.823152140864798*^9},
 CellLabel->
  "Out[160]//CForm=",ExpressionUUID->"6047f7a9-8fb2-487b-8309-47b85abe798a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"RHSmzINT", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d\[CapitalPhi]dx", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dx", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dy", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dy", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dz", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dz", "[", "\[CapitalPhi]0", "]"}]}]}], 
        "}"}]}], ",", "\[CapitalPhi]0"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dx", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidx"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dy", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidy"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dz", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidz"}]}], "}"}]}], "//", "FullSimplify"}], "//", 
  "CForm"}]], "Input",
 CellLabel->
  "In[161]:=",ExpressionUUID->"59732993-10a7-408f-b7a2-63ae9d8de1e7"],

Cell["\<\
(g0*(-(dphidx*my) + alpha*Ms*(-(dphidz*(Power(mx,2) + Power(my,2))) + \
dphidx*mx*mz) + dphidy*(mx + alpha*Ms*my*mz))*test)/
   ((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.8231521493397017`*^9},
 CellLabel->
  "Out[161]//CForm=",ExpressionUUID->"837849d5-41d2-4622-b1be-b37a716549eb"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["        Kernel for anisotropy", "Section",
 CellChangeTimes->{{3.823151234995804*^9, 3.823151237130513*^9}, 
   3.8231513098935337`*^9, {3.82315264226467*^9, 
   3.823152648684462*^9}},ExpressionUUID->"20d7a4b4-184d-4755-9e53-\
90540003931c"],

Cell[CellGroupData[{

Cell["        Residuals", "Subsection",
 CellChangeTimes->{{3.823152684894875*^9, 
  3.823152690985876*^9}},ExpressionUUID->"cd211fbc-351b-496a-89c0-\
ca785cd0d290"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHSmxANIS", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"RHSmx", ",", "\[CapitalSigma]anis"}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7936837282263727`*^9, 3.793683740025003*^9}, {
   3.793686275553967*^9, 3.793686288706811*^9}, {3.7936896126371593`*^9, 
   3.793689616608951*^9}, 3.805454599443227*^9, {3.8054546616787157`*^9, 
   3.805454701118083*^9}, {3.8066705649573183`*^9, 3.806670586607864*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"3d4abe0b-62c2-417f-a6bc-897ee613e099"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "K1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"mx", " ", "nx"}], "+", 
     RowBox[{"my", " ", "ny"}], "+", 
     RowBox[{"mz", " ", "nz"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "Ms"}], " ", 
      SuperscriptBox["mz", "2"], " ", "nx", " ", "\[Alpha]"}], "+", 
     RowBox[{"my", " ", 
      RowBox[{"(", 
       RowBox[{"nz", "+", 
        RowBox[{"Ms", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "my"}], " ", "nx"}], "+", 
           RowBox[{"mx", " ", "ny"}]}], ")"}], " ", "\[Alpha]"}]}], ")"}]}], 
     "+", 
     RowBox[{"mz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "ny"}], "+", 
        RowBox[{"Ms", " ", "mx", " ", "nz", " ", "\[Alpha]"}]}], ")"}]}]}], 
    ")"}], " ", "\[Gamma]", " ", "\[Psi]h"}], 
  RowBox[{
   SuperscriptBox["Ms", "3"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.7936837302096024`*^9, 3.793683740418088*^9}, 
   3.7936839901231337`*^9, {3.793686276681919*^9, 3.793686289026273*^9}, 
   3.7936882039771757`*^9, 3.793688268151649*^9, 3.793688356956215*^9, {
   3.793689611165124*^9, 3.793689617565627*^9}, {3.805454659571197*^9, 
   3.8054547016613483`*^9}, {3.80667058306112*^9, 3.806670586953286*^9}, 
   3.806738839243154*^9, 3.806739725618174*^9, 3.823152676114403*^9},
 CellLabel->
  "Out[163]=",ExpressionUUID->"b1350e0e-3199-49b2-a841-f386405ff653"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"RHSmx", ",", "\[CapitalSigma]anis"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.793684633672611*^9, 3.7936846347692337`*^9}, {
  3.793685099660344*^9, 3.793685135916422*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"4dc2ce33-c844-4320-9d53-78f637ddf159"],

Cell["\<\
(2*g0*K1*(mx*nx + my*ny + mz*nz)*(-(mz*ny) + my*nz + \
alpha*Ms*(-(Power(my,2)*nx) + mx*my*ny + mz*(-(mz*nx) + mx*nz)))*psi)/
   ((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{
  3.793684635185522*^9, {3.7936851129410143`*^9, 3.7936851366856127`*^9}, 
   3.793688357797451*^9, 3.8066466265980597`*^9, 3.80667060135433*^9, 
   3.806738839439707*^9, 3.806739725772284*^9, 3.823152698738182*^9},
 CellLabel->
  "Out[164]//CForm=",ExpressionUUID->"89f67057-e0e0-4068-908b-f46d1d931091"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHSmyANIS", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"RHSmy", ",", "\[CapitalSigma]anis"}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7936839947085867`*^9, 3.7936839968741617`*^9}, {
   3.793686267673934*^9, 3.793686292180025*^9}, 3.8054547056084213`*^9, {
   3.806670573145239*^9, 3.806670598408065*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"da2fccd4-774d-43d1-8e7d-42f6ca04c3d1"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "K1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"mx", " ", "nx"}], "+", 
      RowBox[{"my", " ", "ny"}], "+", 
      RowBox[{"mz", " ", "nz"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Ms", " ", 
       SuperscriptBox["mz", "2"], " ", "ny", " ", "\[Alpha]"}], "+", 
      RowBox[{"mx", " ", 
       RowBox[{"(", 
        RowBox[{"nz", "+", 
         RowBox[{"Ms", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "my"}], " ", "nx"}], "+", 
            RowBox[{"mx", " ", "ny"}]}], ")"}], " ", "\[Alpha]"}]}], ")"}]}], 
      "-", 
      RowBox[{"mz", " ", 
       RowBox[{"(", 
        RowBox[{"nx", "+", 
         RowBox[{"Ms", " ", "my", " ", "nz", " ", "\[Alpha]"}]}], ")"}]}]}], 
     ")"}], " ", "\[Gamma]", " ", "\[Psi]h"}], 
   RowBox[{
    SuperscriptBox["Ms", "3"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.793683997289197*^9, {3.793686272280545*^9, 3.793686292457985*^9}, {
   3.793688336655774*^9, 3.7936883585543737`*^9}, {3.805454689513319*^9, 
   3.805454706055525*^9}, 3.806670598736536*^9, 3.806738839739691*^9, 
   3.8067397259306393`*^9, 3.823152718594288*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"5b611af6-edef-4406-96e2-820e207ae755"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"RHSmy", ",", "\[CapitalSigma]anis"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.79368464340898*^9, 3.793684644936432*^9}, 
   3.793685142391006*^9},
 CellLabel->
  "In[166]:=",ExpressionUUID->"80484777-95b7-423a-a47d-d9fa714402fb"],

Cell["\<\
(-2*g0*K1*(mx*nx + my*ny + mz*nz)*(-(mz*nx) + mx*nz + alpha*Ms*(-(mx*my*nx) + \
Power(mx,2)*ny + mz*(mz*ny - my*nz)))*psi)/
   ((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.7936846453645144`*^9, 3.793685145202984*^9, 
  3.7936883594126053`*^9, 3.805454707574782*^9, 3.806670969198398*^9, 
  3.806738839754539*^9, 3.8067397260905657`*^9, 3.823152719567428*^9},
 CellLabel->
  "Out[166]//CForm=",ExpressionUUID->"fed9c463-e084-4556-b60f-90d547aa5222"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHSmzANIS", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"RHSmz", ",", "\[CapitalSigma]anis"}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7936840038757153`*^9, 3.793684006226294*^9}, 
   3.805454709610236*^9, 3.8066705778954287`*^9, {3.806670970099453*^9, 
   3.806670971562399*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"d6535aa0-3bd2-41d9-9a32-2323c290e62c"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "K1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"mx", " ", "nx"}], "+", 
      RowBox[{"my", " ", "ny"}], "+", 
      RowBox[{"mz", " ", "nz"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "mx"}], " ", "ny"}], "+", 
      RowBox[{"Ms", " ", 
       SuperscriptBox["my", "2"], " ", "nz", " ", "\[Alpha]"}], "+", 
      RowBox[{"Ms", " ", "mx", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "mz"}], " ", "nx"}], "+", 
         RowBox[{"mx", " ", "nz"}]}], ")"}], " ", "\[Alpha]"}], "+", 
      RowBox[{"my", " ", 
       RowBox[{"(", 
        RowBox[{"nx", "-", 
         RowBox[{"Ms", " ", "mz", " ", "ny", " ", "\[Alpha]"}]}], ")"}]}]}], 
     ")"}], " ", "\[Gamma]", " ", "\[Psi]h"}], 
   RowBox[{
    SuperscriptBox["Ms", "3"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.793684006594008*^9, 3.793688360200121*^9, 3.805454710026421*^9, {
   3.806670968046197*^9, 3.806670971889991*^9}, 3.8067388399614477`*^9, 
   3.806739726332405*^9, 3.82315272043937*^9},
 CellLabel->
  "Out[167]=",ExpressionUUID->"7257df2d-159f-4617-bf9b-589b8c420d64"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"RHSmz", ",", "\[CapitalSigma]anis"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.793684650825317*^9, 3.793684651841311*^9}, 
   3.793685143762727*^9},
 CellLabel->
  "In[168]:=",ExpressionUUID->"efc77100-988a-4d29-a9e1-870be39f9172"],

Cell["\<\
(-2*g0*K1*(mx*nx + my*ny + mz*nz)*(my*(nx - alpha*Ms*mz*ny) + \
alpha*Ms*Power(my,2)*nz + mx*(-(alpha*Ms*mz*nx) - ny + alpha*Ms*mx*nz))*
     psi)/((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.793684652177547*^9, 3.7936851445908327`*^9, 
  3.793688361330283*^9, 3.806670973903376*^9, 3.8067388401735897`*^9, 
  3.8067397264903183`*^9, 3.8231527213792963`*^9},
 CellLabel->
  "Out[168]//CForm=",ExpressionUUID->"3f2c061a-4ec0-491d-9ad5-268370540a4f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        On-diagonal jacobian entries:", "Subsection",
 CellChangeTimes->{{3.8231527304690437`*^9, 
  3.8231527655988493`*^9}},ExpressionUUID->"a7edf84f-cb69-42b0-baa0-\
4bb19a2d8660"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxANIS", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[169]:=",ExpressionUUID->"1c4043d6-6bec-4b21-98a3-2c707dce71b2"],

Cell["\<\
(2*g0*K1*(-(mz*nx*ny) + my*nx*nz + alpha*Ms*(Power(my,2)*(-Power(nx,2) + \
Power(ny,2)) + 2*my*ny*(mx*nx + mz*nz) + 
          mz*(-(mz*Power(nx,2)) + 2*mx*nx*nz + mz*Power(nz,2))))*phi*psi)/((1 \
+ Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.8231527457955008`*^9},
 CellLabel->
  "Out[169]//CForm=",ExpressionUUID->"e21af621-c416-4801-95c1-b0a4a7ee47bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyANIS", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[170]:=",ExpressionUUID->"16490150-e32e-4caa-afd9-fb531933eaf6"],

Cell["\<\
(2*g0*K1*(ny*(mz*nx - mx*nz) + alpha*Ms*(Power(mx,2)*(nx - ny)*(nx + ny) + \
2*mx*nx*(my*ny + mz*nz) + 
          mz*(-(mz*Power(ny,2)) + 2*my*ny*nz + mz*Power(nz,2))))*phi*psi)/((1 \
+ Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.82315274905449*^9},
 CellLabel->
  "Out[170]//CForm=",ExpressionUUID->"7e2bbf59-c1a0-4f01-8d5b-db7f433cb920"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzANIS", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[171]:=",ExpressionUUID->"fa1acfb3-c08d-4e6f-8c97-c34b80385126"],

Cell["\<\
(2*g0*K1*(-(my*nx*nz) + mx*ny*nz + alpha*Ms*(Power(mx*nx + my*ny,2) + \
2*mz*(mx*nx + my*ny)*nz - 
          (Power(mx,2) + Power(my,2))*Power(nz,2)))*phi*psi)/((1 + \
Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.823152752095683*^9},
 CellLabel->
  "Out[171]//CForm=",ExpressionUUID->"a8dde704-0677-4a18-a302-9ad54c201124"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        Off-diagonal jacobian entries:", "Subsection",
 CellChangeTimes->{{3.823152768268887*^9, 
  3.823152776226118*^9}},ExpressionUUID->"cf5f258c-db07-4f24-91f6-\
e7340f7f17bd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxANIS", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[172]:=",ExpressionUUID->"4da72b83-b70b-400f-8c72-03863e37d17b"],

Cell["\<\
(2*g0*K1*(-(mz*Power(ny,2)) + mx*nx*nz + 2*my*ny*nz + mz*Power(nz,2) + 
       alpha*Ms*(Power(mx,2)*nx*ny - nx*(3*Power(my,2)*ny + Power(mz,2)*ny + \
2*my*mz*nz) + 
          2*mx*(-(my*Power(nx,2)) + my*Power(ny,2) + mz*ny*nz)))*phi*psi)/((1 \
+ Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.823152818548811*^9},
 CellLabel->
  "Out[172]//CForm=",ExpressionUUID->"14b30260-97ea-46f9-9fa8-2f5d71c27090"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxANIS", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[173]:=",ExpressionUUID->"f31c41cb-cd5f-421a-81f9-19aaae87ef6a"],

Cell["\<\
(2*g0*K1*(-((2*alpha*Ms*mz*nx + ny)*(mx*nx + my*ny)) - 2*mz*ny*nz + 
       alpha*Ms*(Power(mx,2)*nx - (Power(my,2) + 3*Power(mz,2))*nx + \
2*mx*my*ny)*nz + (my + 2*alpha*Ms*mx*mz)*Power(nz,2))*phi*psi)/
   ((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.8231528196250563`*^9},
 CellLabel->
  "Out[173]//CForm=",ExpressionUUID->"75f13465-c166-4636-ac9b-c963dbe0d85c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyANIS", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[174]:=",ExpressionUUID->"59dfb573-81ba-4e50-87b7-fb84f134d6df"],

Cell["\<\
(-2*g0*K1*(-(mz*Power(nx,2)) + 2*mx*nx*nz + my*ny*nz + mz*Power(nz,2) + 
       alpha*Ms*(3*Power(mx,2)*nx*ny + nx*(-(Power(my,2)*ny) + Power(mz,2)*ny \
- 2*my*mz*nz) + 
          2*mx*(-(my*Power(nx,2)) + my*Power(ny,2) + mz*ny*nz)))*phi*psi)/((1 \
+ Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.82315282093994*^9},
 CellLabel->
  "Out[174]//CForm=",ExpressionUUID->"5f4e8ffe-9423-411b-b1d1-e1a031c95541"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyANIS", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[175]:=",ExpressionUUID->"5db78344-106e-406c-9345-fe7172a62cad"],

Cell["\<\
(2*g0*K1*((mx*nx + my*ny)*(nx - 2*alpha*Ms*mz*ny) + 2*(alpha*Ms*mx*my + \
mz)*nx*nz + 
       alpha*Ms*(-Power(mx,2) + Power(my,2) - 3*Power(mz,2))*ny*nz - (mx - \
2*alpha*Ms*my*mz)*Power(nz,2))*phi*psi)/
   ((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.823152822067833*^9},
 CellLabel->
  "Out[175]//CForm=",ExpressionUUID->"904cc4c3-9ea0-4182-91fd-5089907ce223"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzANIS", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[176]:=",ExpressionUUID->"67e6d9bd-91c1-4060-bb00-a6cc113adff2"],

Cell["\<\
(2*g0*K1*(-(alpha*Ms*Power(my,2)*nx*nz) + ny*(2*mx*nx + mz*nz) + 
       alpha*Ms*(-3*Power(mx,2)*nx*nz + Power(mz,2)*nx*nz + 2*mx*mz*(nx - \
nz)*(nx + nz)) + 
       my*(-Power(nx,2) + 2*alpha*Ms*mz*nx*ny + ny*(ny - \
2*alpha*Ms*mx*nz)))*phi*psi)/((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.82315282306927*^9},
 CellLabel->
  "Out[176]//CForm=",ExpressionUUID->"a67c4e24-cb5b-48f3-b923-2f71a45651de"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzANIS", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[177]:=",ExpressionUUID->"b25ed57b-4d62-4949-8c67-89a3dbbf4956"],

Cell["\<\
(-2*g0*K1*(alpha*Ms*Power(mx,2)*ny*nz + 3*alpha*Ms*Power(my,2)*ny*nz + mz*(nx \
- alpha*Ms*mz*ny)*nz + 
       mx*(Power(nx,2) - Power(ny,2) + 2*alpha*Ms*nx*(-(mz*ny) + my*nz)) + \
2*my*(nx*ny + alpha*Ms*mz*(-Power(ny,2) + Power(nz,2))))*phi*
     psi)/((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.823152824644224*^9},
 CellLabel->
  "Out[177]//CForm=",ExpressionUUID->"18d31623-a116-47fa-a00a-e20438305dc0"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "        Kernel for LLB ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Alpha]", "LL"], "(", 
      RowBox[{
       StyleBox["m",
        FontWeight->"Bold"], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["H",
        FontWeight->"Bold"]}], ")"}], " ", "=", " ", 
     RowBox[{
      SubscriptBox["\[Alpha]", "LL"], " ", 
      FractionBox[
       RowBox[{"\[Gamma]", " "}], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[Alpha]", "2"]}], ")"}]], " ", 
      RowBox[{
       SuperscriptBox["m", "2"], "(", 
       RowBox[{
        SuperscriptBox["m", "2"], "-", "1"}], ")"}], 
      StyleBox["m",
       FontWeight->"Bold"]}]}], "]"}], TraditionalForm]],ExpressionUUID->
  "f569cfd9-7942-4884-a5de-3eac4480b35a"]
}], "Section",
 CellChangeTimes->{{3.823151241835174*^9, 3.823151243354587*^9}, 
   3.823151310481769*^9, {3.823152178201023*^9, 3.823152197225645*^9}, {
   3.823152310638907*^9, 
   3.823152355702224*^9}},ExpressionUUID->"663533f7-cd90-4ac3-abb4-\
07c6984ab1ca"],

Cell[CellGroupData[{

Cell["        Residuals:", "Subsection",
 CellChangeTimes->{{3.823152297829833*^9, 
  3.8231523027622766`*^9}},ExpressionUUID->"fcfaabf0-3cb1-4b23-8012-\
7b126e55e0bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]0", " ", 
    FractionBox[
     RowBox[{"\[Alpha]ll", " "}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "*", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["mx", "2"], "+", 
      SuperscriptBox["my", "2"], "+", 
      SuperscriptBox["mz", "2"]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["mx", "2"], "+", 
      SuperscriptBox["my", "2"], "+", 
      SuperscriptBox["mz", "2"], "-", "1"}], ")"}], 
    RowBox[{"{", 
     RowBox[{"mx", ",", "my", ",", "mz"}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]ll", "\[Rule]", "alphaLL"}], ",", 
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]0", "\[Rule]", "g0"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellLabel->
  "In[162]:=",ExpressionUUID->"2dba5e94-21f3-4fe6-b07e-6ff6affab9fa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"alphaLL", " ", "g0", " ", "mx", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["mx", "2"], "+", 
       SuperscriptBox["my", "2"], "+", 
       SuperscriptBox["mz", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["mx", "2"], "+", 
       SuperscriptBox["my", "2"], "+", 
       SuperscriptBox["mz", "2"]}], ")"}]}], 
    RowBox[{"1", "+", 
     SuperscriptBox["alpha", "2"]}]], ",", 
   FractionBox[
    RowBox[{"alphaLL", " ", "g0", " ", "my", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["mx", "2"], "+", 
       SuperscriptBox["my", "2"], "+", 
       SuperscriptBox["mz", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["mx", "2"], "+", 
       SuperscriptBox["my", "2"], "+", 
       SuperscriptBox["mz", "2"]}], ")"}]}], 
    RowBox[{"1", "+", 
     SuperscriptBox["alpha", "2"]}]], ",", 
   FractionBox[
    RowBox[{"alphaLL", " ", "g0", " ", "mz", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["mx", "2"], "+", 
       SuperscriptBox["my", "2"], "+", 
       SuperscriptBox["mz", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["mx", "2"], "+", 
       SuperscriptBox["my", "2"], "+", 
       SuperscriptBox["mz", "2"]}], ")"}]}], 
    RowBox[{"1", "+", 
     SuperscriptBox["alpha", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.8231523057320747`*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"3031d4aa-9c72-4f4d-ade6-eca7787fbf08"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        On-diagonal jacobian entries:", "Subsection",
 CellChangeTimes->{{3.8231523930363503`*^9, 
  3.823152413827661*^9}},ExpressionUUID->"0cf55a52-f41e-4a3b-a912-\
3b57e376b561"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Gamma]0", " ", 
           FractionBox[
            RowBox[{"\[Alpha]ll", " "}], 
            RowBox[{"1", "+", 
             SuperscriptBox["\[Alpha]", "2"]}]], "*", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mx", "2"], "+", 
             SuperscriptBox["my", "2"], "+", 
             SuperscriptBox["mz", "2"]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mx", "2"], "+", 
             SuperscriptBox["my", "2"], "+", 
             SuperscriptBox["mz", "2"], "-", "1"}], ")"}], 
           RowBox[{"{", 
            RowBox[{"mx", ",", "my", ",", "mz"}], "}"}]}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/.", "algFEM1"}], ",", "m0x"}], 
      "]"}], "/.", "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]ll", "\[Rule]", "alphaLL"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]0", "\[Rule]", "g0"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.7927386125227213`*^9, 3.792738667324563*^9}, 
   3.792738702415381*^9, 
   3.792741241620014*^9},ExpressionUUID->"d829af12-81ad-40e6-9ce5-\
d90035b5baae"],

Cell["\<\
(alphaLL*g0*(5*Power(mx,4) + (-1 + Power(my,2) + Power(mz,2))*(Power(my,2) + \
Power(mz,2)) + Power(mx,2)*(-3 + 6*Power(my,2) + 6*Power(mz,2)))*phi)/(1 + \
Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{{3.7927386349284983`*^9, 3.7927387029582853`*^9}, 
   3.792741242271716*^9, 3.793683632736528*^9, 3.80673883709032*^9, 
   3.8067397242874804`*^9, 
   3.806742180507421*^9},ExpressionUUID->"4085d93e-e97c-49dd-8299-\
a9afff28681d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Gamma]0", " ", 
           FractionBox[
            RowBox[{"\[Alpha]ll", " "}], 
            RowBox[{"1", "+", 
             SuperscriptBox["\[Alpha]", "2"]}]], "*", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mx", "2"], "+", 
             SuperscriptBox["my", "2"], "+", 
             SuperscriptBox["mz", "2"]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mx", "2"], "+", 
             SuperscriptBox["my", "2"], "+", 
             SuperscriptBox["mz", "2"], "-", "1"}], ")"}], 
           RowBox[{"{", 
            RowBox[{"mx", ",", "my", ",", "mz"}], "}"}]}], ")"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/.", "algFEM1"}], ",", "m0y"}], 
      "]"}], "/.", "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]ll", "\[Rule]", "alphaLL"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]0", "\[Rule]", "g0"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.7927386762516937`*^9, 3.7927387010531483`*^9}, 
   3.792741240404998*^9},ExpressionUUID->"90de07be-d2e4-4c42-b6d7-\
aca865e0ead2"],

Cell["\<\
(alphaLL*g0*(Power(mx,4) + 5*Power(my,4) - Power(mz,2) + Power(mz,4) + \
Power(mx,2)*(-1 + 6*Power(my,2) + 2*Power(mz,2)) + Power(my,2)*(-3 + \
6*Power(mz,2)))*phi)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{{3.792738679207881*^9, 3.79273870141928*^9}, 
   3.7927412409945517`*^9, 3.793683633820573*^9, 3.806738837308495*^9, 
   3.8067397244176292`*^9, 
   3.806742180897624*^9},ExpressionUUID->"8a317554-90eb-4ac4-bf34-\
3b65e14b5d22"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Gamma]0", " ", 
           FractionBox[
            RowBox[{"\[Alpha]ll", " "}], 
            RowBox[{"1", "+", 
             SuperscriptBox["\[Alpha]", "2"]}]], "*", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mx", "2"], "+", 
             SuperscriptBox["my", "2"], "+", 
             SuperscriptBox["mz", "2"]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mx", "2"], "+", 
             SuperscriptBox["my", "2"], "+", 
             SuperscriptBox["mz", "2"], "-", "1"}], ")"}], 
           RowBox[{"{", 
            RowBox[{"mx", ",", "my", ",", "mz"}], "}"}]}], ")"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/.", "algFEM1"}], ",", "m0z"}], 
      "]"}], "/.", "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]ll", "\[Rule]", "alphaLL"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]0", "\[Rule]", "g0"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.792738682540381*^9, 3.792738699115341*^9}, 
   3.7927412390449343`*^9},ExpressionUUID->"ee8d5562-8c5a-4001-a560-\
b165fcad7b90"],

Cell["\<\
(alphaLL*g0*(Power(mx,4) + Power(my,4) - 3*Power(mz,2) + 5*Power(mz,4) + \
Power(my,2)*(-1 + 6*Power(mz,2)) + Power(mx,2)*(-1 + 2*Power(my,2) + \
6*Power(mz,2)))*phi)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{{3.792738684587799*^9, 3.7927386995579967`*^9}, 
   3.7927412396799173`*^9, 3.793683634618815*^9, 3.806738837749178*^9, 
   3.806739724546715*^9, 
   3.806742181265965*^9},ExpressionUUID->"37f4a706-1f6b-44f1-bbc3-\
4caf99adfecd"]
}, Open  ]]
}, Closed]],

Cell["        Off-diagonal jacobian entries:", "Subsection",
 CellChangeTimes->{{3.823152407908724*^9, 
  3.823152417471059*^9}},ExpressionUUID->"cc749f2d-2d4d-47b0-95d9-\
7902fdb83b40"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other (scratch)", "Chapter",
 CellChangeTimes->{{3.823169189616075*^9, 3.823169190191506*^9}, {
  3.8231723322200108`*^9, 
  3.8231723337720623`*^9}},ExpressionUUID->"57fe9b2c-f2e9-4b89-ad1a-\
6412a8f822db"],

Cell[CellGroupData[{

Cell["film", "Section",
 CellChangeTimes->{{3.8231723419956007`*^9, 
  3.823172343411159*^9}},ExpressionUUID->"dc59816c-8373-43c5-8e2b-\
deb0ea4b1a41"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"C11", "=", "175.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"C12", "=", "79.4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"C44", "=", "111.1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"e11", "=", "0.025"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"e22", "=", "0.025"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s00", "=", 
   RowBox[{"C11", "*", "e11"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"s11", "=", 
   RowBox[{"C11", "*", "e22"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"s22", "=", 
   RowBox[{
    RowBox[{"C12", "*", "e11"}], "+", 
    RowBox[{"C12", "*", "e22"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.823169203966625*^9, 3.823169203967847*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"4d8b45d8-a08c-4768-8bac-bbbbd06f9aaf"],

Cell[CellGroupData[{

Cell[BoxData["s00"], "Input",
 CellChangeTimes->{{3.823169209168129*^9, 3.823169209407609*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"f05c1242-7293-4893-a1fa-a93b32b7d0d0"],

Cell[BoxData["4.375`"], "Output",
 CellChangeTimes->{3.823169209744378*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"717cb67b-9ead-44bd-b589-b4ec56a97ca1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"func", "[", 
  RowBox[{
   RowBox[{"5", "/", "10"}], ",", 
   FractionBox["\"\<Volts\>\"", "\"\<Nanometers\>\""], ",", 
   FractionBox["\"\<Megavolts\>\"", "\"\<Centimeters\>\""]}], "]"}]], "Input",\

 CellChangeTimes->{{3.823170132902706*^9, 3.823170186861773*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"6c189421-8b5a-42d0-8a39-5039ab3d3326"],

Cell[BoxData[
 TemplateBox[{"5", 
   RowBox[{
    "\"MV\"", "\[InvisibleSpace]", "\"/\"", "\[InvisibleSpace]", "\"cm\""}], 
   "megavolts per centimeter", 
   FractionBox["\"Megavolts\"", "\"Centimeters\""]},
  "Quantity"]], "Output",
 CellChangeTimes->{{3.8231701614524508`*^9, 3.823170187283621*^9}},
 CellLabel->"Out[13]=",ExpressionUUID->"f92d6b43-2fa6-46ac-8032-a4ddd5cc0b65"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1213, 969},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"12.2 for Linux x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"523752da-37bc-43ae-87cb-378d18ccc5df"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 212, 4, 98, "Title",ExpressionUUID->"ebc18a75-c4e1-49dd-838b-d0c8ff912763"],
Cell[CellGroupData[{
Cell[817, 30, 221, 4, 69, "Chapter",ExpressionUUID->"5441bba2-423a-4c0d-9ffc-e5edeeb48100"],
Cell[CellGroupData[{
Cell[1063, 38, 172, 3, 67, "Section",ExpressionUUID->"12bd110e-b09a-44f8-841e-9c5d197e841e"],
Cell[1238, 43, 372, 9, 30, "Input",ExpressionUUID->"6d9b666e-5dbb-46fd-94e7-33aef6aafa8a"],
Cell[1613, 54, 153, 3, 35, "Text",ExpressionUUID->"ca3e17df-ac3b-40d1-aa84-f547bd858c35"],
Cell[1769, 59, 435, 10, 75, "Input",ExpressionUUID->"605aba92-17ae-4205-91d8-9a7659e9a384"],
Cell[CellGroupData[{
Cell[2229, 73, 574, 16, 54, "Input",ExpressionUUID->"1892d17d-27b2-4b8b-94dc-87869d71f4fa"],
Cell[2806, 91, 534, 12, 42, "Output",ExpressionUUID->"77e9a8ef-d9a0-4014-ac75-8d5c8a14140a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[3389, 109, 237, 4, 53, "Section",ExpressionUUID->"db5ce5f6-8789-4b65-95a7-18a927eaeca8"],
Cell[3629, 115, 2278, 64, 119, "Input",ExpressionUUID->"1ca755ac-49aa-43df-b917-d8a909ba1ddf"],
Cell[5910, 181, 16350, 440, 823, "Input",ExpressionUUID->"c5ff5347-cd13-4494-820b-16853e833e42"],
Cell[22263, 623, 9234, 247, 427, "Input",ExpressionUUID->"41463e50-7284-440c-8cc6-a950be1e6611"],
Cell[31500, 872, 2338, 48, 171, "Input",ExpressionUUID->"3f3ef607-eab7-49df-be8a-c4b276db9b8a"]
}, Closed]],
Cell[CellGroupData[{
Cell[33875, 925, 171, 3, 53, "Section",ExpressionUUID->"2e54c9af-338a-4b60-a60b-94baa3d3602f"],
Cell[34049, 930, 13914, 411, 653, "Input",ExpressionUUID->"ee610166-5c22-4f17-8c56-1c170d3f5627"],
Cell[47966, 1343, 2901, 85, 204, "Input",ExpressionUUID->"96b479c7-9851-4b81-a4b7-5213ad725f43"]
}, Closed]],
Cell[CellGroupData[{
Cell[50904, 1433, 168, 3, 53, "Section",ExpressionUUID->"0cab8b2a-af49-48c4-9bb9-ad7d3853943c"],
Cell[51075, 1438, 2817, 75, 204, "Input",ExpressionUUID->"5c2c7011-a069-438e-8163-5636797022fe"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53941, 1519, 238, 4, 69, "Chapter",ExpressionUUID->"7a035d01-4419-4dfa-8464-9f36e563fa83"],
Cell[CellGroupData[{
Cell[54204, 1527, 174, 3, 67, "Section",ExpressionUUID->"28cfd32f-5d2f-4679-ba3f-71ab50c7c33c"],
Cell[CellGroupData[{
Cell[54403, 1534, 503, 16, 54, "Subsection",ExpressionUUID->"e63d1d95-158a-406e-bb47-4d3dd76d7507"],
Cell[54909, 1552, 599, 17, 119, "Input",ExpressionUUID->"9d78ea87-567c-4f7f-92de-f0bbef9ef26a"],
Cell[CellGroupData[{
Cell[55533, 1573, 22861, 539, 2970, "Input",ExpressionUUID->"df2db43e-de59-4b2e-8507-d61dc375a349"],
Cell[78397, 2114, 928, 12, 607, "Output",ExpressionUUID->"1e16d244-119b-411f-acf6-26c1af7ce245"]
}, Open  ]]
}, Closed]],
Cell[79352, 2130, 499, 16, 38, "Subsection",ExpressionUUID->"72e10825-d014-413f-a842-21d38a5da6ad"],
Cell[79854, 2148, 534, 16, 38, "Subsection",ExpressionUUID->"3235dd6f-e7ea-4ea8-8b26-8d6dc36b42b9"]
}, Open  ]],
Cell[80403, 2167, 1024, 35, 75, "Section",ExpressionUUID->"5da2ae0b-5d70-4c56-9cc9-e071bf0a896b"],
Cell[81430, 2204, 1204, 37, 57, "Section",ExpressionUUID->"0318d1e5-1e36-41ba-8187-e92dbe09de49"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82671, 2246, 183, 3, 69, "Chapter",ExpressionUUID->"758459e7-ef4f-49dc-882e-bb6956ca3e88"],
Cell[CellGroupData[{
Cell[82879, 2253, 174, 3, 67, "Section",ExpressionUUID->"80812cd6-b1bb-449f-886b-21fc76e7e084"],
Cell[CellGroupData[{
Cell[83078, 2260, 170, 3, 54, "Subsection",ExpressionUUID->"1bcf7195-f09f-4887-bfbb-b621f6b5a139"],
Cell[83251, 2265, 448, 12, 97, "Input",ExpressionUUID->"293d8cfc-eb2a-48ab-bf96-252eb9b9f6a5"],
Cell[83702, 2279, 2534, 73, 324, "Input",ExpressionUUID->"eaa32d20-00aa-49a9-b23a-9848f6dff607"],
Cell[86239, 2354, 1099, 25, 141, "Input",ExpressionUUID->"0072e5dc-e422-4590-81fb-279ce4ab917f"],
Cell[CellGroupData[{
Cell[87363, 2383, 285, 6, 30, "Input",ExpressionUUID->"14cb2a2c-4afd-4553-b69e-8b150e9b939c"],
Cell[87651, 2391, 1739, 38, 44, "Output",ExpressionUUID->"68e97e53-2187-48da-8878-3b6a7dfba0bf"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[89451, 2436, 1151, 39, 71, "Section",ExpressionUUID->"71df5d96-f5a9-4ffe-9519-46d556f98fe6"],
Cell[CellGroupData[{
Cell[90627, 2479, 757, 25, 61, "Subsection",ExpressionUUID->"f29e61f8-efa7-4034-8c60-0dfcb50811e8"],
Cell[91387, 2506, 1573, 28, 47, "Input",ExpressionUUID->"3f090a8b-d3a9-43c5-bd63-48b9f79b95dd"]
}, Closed]],
Cell[CellGroupData[{
Cell[92997, 2539, 611, 19, 38, "Subsection",ExpressionUUID->"0b862b60-4ea9-4549-aba8-2e8a1f253fa3"],
Cell[93611, 2560, 1365, 24, 30, "Input",ExpressionUUID->"edb61ec0-adcb-4fc1-a042-daf0dcd0c26e"]
}, Closed]],
Cell[CellGroupData[{
Cell[95013, 2589, 929, 30, 47, "Subsection",ExpressionUUID->"e1e712fa-5e27-4002-a746-cd3cb4e4b2ec"],
Cell[95945, 2621, 1619, 50, 49, "Input",ExpressionUUID->"71c6f74c-c9c3-4bdc-bbbe-9bda21a966b0"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[97613, 2677, 1952, 64, 83, "Section",ExpressionUUID->"561ed868-d16a-4d18-90b8-e77a1b0b776b"],
Cell[99568, 2743, 1359, 40, 56, "Input",ExpressionUUID->"4aa8480d-077c-4767-9edf-99b149a12936"],
Cell[100930, 2785, 1081, 32, 75, "Input",ExpressionUUID->"98b89b1a-5b50-439c-afd9-3dbe3b7c1ce0"],
Cell[102014, 2819, 311, 7, 35, "Text",ExpressionUUID->"1d7de1d0-64a7-4719-9696-82d1e6f8f268"]
}, Closed]],
Cell[CellGroupData[{
Cell[102362, 2831, 180, 3, 53, "Section",ExpressionUUID->"2396f8a0-dd60-420e-8cce-072d7c0547aa"],
Cell[CellGroupData[{
Cell[102567, 2838, 1590, 42, 185, "Input",ExpressionUUID->"ee17ac49-a45f-4c6a-8f4d-d3cace439586"],
Cell[104160, 2882, 3103, 74, 216, "Output",ExpressionUUID->"884f9faf-a682-49a8-9936-cdd13d17a58c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107300, 2961, 1618, 43, 185, "Input",ExpressionUUID->"ce39e57f-e0a8-4873-a360-41e0d1b16eb3"],
Cell[108921, 3006, 3152, 76, 216, "Output",ExpressionUUID->"024ad78a-23b0-409a-8e32-b6743b523445"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112110, 3087, 1544, 41, 185, "Input",ExpressionUUID->"81edb96c-ba96-4bcf-bc8c-0e3a0e38c00d"],
Cell[113657, 3130, 2984, 69, 216, "Output",ExpressionUUID->"1856c70f-8637-44b0-b4ce-d728d2af5310"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[116690, 3205, 172, 3, 53, "Section",ExpressionUUID->"2f02d2bd-0e0e-4eb3-87f0-04e73133a678"],
Cell[CellGroupData[{
Cell[116887, 3212, 166, 3, 54, "Subsection",ExpressionUUID->"2dcb3fed-ca30-4079-8597-fe5e0ff5479d"],
Cell[CellGroupData[{
Cell[117078, 3219, 1156, 22, 30, "Input",ExpressionUUID->"79fd22c5-0677-46b9-9dfc-fe242b778343"],
Cell[118237, 3243, 2047, 33, 174, "Output",ExpressionUUID->"c6a74596-d201-49f5-9d03-033649021e74"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120321, 3281, 1050, 21, 30, "Input",ExpressionUUID->"9445b612-1932-49cd-a2dc-1844aebe34ea"],
Cell[121374, 3304, 1862, 31, 174, "Output",ExpressionUUID->"885e7f6c-1296-4c85-b889-121661bd58eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123273, 3340, 1057, 21, 30, "Input",ExpressionUUID->"edf23143-6597-46bb-8eda-cab6c7ac2639"],
Cell[124333, 3363, 1880, 32, 174, "Output",ExpressionUUID->"082f1f32-0d65-4725-ba1b-1c13a3b7fb96"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[126262, 3401, 237, 4, 38, "Subsection",ExpressionUUID->"abb39c8d-b5de-4d28-8cca-f5a4ceb6d036"],
Cell[CellGroupData[{
Cell[126524, 3409, 1141, 25, 53, "Input",ExpressionUUID->"8fb1568d-3add-4f45-a525-1c922a2bf45e"],
Cell[127668, 3436, 1687, 27, 120, "Output",ExpressionUUID->"0f6a3fdf-b259-449b-9bf2-d998be5d1da8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129392, 3468, 1076, 24, 53, "Input",ExpressionUUID->"3daebc25-f3b2-4fdf-8b4a-f8620b9632ca"],
Cell[130471, 3494, 750, 14, 120, "Output",ExpressionUUID->"bd0c98e0-83d8-4a33-b1dd-b31bed70e9c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131258, 3513, 704, 19, 53, "Input",ExpressionUUID->"d114960d-0fc1-442f-8e42-9975784493c8"],
Cell[131965, 3534, 749, 14, 120, "Output",ExpressionUUID->"66b37e94-8538-4f4c-8da8-84c603aa4edc"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[132763, 3554, 185, 3, 38, "Subsection",ExpressionUUID->"9c9c765a-c221-4236-9c32-b690e2a42e24"],
Cell[CellGroupData[{
Cell[132973, 3561, 704, 19, 53, "Input",ExpressionUUID->"744086df-8cb8-4036-bbbe-92dea9a44f85"],
Cell[133680, 3582, 764, 14, 120, "Output",ExpressionUUID->"4ebc0444-c9fa-446a-b256-a99e3262e87d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134481, 3601, 704, 19, 53, "Input",ExpressionUUID->"e2458c0d-2418-4656-a3d0-6dd0e5a02da5"],
Cell[135188, 3622, 843, 15, 138, "Output",ExpressionUUID->"88941e37-0600-4503-b192-0d6f76f69476"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136068, 3642, 704, 19, 53, "Input",ExpressionUUID->"ca3c4e90-55b5-412a-ba6c-c8c1bb821186"],
Cell[136775, 3663, 765, 14, 120, "Output",ExpressionUUID->"2e52c13e-0bb0-4127-b2c0-9b534a85a1c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137577, 3682, 704, 19, 53, "Input",ExpressionUUID->"2f885001-4c92-4b18-96b5-ac6c7d6913e7"],
Cell[138284, 3703, 848, 16, 138, "Output",ExpressionUUID->"8e8a3b50-54c1-4468-8813-8da1f2ca5a37"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139169, 3724, 704, 19, 53, "Input",ExpressionUUID->"4c404825-052f-4a77-b71d-29e1e43b3840"],
Cell[139876, 3745, 858, 16, 138, "Output",ExpressionUUID->"f430233d-6b26-4ba9-9f6f-ef3c642ef6ea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140771, 3766, 704, 19, 53, "Input",ExpressionUUID->"2901b736-69f9-4f0c-934c-823e47423150"],
Cell[141478, 3787, 853, 15, 138, "Output",ExpressionUUID->"56b656a2-79d6-4b65-9ef8-bd0e7f4cb418"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[142392, 3809, 175, 3, 67, "Section",ExpressionUUID->"047aa2f6-b27c-4f3e-b5b0-37bb43990839"],
Cell[CellGroupData[{
Cell[142592, 3816, 169, 3, 54, "Subsection",ExpressionUUID->"c33de142-c5fe-4952-85c9-acc18d1efc0c"],
Cell[CellGroupData[{
Cell[142786, 3823, 385, 9, 30, "Input",ExpressionUUID->"194e88a0-6c82-4e75-8688-c8e7ec9ae10a"],
Cell[143174, 3834, 2042, 50, 60, "Output",ExpressionUUID->"047e7cc0-7a84-4b5c-b872-e0cfb4e93fe0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145253, 3889, 585, 14, 30, "Input",ExpressionUUID->"d1d9d50f-cc42-4e5a-9223-21a3ceb6388e"],
Cell[145841, 3905, 330, 7, 66, "Output",ExpressionUUID->"d4e36dd5-f178-4a14-b8fb-88322731aff2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146208, 3917, 212, 5, 30, "Input",ExpressionUUID->"fef6e744-d8ee-4796-95fa-5f4a2415a3e9"],
Cell[146423, 3924, 1465, 42, 59, "Output",ExpressionUUID->"44078560-d20a-4a05-9779-8e2bcadf291f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147925, 3971, 585, 14, 30, "Input",ExpressionUUID->"1b4cd2d3-9915-4293-8527-dd7e4addac93"],
Cell[148513, 3987, 332, 7, 66, "Output",ExpressionUUID->"8ac9fe2d-ff1a-4488-82ff-f548709e8075"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148882, 3999, 212, 5, 30, "Input",ExpressionUUID->"49aa4302-5dac-4ad3-8d44-d64c3ad0c7e4"],
Cell[149097, 4006, 1440, 41, 59, "Output",ExpressionUUID->"17d33e19-a22d-48f3-9673-aa87726ea5fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150574, 4052, 585, 14, 30, "Input",ExpressionUUID->"f1755b89-03dd-4ba0-b81e-50bdfda97df2"],
Cell[151162, 4068, 311, 7, 66, "Output",ExpressionUUID->"88a34cc3-9ee9-4722-addb-6fabc0277098"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[151522, 4081, 186, 3, 38, "Subsection",ExpressionUUID->"c1c54794-7876-4f07-86a4-c16a3b25c713"],
Cell[CellGroupData[{
Cell[151733, 4088, 718, 19, 53, "Input",ExpressionUUID->"6643024b-06ee-4b94-9e3c-a506dbe602e2"],
Cell[152454, 4109, 222, 5, 48, "Output",ExpressionUUID->"7f2710fa-eba4-4084-b1b5-df9e8bd0e075"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152713, 4119, 718, 19, 53, "Input",ExpressionUUID->"27d9e5f9-0efd-4419-bc7b-ccf5decee5b3"],
Cell[153434, 4140, 222, 5, 48, "Output",ExpressionUUID->"ec6820f6-f322-4f22-896f-860335cededc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153693, 4150, 718, 19, 53, "Input",ExpressionUUID->"b8f30609-920e-483c-881a-6a5ee0816950"],
Cell[154414, 4171, 222, 5, 48, "Output",ExpressionUUID->"9b0e21a2-ee64-49b8-9458-9e7284fb648b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[154685, 4182, 186, 3, 38, "Subsection",ExpressionUUID->"c15ae1f0-d8d7-4437-8ff6-4861cddc5991"],
Cell[CellGroupData[{
Cell[154896, 4189, 718, 19, 53, "Input",ExpressionUUID->"2fee91e9-9fb7-4b56-81ac-e599d3bdddc0"],
Cell[155617, 4210, 244, 6, 48, "Output",ExpressionUUID->"27f0722a-5f93-4306-a3a6-23a817669a05"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155898, 4221, 718, 19, 53, "Input",ExpressionUUID->"85eed928-eb68-4283-8ee5-fdb84daba9c5"],
Cell[156619, 4242, 245, 6, 48, "Output",ExpressionUUID->"bb1fab76-80fd-438a-a454-90e4bc20e59f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156901, 4253, 1666, 41, 75, "Input",ExpressionUUID->"c5310808-7a86-4aca-86f1-2dc8b03a5a71"],
Cell[158570, 4296, 310, 7, 66, "Output",ExpressionUUID->"7dbe93dc-2281-4ddd-b8be-e01c189814c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158917, 4308, 718, 19, 53, "Input",ExpressionUUID->"54478118-094d-4150-a7a0-fd0ba26d26ee"],
Cell[159638, 4329, 250, 6, 48, "Output",ExpressionUUID->"8b8d4dc8-63bf-43f8-bced-b53644c87b8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159925, 4340, 718, 19, 53, "Input",ExpressionUUID->"f21aa3ee-56b4-4544-8332-e60833e1073f"],
Cell[160646, 4361, 247, 6, 48, "Output",ExpressionUUID->"9e7bad4d-e012-46e0-9d48-48d4d8776594"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160930, 4372, 1666, 41, 75, "Input",ExpressionUUID->"fe961710-f123-46dd-a4a7-2b32ecb51a64"],
Cell[162599, 4415, 308, 7, 66, "Output",ExpressionUUID->"f08596f2-0be0-4098-9fd9-03fb2f5ab5f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162944, 4427, 718, 19, 53, "Input",ExpressionUUID->"026b227b-06d5-4b86-b817-fbe30d84c9a3"],
Cell[163665, 4448, 246, 6, 48, "Output",ExpressionUUID->"8fc9139b-4fa1-4342-a364-52951259d3b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163948, 4459, 718, 19, 53, "Input",ExpressionUUID->"75072a16-1b23-449c-80bf-180ba8bf557b"],
Cell[164669, 4480, 248, 6, 48, "Output",ExpressionUUID->"6047f7a9-8fb2-487b-8309-47b85abe798a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164954, 4491, 1666, 41, 75, "Input",ExpressionUUID->"59732993-10a7-408f-b7a2-63ae9d8de1e7"],
Cell[166623, 4534, 313, 7, 66, "Output",ExpressionUUID->"837849d5-41d2-4622-b1be-b37a716549eb"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[166997, 4548, 248, 4, 67, "Section",ExpressionUUID->"20d7a4b4-184d-4755-9e53-90540003931c"],
Cell[CellGroupData[{
Cell[167270, 4556, 165, 3, 54, "Subsection",ExpressionUUID->"cd211fbc-351b-496a-89c0-ca785cd0d290"],
Cell[CellGroupData[{
Cell[167460, 4563, 543, 11, 30, "Input",ExpressionUUID->"3d4abe0b-62c2-417f-a6bc-897ee613e099"],
Cell[168006, 4576, 1543, 41, 62, "Output",ExpressionUUID->"b1350e0e-3199-49b2-a841-f386405ff653"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169586, 4622, 578, 15, 30, "Input",ExpressionUUID->"4dc2ce33-c844-4320-9d53-78f637ddf159"],
Cell[170167, 4639, 515, 10, 66, "Output",ExpressionUUID->"89f67057-e0e0-4068-908b-f46d1d931091"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170719, 4654, 445, 10, 30, "Input",ExpressionUUID->"da2fccd4-774d-43d1-8e7d-42f6ca04c3d1"],
Cell[171167, 4666, 1401, 39, 62, "Output",ExpressionUUID->"5b611af6-edef-4406-96e2-820e207ae755"]
}, Open  ]],
Cell[CellGroupData[{
Cell[172605, 4710, 552, 15, 30, "Input",ExpressionUUID->"80484777-95b7-423a-a47d-d9fa714402fb"],
Cell[173160, 4727, 485, 9, 66, "Output",ExpressionUUID->"fed9c463-e084-4556-b60f-90d547aa5222"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173682, 4741, 419, 10, 30, "Input",ExpressionUUID->"d6535aa0-3bd2-41d9-9a32-2323c290e62c"],
Cell[174104, 4753, 1286, 36, 62, "Output",ExpressionUUID->"7257df2d-159f-4617-bf9b-589b8c420d64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175427, 4794, 553, 15, 30, "Input",ExpressionUUID->"efc77100-988a-4d29-a9e1-870be39f9172"],
Cell[175983, 4811, 485, 9, 66, "Output",ExpressionUUID->"3f2c061a-4ec0-491d-9ad5-268370540a4f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[176517, 4826, 189, 3, 38, "Subsection",ExpressionUUID->"a7edf84f-cb69-42b0-baa0-4bb19a2d8660"],
Cell[CellGroupData[{
Cell[176731, 4833, 529, 16, 30, "Input",ExpressionUUID->"1c4043d6-6bec-4b21-98a3-2c707dce71b2"],
Cell[177263, 4851, 387, 8, 66, "Output",ExpressionUUID->"e21af621-c416-4801-95c1-b0a4a7ee47bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177687, 4864, 529, 16, 30, "Input",ExpressionUUID->"16490150-e32e-4caa-afd9-fb531933eaf6"],
Cell[178219, 4882, 371, 8, 66, "Output",ExpressionUUID->"7e2bbf59-c1a0-4f01-8d5b-db7f433cb920"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178627, 4895, 529, 16, 30, "Input",ExpressionUUID->"fa1acfb3-c08d-4e6f-8c97-c34b80385126"],
Cell[179159, 4913, 354, 8, 66, "Output",ExpressionUUID->"a8dde704-0677-4a18-a302-9ad54c201124"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[179562, 4927, 186, 3, 38, "Subsection",ExpressionUUID->"cf5f258c-db07-4f24-91f6-e7340f7f17bd"],
Cell[CellGroupData[{
Cell[179773, 4934, 529, 16, 30, "Input",ExpressionUUID->"4da72b83-b70b-400f-8c72-03863e37d17b"],
Cell[180305, 4952, 434, 9, 84, "Output",ExpressionUUID->"14b30260-97ea-46f9-9fa8-2f5d71c27090"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180776, 4966, 529, 16, 30, "Input",ExpressionUUID->"f31c41cb-cd5f-421a-81f9-19aaae87ef6a"],
Cell[181308, 4984, 401, 8, 84, "Output",ExpressionUUID->"75f13465-c166-4636-ac9b-c963dbe0d85c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181746, 4997, 529, 16, 30, "Input",ExpressionUUID->"59dfb573-81ba-4e50-87b7-fb84f134d6df"],
Cell[182278, 5015, 437, 9, 84, "Output",ExpressionUUID->"5f4e8ffe-9423-411b-b1d1-e1a031c95541"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182752, 5029, 529, 16, 30, "Input",ExpressionUUID->"5db78344-106e-406c-9345-fe7172a62cad"],
Cell[183284, 5047, 400, 9, 84, "Output",ExpressionUUID->"904cc4c3-9ea0-4182-91fd-5089907ce223"]
}, Open  ]],
Cell[CellGroupData[{
Cell[183721, 5061, 529, 16, 30, "Input",ExpressionUUID->"67e6d9bd-91c1-4060-bb00-a6cc113adff2"],
Cell[184253, 5079, 439, 9, 84, "Output",ExpressionUUID->"a67c4e24-cb5b-48f3-b923-2f71a45651de"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184729, 5093, 529, 16, 30, "Input",ExpressionUUID->"b25ed57b-4d62-4949-8c67-89a3dbbf4956"],
Cell[185261, 5111, 445, 9, 84, "Output",ExpressionUUID->"18d31623-a116-47fa-a00a-e20438305dc0"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[185767, 5127, 1092, 34, 82, "Section",ExpressionUUID->"663533f7-cd90-4ac3-abb4-07c6984ab1ca"],
Cell[CellGroupData[{
Cell[186884, 5165, 168, 3, 54, "Subsection",ExpressionUUID->"fcfaabf0-3cb1-4b23-8012-7b126e55e0bf"],
Cell[CellGroupData[{
Cell[187077, 5172, 902, 27, 50, "Input",ExpressionUUID->"2dba5e94-21f3-4fe6-b07e-6ff6affab9fa"],
Cell[187982, 5201, 1650, 50, 109, "Output",ExpressionUUID->"3031d4aa-9c72-4f4d-ade6-eca7787fbf08"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[189681, 5257, 187, 3, 38, "Subsection",ExpressionUUID->"0cf55a52-f41e-4a3b-a912-3b57e376b561"],
Cell[CellGroupData[{
Cell[189893, 5264, 1378, 38, 74, "Input",ExpressionUUID->"d829af12-81ad-40e6-9ce5-d90035b5baae"],
Cell[191274, 5304, 447, 9, 34, "Output",ExpressionUUID->"4085d93e-e97c-49dd-8299-a9afff28681d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191758, 5318, 1354, 37, 74, "Input",ExpressionUUID->"90de07be-d2e4-4c42-b6d7-aca865e0ead2"],
Cell[193115, 5357, 459, 9, 34, "Output",ExpressionUUID->"8a317554-90eb-4ac4-bf34-3b65e14b5d22"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193611, 5371, 1352, 37, 74, "Input",ExpressionUUID->"ee8d5562-8c5a-4001-a560-b165fcad7b90"],
Cell[194966, 5410, 462, 9, 34, "Output",ExpressionUUID->"37f4a706-1f6b-44f1-bbc3-4caf99adfecd"]
}, Open  ]]
}, Closed]],
Cell[195455, 5423, 186, 3, 38, "Subsection",ExpressionUUID->"cc749f2d-2d4d-47b0-95d9-7902fdb83b40"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[195690, 5432, 213, 4, 69, "Chapter",ExpressionUUID->"57fe9b2c-f2e9-4b89-ad1a-6412a8f822db"],
Cell[CellGroupData[{
Cell[195928, 5440, 151, 3, 67, "Section",ExpressionUUID->"dc59816c-8373-43c5-8e2b-deb0ea4b1a41"],
Cell[196082, 5445, 780, 24, 207, "Input",ExpressionUUID->"4d8b45d8-a08c-4768-8bac-bbbbd06f9aaf"],
Cell[CellGroupData[{
Cell[196887, 5473, 173, 2, 30, "Input",ExpressionUUID->"f05c1242-7293-4893-a1fa-a93b32b7d0d0"],
Cell[197063, 5477, 153, 2, 34, "Output",ExpressionUUID->"717cb67b-9ead-44bd-b589-b4ec56a97ca1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197253, 5484, 369, 8, 48, "Input",ExpressionUUID->"6c189421-8b5a-42d0-8a39-5039ab3d3326"],
Cell[197625, 5494, 381, 8, 36, "Output",ExpressionUUID->"f92d6b43-2fa6-46ac-8032-a4ddd5cc0b65"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

