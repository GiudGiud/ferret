(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    304648,       8386]
NotebookOptionsPosition[    269670,       7741]
NotebookOutlinePosition[    270063,       7757]
CellTagsIndexPosition[    270020,       7754]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Ferret Kernels", "Title",
 CellChangeTimes->{{3.823147949585373*^9, 3.8231479625615892`*^9}, {
  3.8231482825621843`*^9, 
  3.8231482983462257`*^9}},ExpressionUUID->"ebc18a75-c4e1-49dd-838b-\
d0c8ff912763"],

Cell[CellGroupData[{

Cell["    Preliminary functions", "Chapter",
 CellChangeTimes->{{3.8231479859528847`*^9, 3.823147988441524*^9}, {
  3.823148022767866*^9, 
  3.823148027497468*^9}},ExpressionUUID->"5441bba2-423a-4c0d-9ffc-\
e5edeeb48100"],

Cell[CellGroupData[{

Cell["        Unit conversion", "Section",
 CellChangeTimes->{{3.8231479988646517`*^9, 
  3.8231480311988077`*^9}},ExpressionUUID->"12bd110e-b09a-44f8-841e-\
9c5d197e841e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"func", "[", 
   RowBox[{"value_", ",", "inputUnits_", ",", "outputUnits_"}], "]"}], ":=", 
  RowBox[{"UnitConvert", "[", 
   RowBox[{
    RowBox[{"Quantity", "[", 
     RowBox[{"value", ",", "inputUnits"}], "]"}], ",", "outputUnits"}], 
   "]"}]}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"6d9b666e-5dbb-46fd-94e7-33aef6aafa8a"],

Cell["An example:", "Text",
 CellChangeTimes->{{3.823148151317663*^9, 
  3.823148152597856*^9}},ExpressionUUID->"ca3e17df-ac3b-40d1-aa84-\
f547bd858c35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MassScale", "=", "\"\<Picograms\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeScale", "=", "\"\<Microseconds\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LengthScale", "=", "\"\<Micrometers\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.823148164695219*^9, 3.823148203932562*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"605aba92-17ae-4205-91d8-9a7659e9a384"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"func", "[", 
  RowBox[{
   RowBox[{"1.30", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "11"}]]}], ",", 
   FractionBox[
    RowBox[{"\"\<Kilograms\>\"", 
     SuperscriptBox["\"\<Meters\>\"", "2"]}], 
    RowBox[{
     SuperscriptBox["\"\<Seconds\>\"", "2"], "\"\<Meters\>\""}]], ",", 
   FractionBox[
    RowBox[{"MassScale", " ", 
     SuperscriptBox["LengthScale", "2"]}], 
    RowBox[{
     SuperscriptBox["TimeScale", "2"], "LengthScale"}]]}], "]"}]], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"1892d17d-27b2-4b8b-94dc-87869d71f4fa"],

Cell[BoxData[
 TemplateBox[{"0.013000000000000001`", 
   RowBox[{
    "\"pg\"", "\[ThinSpace]", "\"\[Micro]m\"", "\[InvisibleSpace]", "\"/\"", 
     "\[InvisibleSpace]", 
     SuperscriptBox["\"\[Micro]s\"", "2"]}], 
   "picogram micrometers per microsecond squared", 
   FractionBox[
    RowBox[{"\"Micrometers\"", " ", "\"Picograms\""}], 
    SuperscriptBox["\"Microseconds\"", "2"]]},
  "Quantity"]], "Output",
 CellChangeTimes->{3.823148210258013*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"77e9a8ef-d9a0-4014-ac75-8d5c8a14140a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        Symmetry operations and notations", "Section",
 CellChangeTimes->{{3.823148013520158*^9, 3.823148033711926*^9}, {
  3.823148121190465*^9, 
  3.8231481224701643`*^9}},ExpressionUUID->"db5ce5f6-8789-4b65-95a7-\
18a927eaeca8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VT2", "[", 
    RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Transform", " ", "rank", " ", "2", " ", "tensor", " ", "to", " ", 
        "Voight", " ", 
        RowBox[{"notation", ".", " ", "\[IndentingNewLine]", "Note"}], " ", 
        "we", " ", "use", " ", "11"}], "\[Rule]", "1"}], ",", 
      RowBox[{"22", "\[Rule]", "2"}], ",", 
      RowBox[{"33", "\[Rule]", "3"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"23", ",", "32"}], "}"}], "\[Rule]", "4"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "31"}], "}"}], "\[Rule]", "5"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"12", ",", "21"}], "}"}], "\[Rule]", 
       RowBox[{"6", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "6", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "5", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "4", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "6", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "5", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "4", "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", "3", "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7944800737222223`*^9, 3.794480088125193*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"1ca755ac-49aa-43df-b917-d8a909ba1ddf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VT4", "[", 
    RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Transform", " ", "rank", " ", "4", " ", "tensor", " ", "to", " ", 
        "Voight", " ", 
        RowBox[{"notation", ".", " ", "\[IndentingNewLine]", "Note"}], " ", 
        "we", " ", "use", " ", "11"}], "\[Rule]", "1"}], ",", 
      RowBox[{"22", "\[Rule]", "2"}], ",", 
      RowBox[{"33", "\[Rule]", "3"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"23", ",", "32"}], "}"}], "\[Rule]", "4"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "31"}], "}"}], "\[Rule]", "5"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"12", ",", "21"}], "}"}], "\[Rule]", 
       RowBox[{"6", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "6"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "5"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "5"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "2"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "4"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "4"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "1", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "2", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "6"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "4"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "3", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "4"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "2", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "2", ",", "3", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"4", ",", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "1", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"6", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "3", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "3"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "1", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"5", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "1", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "3", ",", "1"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "5"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"2", ",", "2", ",", "3", ",", "3"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"3", ",", "3", ",", "2", ",", "2"}], "]"}], "\[Rule]", 
      RowBox[{"B", "[", 
       RowBox[{"3", ",", "2"}], "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.794222797075919*^9, 3.7942228260771847`*^9}, {
   3.794222930105603*^9, 3.794222946199676*^9}, {3.794223700003508*^9, 
   3.794223714626367*^9}, 3.8231480777005787`*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"c5ff5347-cd13-4494-820b-16853e833e42"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"polarT", "[", "P_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"P", "[", "1", "]"}], "\[Rule]", "Px"}], ",", 
    RowBox[{
     RowBox[{"P", "[", "2", "]"}], "\[Rule]", "Py"}], ",", 
    RowBox[{
     RowBox[{"P", "[", "3", "]"}], "\[Rule]", "Pz"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"strainT", "[", "e_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], "\[Rule]", "exx"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "2", "]"}], "\[Rule]", "eyy"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], "\[Rule]", "ezz"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "4", "]"}], "\[Rule]", 
      RowBox[{"0.5", "eyz"}]}], ",", 
     RowBox[{
      RowBox[{"e", "[", "5", "]"}], "\[Rule]", 
      RowBox[{"0.5", "exz"}]}], ",", 
     RowBox[{
      RowBox[{"e", "[", "6", "]"}], "\[Rule]", 
      RowBox[{"0.5", "exy"}]}]}], "}"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"i", " ", "think"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cubicF", "[", 
   RowBox[{"q0_", ",", "q11_", ",", "q12_", ",", "q44_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", "q11"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", "q11"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"3", ",", "3"}], "]"}], "\[Rule]", "q11"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", "q12"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"1", ",", "3"}], "]"}], "\[Rule]", "q12"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"2", ",", "3"}], "]"}], "\[Rule]", "q12"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"3", ",", "2"}], "]"}], "\[Rule]", "q12"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "q12"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"3", ",", "1"}], "]"}], "\[Rule]", "q12"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"4", ",", "4"}], "]"}], "\[Rule]", "q44"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"5", ",", "5"}], "]"}], "\[Rule]", "q44"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"6", ",", "6"}], "]"}], "\[Rule]", "q44"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"1", ",", "4"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"1", ",", "5"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"1", ",", "6"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"2", ",", "4"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"2", ",", "5"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"2", ",", "6"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"3", ",", "4"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"3", ",", "5"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"3", ",", "6"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"4", ",", "1"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"4", ",", "2"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"4", ",", "3"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"4", ",", "5"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"4", ",", "6"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"5", ",", "1"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"5", ",", "2"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"5", ",", "3"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"5", ",", "4"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"5", ",", "6"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"6", ",", "1"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"6", ",", "2"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"6", ",", "3"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"6", ",", "4"}], "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"q0", "[", 
      RowBox[{"6", ",", "5"}], "]"}], "\[Rule]", "0"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"symStrain", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"exx", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"uxx", "+", "uxx"}], ")"}]}]}], ",", 
    RowBox[{"eyy", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"uyy", "+", "uyy"}], ")"}]}]}], ",", 
    RowBox[{"ezz", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"uzz", "+", "uzz"}], ")"}]}]}], ",", 
    RowBox[{"exy", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"uxy", "+", "uyx"}], ")"}]}]}], ",", 
    RowBox[{"exz", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"uxz", "+", "uzx"}], ")"}]}]}], ",", 
    RowBox[{"eyx", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"uyx", "+", "uxy"}], ")"}]}]}], ",", 
    RowBox[{"eyz", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"uyz", "+", "uzy"}], ")"}]}]}], ",", 
    RowBox[{"ezx", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"uzx", "+", "uxz"}], ")"}]}]}], ",", 
    RowBox[{"ezy", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"uzy", "+", "uyz"}], ")"}]}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.823236468995883*^9, 3.8232365939020567`*^9}, {
  3.823237270145797*^9, 3.823237275401499*^9}, {3.8232373065298643`*^9, 
  3.823237357535678*^9}, {3.8232379217965*^9, 3.8232379602527657`*^9}, {
  3.823238599023796*^9, 3.82323861154449*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"186ae615-8cb2-48a9-b5b5-b100bf1f8732"]
}, Closed]],

Cell[CellGroupData[{

Cell["        Weak form algebra ", "Section",
 CellChangeTimes->{{3.823148216637491*^9, 
  3.823148238833702*^9}},ExpressionUUID->"2e54c9af-338a-4b60-a60b-\
94baa3d3602f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"varvec", "=", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "y", ",", "z", ",", "x", ",", "y", ",", "z", ",", "x", ",", "y",
      ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intByParts1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d2mxdx2", "\[Rule]", 
      RowBox[{"-", "dmxdx"}]}], ",", 
     RowBox[{"d2mxdy2", "\[Rule]", 
      RowBox[{"-", "dmxdy"}]}], ",", 
     RowBox[{"d2mxdz2", "\[Rule]", 
      RowBox[{"-", "dmxdz"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"d2mydx2", "\[Rule]", 
      RowBox[{"-", "dmydx"}]}], ",", 
     RowBox[{"d2mydy2", "\[Rule]", 
      RowBox[{"-", "dmydy"}]}], ",", 
     RowBox[{"d2mydz2", "\[Rule]", 
      RowBox[{"-", "dmydz"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"d2mzdx2", "\[Rule]", 
      RowBox[{"-", "dmzdx"}]}], ",", 
     RowBox[{"d2mzdy2", "\[Rule]", 
      RowBox[{"-", "dmzdy"}]}], ",", 
     RowBox[{"d2mzdz2", "\[Rule]", 
      RowBox[{"-", "dmzdz"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"mx", "\[Rule]", 
      RowBox[{"mx", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
     RowBox[{"my", "\[Rule]", 
      RowBox[{"my", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
     RowBox[{"mz", "\[Rule]", 
      RowBox[{"mz", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", 
      RowBox[{"\[Psi]h", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intByParts2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdx"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydx"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdx"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdy"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydy"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdy"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdz"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydz"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mx", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "mx"}], ",", 
     RowBox[{
      RowBox[{"my", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "my"}], ",", 
     RowBox[{
      RowBox[{"mz", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "mz"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Psi]h", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "d\[Psi]hdx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Psi]h", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "d\[Psi]hdy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Psi]h", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "d\[Psi]hdz"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Psi]h", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "\[Psi]h"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"algFEM1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mx", "\[Rule]", 
      RowBox[{"mx", "[", "m0x", "]"}]}], ",", 
     RowBox[{"my", "\[Rule]", 
      RowBox[{"my", "[", "m0y", "]"}]}], ",", 
     RowBox[{"mz", "\[Rule]", 
      RowBox[{"mz", "[", "m0z", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"dmxdx", "\[Rule]", 
      RowBox[{"dmxdx", "[", "m0x", "]"}]}], ",", 
     RowBox[{"dmxdy", "\[Rule]", 
      RowBox[{"dmxdy", "[", "m0x", "]"}]}], ",", 
     RowBox[{"dmxdz", "\[Rule]", 
      RowBox[{"dmxdz", "[", "m0x", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"dmydx", "\[Rule]", 
      RowBox[{"dmydx", "[", "m0y", "]"}]}], ",", 
     RowBox[{"dmydy", "\[Rule]", 
      RowBox[{"dmydy", "[", "m0y", "]"}]}], ",", 
     RowBox[{"dmydz", "\[Rule]", 
      RowBox[{"dmydz", "[", "m0y", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"dmzdx", "\[Rule]", 
      RowBox[{"dmzdx", "[", "m0z", "]"}]}], ",", 
     RowBox[{"dmzdy", "\[Rule]", 
      RowBox[{"dmzdy", "[", "m0z", "]"}]}], ",", 
     RowBox[{"dmzdz", "\[Rule]", 
      RowBox[{"dmzdz", "[", "m0z", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"algFEM2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["dmxdx", "\[Prime]",
        MultilineFunction->None], "[", "m0x", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmxdy", "\[Prime]",
        MultilineFunction->None], "[", "m0x", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmxdz", "\[Prime]",
        MultilineFunction->None], "[", "m0x", "]"}], "\[Rule]", "dphidz"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmydx", "\[Prime]",
        MultilineFunction->None], "[", "m0y", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmydy", "\[Prime]",
        MultilineFunction->None], "[", "m0y", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmydz", "\[Prime]",
        MultilineFunction->None], "[", "m0y", "]"}], "\[Rule]", "dphidz"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmzdx", "\[Prime]",
        MultilineFunction->None], "[", "m0z", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmzdy", "\[Prime]",
        MultilineFunction->None], "[", "m0z", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmzdz", "\[Prime]",
        MultilineFunction->None], "[", "m0z", "]"}], "\[Rule]", "dphidz"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mx", "[", "m0x", "]"}], "\[Rule]", "mx"}], ",", 
     RowBox[{
      RowBox[{"my", "[", "m0y", "]"}], "\[Rule]", "my"}], ",", 
     RowBox[{
      RowBox[{"mz", "[", "m0z", "]"}], "\[Rule]", "mz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dmxdx", "[", "m0x", "]"}], "->", "dmxdx"}], ",", 
     RowBox[{
      RowBox[{"dmxdy", "[", "m0x", "]"}], "\[Rule]", "dmxdy"}], ",", 
     RowBox[{
      RowBox[{"dmxdz", "[", "m0x", "]"}], "\[Rule]", "dmxdz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dmydx", "[", "m0y", "]"}], "->", "dmydx"}], ",", 
     RowBox[{
      RowBox[{"dmydy", "[", "m0y", "]"}], "\[Rule]", "dmydy"}], ",", 
     RowBox[{
      RowBox[{"dmydz", "[", "m0y", "]"}], "\[Rule]", "dmydz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dmzdx", "[", "m0z", "]"}], "->", "dmzdx"}], ",", 
     RowBox[{
      RowBox[{"dmzdy", "[", "m0z", "]"}], "\[Rule]", "dmzdy"}], ",", 
     RowBox[{
      RowBox[{"dmzdz", "[", "m0z", "]"}], "\[Rule]", "dmzdz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", "\[Prime]",
        MultilineFunction->None], "[", "m0x", "]"}], "\[Rule]", "phi"}], ",", 
     
     RowBox[{
      RowBox[{
       SuperscriptBox["my", "\[Prime]",
        MultilineFunction->None], "[", "m0y", "]"}], "\[Rule]", "phi"}], ",", 
     
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", "\[Prime]",
        MultilineFunction->None], "[", "m0z", "]"}], "\[Rule]", "phi"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deriv", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdz"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydz"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdy"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydy"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdy"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdx"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydx"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdx"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jsub", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ux", "\[Rule]", 
      RowBox[{
       FractionBox["\[Mu]B", 
        RowBox[{"2", " ", "e", " ", "\[Gamma]B", " ", "Ms", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Xi]", "2"]}], ")"}]}]], "jx"}]}], ",", 
     RowBox[{"uy", "\[Rule]", 
      RowBox[{
       FractionBox["\[Mu]B", 
        RowBox[{"2", " ", "e", " ", "\[Gamma]B", " ", "Ms", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Xi]", "2"]}], ")"}]}]], "jy"}]}], ",", 
     RowBox[{"uz", "\[Rule]", 
      RowBox[{
       FractionBox["\[Mu]B", 
        RowBox[{"2", " ", "e", " ", "\[Gamma]B", " ", "Ms", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Xi]", "2"]}], ")"}]}]], "jz"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.788765212372756*^9, 3.7887652160535097`*^9}, {
  3.7887654168575077`*^9, 3.788765419065247*^9}, {3.794140319359366*^9, 
  3.7941403200253*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"ee610166-5c22-4f17-8c56-1c170d3f5627"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dispFEM1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"e11", "\[Rule]", 
      RowBox[{"duxdx", "[", "u0x", "]"}]}], ",", 
     RowBox[{"e22", "\[Rule]", 
      RowBox[{"duydy", "[", "u0y", "]"}]}], ",", 
     RowBox[{"e33", "\[Rule]", 
      RowBox[{"duzdz", "[", "u0z", "]"}]}], ",", 
     RowBox[{"e12", "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"duxdy", "[", "u0x", "]"}], "+", 
         RowBox[{"duydx", "[", "u0y", "]"}]}], ")"}]}]}], ",", 
     RowBox[{"e13", "->", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"duxdz", "[", "u0x", "]"}], "+", 
         RowBox[{"duzdx", "[", "u0z", "]"}]}], ")"}]}]}], ",", 
     RowBox[{"e23", "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"duydz", "[", "u0y", "]"}], "+", 
         RowBox[{"duzdy", "[", "u0z", "]"}]}], ")"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dispFEM2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["duxdx", "\[Prime]",
        MultilineFunction->None], "[", "u0x", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duxdy", "\[Prime]",
        MultilineFunction->None], "[", "u0x", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duxdz", "\[Prime]",
        MultilineFunction->None], "[", "u0x", "]"}], "\[Rule]", "dphidz"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duydx", "\[Prime]",
        MultilineFunction->None], "[", "u0y", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duydy", "\[Prime]",
        MultilineFunction->None], "[", "u0y", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duydz", "\[Prime]",
        MultilineFunction->None], "[", "u0y", "]"}], "\[Rule]", "dphidz"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duzdx", "\[Prime]",
        MultilineFunction->None], "[", "u0z", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duzdy", "\[Prime]",
        MultilineFunction->None], "[", "u0z", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["duzdz", "\[Prime]",
        MultilineFunction->None], "[", "u0z", "]"}], "\[Rule]", "dphidz"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.795173609251067*^9, 3.795173611054225*^9}, {
  3.795173658690208*^9, 3.7951736640215387`*^9}, {3.7951742908846416`*^9, 
  3.795174369336994*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"96b479c7-9851-4b81-a4b7-5213ad725f43"]
}, Closed]],

Cell[CellGroupData[{

Cell["        Substitutions", "Section",
 CellChangeTimes->{{3.8231492560884247`*^9, 
  3.823149263857574*^9}},ExpressionUUID->"0cab8b2a-af49-48c4-9bb9-\
ad7d3853943c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"effectiveFieldSubstitute", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Hx", "\[Rule]", 
      RowBox[{
       RowBox[{"Hexc", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", 
       RowBox[{"Hint", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", 
       RowBox[{"Hanis", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Hy", "\[Rule]", 
      RowBox[{
       RowBox[{"Hexc", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", 
       RowBox[{"Hint", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", 
       RowBox[{"Hanis", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Hz", "\[Rule]", 
      RowBox[{
       RowBox[{"Hexc", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "+", 
       RowBox[{"Hint", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "+", 
       RowBox[{"Hanis", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], " ", ",", "\[IndentingNewLine]", 
     RowBox[{"HxLL", "\[Rule]", 
      RowBox[{
       RowBox[{"\[CapitalSigma]excLL", 
        FractionBox[
         RowBox[{"Hexc", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[CapitalSigma]exc"]}], "+", 
       RowBox[{"\[CapitalSigma]intLL", 
        FractionBox[
         RowBox[{"Hint", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[CapitalSigma]int"]}], "+", 
       RowBox[{"\[CapitalSigma]anisLL", 
        FractionBox[
         RowBox[{"Hanis", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[CapitalSigma]anis"]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HyLL", "\[Rule]", 
      RowBox[{
       RowBox[{"\[CapitalSigma]excLL", 
        FractionBox[
         RowBox[{"Hexc", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[CapitalSigma]exc"]}], "+", 
       RowBox[{"\[CapitalSigma]intLL", 
        FractionBox[
         RowBox[{"Hint", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[CapitalSigma]int"]}], "+", 
       RowBox[{"\[CapitalSigma]anisLL", 
        FractionBox[
         RowBox[{"Hanis", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[CapitalSigma]anis"]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HzLL", "\[Rule]", 
      RowBox[{
       RowBox[{"\[CapitalSigma]excLL", 
        FractionBox[
         RowBox[{"Hexc", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[CapitalSigma]exc"]}], "+", 
       RowBox[{"\[CapitalSigma]intLL", 
        FractionBox[
         RowBox[{"Hint", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[CapitalSigma]int"]}], "+", 
       RowBox[{"\[CapitalSigma]anisLL", 
        FractionBox[
         RowBox[{"Hanis", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[CapitalSigma]anis"]}]}]}]}], 
    "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[104]:=",ExpressionUUID->"5c2c7011-a069-438e-8163-5636797022fe"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["    Ferroelectrics", "Chapter",
 CellChangeTimes->{{3.823147968473817*^9, 3.8231479698640842`*^9}, 
   3.823148034623803*^9, {3.823161227208509*^9, 
   3.823161256415927*^9}},ExpressionUUID->"7a035d01-4419-4dfa-8464-\
9f36e563fa83"],

Cell[CellGroupData[{

Cell["        Material coefficients", "Section",
 CellChangeTimes->{{3.823148319041975*^9, 
  3.823148324535351*^9}},ExpressionUUID->"28cfd32f-5d2f-4679-ba3f-\
71ab50c7c33c"],

Cell[CellGroupData[{

Cell[TextData[{
 "        ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["PbTiO", "3"], "(", 
    RowBox[{
     StyleBox["P",
      FontWeight->"Bold"], ",", 
     RowBox[{"\[Epsilon]", " ", "coupled", " ", "potential"}]}], ")"}], 
   TraditionalForm]],ExpressionUUID->"64b24ee3-82f8-40b0-9670-c6a0d7bcafb5"],
 ":"
}], "Subsection",
 CellChangeTimes->{{3.8231484348164787`*^9, 3.823148453155772*^9}, {
  3.823161265048024*^9, 3.8231612922086687`*^9}, {3.8232399153579683`*^9, 
  3.823239916405324*^9}},ExpressionUUID->"e63d1d95-158a-406e-bb47-\
4d3dd76d7507"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MassScale", "=", "\"\<Kilograms\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeScale", "=", "\"\<Seconds\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LengthScale", "=", "\"\<Nanometers\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ChargeScale", "=", "\"\<Attocoulombs\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", "298"}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.823149052140353*^9, 
  3.823149052767412*^9}},ExpressionUUID->"9d78ea87-567c-4f7f-92de-\
f0bbef9ef26a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Landau", " ", "coefficients"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]1", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"3.8", 
          RowBox[{"(", 
           RowBox[{"T", "-", "752"}], ")"}], 
          SuperscriptBox["10", "5"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "2"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "2"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "2"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "2"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"T", " ", "=", " ", 
     RowBox[{"300", " ", "K"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]11", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.72530"}], "*", 
          SuperscriptBox["10", "8"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "6"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "4"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "6"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "4"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]12", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"7.50", "*", 
          SuperscriptBox["10", "8"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "6"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "4"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "6"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "4"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]111", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"2.60", "*", 
          SuperscriptBox["10", "8"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "10"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "6"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "10"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "6"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]112", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"6.10", "*", 
          SuperscriptBox["10", "8"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "10"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "6"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "10"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "6"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]123", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "37.0"}], "*", 
          SuperscriptBox["10", "8"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "10"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "6"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "10"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "6"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Domain", " ", "Wall", " ", "term"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G110", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"1.73", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "4"], "\"\<Kilograms\>\"", 
            "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "2"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["LengthScale", "4"], "MassScale", " ", 
          "LengthScale"}], 
         RowBox[{
          SuperscriptBox["ChargeScale", "2"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Electrostrictive", " ", "coefficients"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q11", " ", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{"0.089", ",", 
         RowBox[{"(", 
          FractionBox[
           SuperscriptBox["\"\<Meters\>\"", "4"], 
           SuperscriptBox["\"\<Coulombs\>\"", "2"]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         SuperscriptBox["LengthScale", "4"], 
         SuperscriptBox["ChargeScale", "2"]], ")"}]}], "]"}]}], ";", 
    RowBox[{"Q12", " ", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"-", "0.026"}], ",", 
         RowBox[{"(", 
          FractionBox[
           SuperscriptBox["\"\<Meters\>\"", "4"], 
           SuperscriptBox["\"\<Coulombs\>\"", "2"]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         SuperscriptBox["LengthScale", "4"], 
         SuperscriptBox["ChargeScale", "2"]], ")"}]}], "]"}]}], ";", 
    RowBox[{"Q33", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{"0.0675", ",", 
         RowBox[{"(", 
          FractionBox[
           SuperscriptBox["\"\<Meters\>\"", "4"], 
           SuperscriptBox["\"\<Coulombs\>\"", "2"]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         SuperscriptBox["LengthScale", "4"], 
         SuperscriptBox["ChargeScale", "2"]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Electrostatics", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]0", " ", "=", " ", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"10", "*", "8.854187", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\"\<Coulombs\>\"", "2"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}], 
           RowBox[{"\"\<Kilograms\>\"", "\"\<Meters\>\"", " ", 
            SuperscriptBox["\"\<Meters\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["ChargeScale", "2"], 
          SuperscriptBox["TimeScale", "2"]}], 
         RowBox[{"MassScale", " ", 
          SuperscriptBox["LengthScale", "3"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Elastic", " ", "stiffness", " ", "tensor", " ", "components"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C11s", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"380.0", "*", 
          SuperscriptBox["10", "9"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"\"\<Kilograms\>\"", "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "2"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"MassScale", " ", "LengthScale"}], 
         RowBox[{
          SuperscriptBox["LengthScale", "2"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C12s", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"150.0", "*", 
          SuperscriptBox["10", "9"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"\"\<Kilograms\>\"", "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "2"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"MassScale", " ", "LengthScale"}], 
         RowBox[{
          SuperscriptBox["LengthScale", "2"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C33s", "=", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{
         RowBox[{"110.0", "*", 
          SuperscriptBox["10", "9"]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"\"\<Kilograms\>\"", "\"\<Meters\>\""}], 
           RowBox[{
            SuperscriptBox["\"\<Meters\>\"", "2"], 
            SuperscriptBox["\"\<Seconds\>\"", "2"]}]], ")"}]}], "]"}], ",", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"MassScale", " ", "LengthScale"}], 
         RowBox[{
          SuperscriptBox["LengthScale", "2"], 
          SuperscriptBox["TimeScale", "2"]}]], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     SubscriptBox["P", "max"], " ", "or", " ", "approximate", " ", "value", 
     " ", "of", " ", "polarization", " ", "at", " ", "each", " ", "node", " ",
      "at", " ", "end", " ", "of", " ", "simulation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UnitConvert", "[", 
     RowBox[{
      RowBox[{"Quantity", "[", 
       RowBox[{"0.65", ",", 
        RowBox[{"(", 
         FractionBox["\"\<Coulombs\>\"", 
          SuperscriptBox["\"\<Meters\>\"", "2"]], ")"}]}], "]"}], ",", 
      RowBox[{"(", 
       FractionBox["ChargeScale", 
        SuperscriptBox["LengthScale", "2"]], ")"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "\"\<[GlobalParams]\>\"", "<>", "\"\< \n \>\"", "<>", "\n", 
    "\"\<len_scale = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "lenS", "]"}], "]"}], " ", "]"}], 
    "<>", "\"\< \n\>\"", "<>", "\n", "\"\<alpha1 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "\[Alpha]1", "]"}], "]"}], "]"}], 
    "<>", "\"\< # (3.766(T-765.1)*10^5) C^{-2} nm^2 (T = 300 K)\>\"", "<>", 
    "\"\<\n\>\"", "<>", "\n", "\"\<alpha11 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "\[Alpha]11", "]"}], "]"}], "]"}], 
    " ", "<>", " ", "\"\<\n\>\"", "<>", "\n", "\"\<alpha111 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "\[Alpha]111", "]"}], "]"}], "]"}], 
    "<>", "\"\<\n\>\"", "<>", "\n", "\"\<alpha12 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "\[Alpha]12", "]"}], "]"}], "]"}], 
    "<>", "\"\< \n\>\"", "<>", "\n", "\"\<alpha112 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "\[Alpha]112", "]"}], "]"}], "]"}], 
    "<>", "\"\<\n\>\"", "<>", "\n", "\"\<alpha123 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "\[Alpha]123", "]"}], "]"}], "]"}], 
    "<>", "\"\<\n\>\"", "<>", "\n", "\"\<G110 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"NumberForm", "[", 
      RowBox[{
       RowBox[{"FortranForm", "[", 
        RowBox[{"QuantityMagnitude", "[", "G110", "]"}], "]"}], ",", "2"}], 
      "]"}], "]"}], "<>", "\"\<\n\>\"", "<>", "\n", "\"\<G11/G110 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", "0.6", "]"}], "]"}], "<>", "\"\<\n\>\"", "<>",
     "\n", "\"\<G12/G110 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", "0", "]"}], "]"}], "<>", "\"\< \n\>\"", "<>",
     "\n", "\"\<G44/G110 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", "0.3", "]"}], "]"}], "<>", "\"\<\n\>\"", "<>",
     " ", "\n", "\"\<G44P/G110 = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", "0.3", "]"}], "]"}], "<>", "\"\<\n \>\"", "<>",
     "\n", "\"\<Q_mnkl = '\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q11", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q12", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q12", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q11", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q12", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q11", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q33", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q33", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "Q33", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\<'\>\"", "<>", "\"\<\n\>\"", "<>", "\n", 
    "\"\<permittivity = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", 
       RowBox[{"1.0", "*", "\[Epsilon]0"}], "]"}], "]"}], "]"}], "<>", 
    "\"\<\n\>\"", "<>", "\n", "\"\<polar_x = polar_x\>\"", "<>", "\"\<\n\>\"",
     "<>", "\n", "\"\<polar_y = polar_y\>\"", "<>", "\"\<\n\>\"", "<>", "\n", 
    "\"\<polar_z = polar_z\>\"", "<>", "\"\<\n\>\"", "<>", "\n", 
    "\"\<potential_int = potential_int\>\"", "<>", "\"\<\n\>\"", "<>", "\n", 
    "\"\<potential_ext = potential_ext\>\"", "<>", "\"\<\n\>\"", "<>", "\n", 
    "\"\<disp_x=disp_x\>\"", "<>", "\[IndentingNewLine]", "\"\<\n\>\"", "<>", 
    "\n", "\"\<disp_y=disp_y\>\"", "<>", "\[IndentingNewLine]", "\"\<\n\>\"", 
    "<>", "\n", "\"\<disp_z=disp_z\>\"", "<>", "\"\<\n\>\"", "<>", "\n", 
    "\"\<displacements='disp_x disp_y disp_z'\>\"", "<>", "\"\<\n\>\"", "<>", 
    "\n", "\"\<use_displaced_mesh = false\>\"", "<>", "\"\<\n\>\"", "<>", 
    "\n", "\"\<C_ijkl = '\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C11s", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C12s", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C12s", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C11s", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C12s", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C11s", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C33s", "]"}], "]"}], "]"}], "<>", 
    "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C33s", "]"}], "]"}], " ", "]"}], 
    "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"FortranForm", "[", 
      RowBox[{"QuantityMagnitude", "[", "C33s", "]"}], "]"}], "]"}], " ", 
    "<>", "\"\<'\>\"", "<>", "\[IndentingNewLine]", "\"\<\n\>\"", "<>", "\n", 
    "\"\<[]\>\""}]}]}]], "Input",
 CellChangeTimes->{{3.646863040055949*^9, 3.6468630849062557`*^9}, {
   3.6477102134873667`*^9, 3.647710218874804*^9}, {3.6477103879562674`*^9, 
   3.647710388922699*^9}, {3.6477108245839977`*^9, 3.647710828153778*^9}, 
   3.647710887018095*^9, {3.6477109737425537`*^9, 3.647711006355276*^9}, {
   3.647711183809458*^9, 3.647711206271381*^9}, {3.647711338418755*^9, 
   3.647711413146394*^9}, {3.647711682036887*^9, 3.64771168966891*^9}, {
   3.647711728097595*^9, 3.647711773485506*^9}, {3.647711868280829*^9, 
   3.64771197224361*^9}, {3.647712016637435*^9, 3.6477120331422462`*^9}, {
   3.647712092416791*^9, 3.647712099197598*^9}, {3.647712140182198*^9, 
   3.647712160186522*^9}, 3.647712465589872*^9, 3.647712510959057*^9, {
   3.647712656427106*^9, 3.647712711133376*^9}, {3.647713127836959*^9, 
   3.647713129394238*^9}, {3.6477132035647087`*^9, 3.6477132087959213`*^9}, {
   3.647713279198717*^9, 3.6477133160971947`*^9}, {3.647713405628389*^9, 
   3.647713443102078*^9}, {3.647713475076442*^9, 3.647713517023387*^9}, {
   3.647714259378776*^9, 3.6477142803597307`*^9}, {3.647714354541769*^9, 
   3.647714357775249*^9}, {3.6477149091509113`*^9, 3.647714993745089*^9}, {
   3.647715066369506*^9, 3.647715110769836*^9}, 3.647790233509611*^9, {
   3.647790345502666*^9, 3.647790346918983*^9}, {3.647790594302248*^9, 
   3.64779059898962*^9}, {3.647790694110265*^9, 3.647790972240089*^9}, {
   3.6477916110286703`*^9, 3.64779161439681*^9}, {3.647883296756894*^9, 
   3.647883302658976*^9}, {3.6478856362085733`*^9, 3.647885638599304*^9}, {
   3.647887699767662*^9, 3.6478877011871023`*^9}, {3.647968680157094*^9, 
   3.6479686808620577`*^9}, {3.647970504876733*^9, 3.647970505547999*^9}, {
   3.6481349774646893`*^9, 3.648134977718112*^9}, {3.648393925414888*^9, 
   3.648393932644059*^9}, {3.648598226814809*^9, 3.6485982682696457`*^9}, {
   3.648598334001397*^9, 3.648598336352055*^9}, {3.648813845511849*^9, 
   3.6488138468166027`*^9}, {3.648816366017646*^9, 3.648816389288848*^9}, {
   3.648995362750836*^9, 3.648995432568611*^9}, {3.648995462599793*^9, 
   3.648995469229823*^9}, {3.6489956598662033`*^9, 3.648995680506147*^9}, {
   3.648995716111557*^9, 3.648995738533271*^9}, {3.648996394490115*^9, 
   3.648996414121767*^9}, {3.649000624665512*^9, 3.649000667228282*^9}, {
   3.649001528205715*^9, 3.6490015439501133`*^9}, {3.6490148831739817`*^9, 
   3.6490148915574903`*^9}, {3.649015525402555*^9, 3.649015526153455*^9}, {
   3.64902770473005*^9, 3.64902770783773*^9}, {3.649081434142069*^9, 
   3.6490814717377996`*^9}, {3.649084269429542*^9, 3.649084270347389*^9}, 
   3.649084301282524*^9, {3.649169374315112*^9, 3.649169442381168*^9}, {
   3.649172780920265*^9, 3.649172861220356*^9}, {3.649347814274878*^9, 
   3.649347825235147*^9}, {3.649347856173175*^9, 3.6493478815185204`*^9}, {
   3.654716380219863*^9, 3.6547164165998793`*^9}, {3.65486364208572*^9, 
   3.65486365234307*^9}, {3.655731331589226*^9, 3.6557313357788486`*^9}, {
   3.6635214283190823`*^9, 3.663521431885901*^9}, {3.6635214707314453`*^9, 
   3.663521471730034*^9}, {3.663521512468419*^9, 3.663521512856346*^9}, {
   3.66352159403833*^9, 3.663521595218871*^9}, {3.666029352401372*^9, 
   3.666029376828683*^9}, {3.668848762805831*^9, 3.668848763114154*^9}, {
   3.66922488479662*^9, 3.66922491311274*^9}, {3.6695022166315536`*^9, 
   3.6695022412245398`*^9}, {3.700302085861393*^9, 3.700302090850518*^9}, {
   3.7044048966048527`*^9, 3.704404900452491*^9}, {3.721052922357299*^9, 
   3.721052922529764*^9}, {3.721052955000379*^9, 3.721052955332302*^9}, {
   3.721052988383613*^9, 3.721052988660133*^9}, {3.721053032308648*^9, 
   3.7210530783875723`*^9}, {3.7210531129472847`*^9, 3.721053113361534*^9}, {
   3.7210531448207893`*^9, 3.721053145119864*^9}, {3.721053175363171*^9, 
   3.721053178856759*^9}, {3.721053470815824*^9, 3.721053471580323*^9}, {
   3.721053511482424*^9, 3.7210535116598387`*^9}, {3.721055096787768*^9, 
   3.7210551000535192`*^9}, 3.721056295069292*^9, {3.82314841672358*^9, 
   3.8231484270905657`*^9}, {3.823148458938603*^9, 3.823148462015953*^9}, {
   3.823148508592978*^9, 3.823148539047521*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"df2db43e-de59-4b2e-8507-d61dc375a349"],

Cell[BoxData["\<\"[GlobalParams] \\n len_scale = QuantityMagnitude(lenS) \
\\nalpha1 = -0.17251999999999998 # (3.766(T-765.1)*10^5) C^{-2} nm^2 (T = 300 \
K)\\nalpha11 = -0.07253000000000001\\nalpha111 = 0.26\\nalpha12 = 0.75 \
\\nalpha112 = 0.61\\nalpha123 = -3.7\\nG110 = 0.173\\nG11/G110 = \
0.6\\nG12/G110 = 0 \\nG44/G110 = 0.3\\nG44P/G110 = 0.3\\n Q_mnkl = '0.089 \
-0.026 -0.026 0.089 -0.026 0.089 0.0675 0.0675 0.0675'\\npermittivity = \
0.08854187\\npolar_x = polar_x\\npolar_y = polar_y\\npolar_z = \
polar_z\\npotential_int = potential_int\\npotential_ext = \
potential_ext\\ndisp_x=disp_x\\ndisp_y=disp_y\\ndisp_z=disp_z\\ndisplacements=\
'disp_x disp_y disp_z'\\nuse_displaced_mesh = false\\nC_ijkl = '380. 150. \
150. 380. 150. 380. 110. 110. 110.'\\n[]\"\>"], "Output",
 CellChangeTimes->{{3.823148510076063*^9, 3.823148539733964*^9}},
 CellLabel->"Out[70]=",ExpressionUUID->"1e16d244-119b-411f-acf6-26c1af7ce245"]
}, Open  ]]
}, Closed]],

Cell[TextData[{
 "        ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["BaTiO", "3"], "(", 
    RowBox[{
     StyleBox["P",
      FontWeight->"Bold"], ",", 
     RowBox[{"\[Epsilon]", " ", "coupled", " ", "potential"}]}], ")"}], 
   TraditionalForm]],ExpressionUUID->"b4354b9b-0f6c-4201-8760-5ada82b5e95d"],
 ":"
}], "Subsection",
 CellChangeTimes->{{3.823148649148109*^9, 3.823148658369581*^9}, {
  3.823161296984604*^9, 3.823161299431357*^9}, {3.8232399181879187`*^9, 
  3.823239920636952*^9}},ExpressionUUID->"72e10825-d014-413f-a842-\
21d38a5da6ad"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"          ", 
    RowBox[{
     SubscriptBox["BiFeO", "3"], "(", 
     RowBox[{
      StyleBox["P",
       FontWeight->"Bold"], ",", "A", ",", 
      RowBox[{"\[Epsilon]", " ", "coupled", " ", "potential"}]}], ")"}]}], 
   TraditionalForm]],ExpressionUUID->"308b4e60-bb6f-44c7-a1e8-644b195f21b4"],
 ":"
}], "Subsection",
 CellChangeTimes->{{3.8231613031110897`*^9, 3.823161330387838*^9}, {
  3.823172327245996*^9, 3.8231723277172422`*^9}, {3.823239923084626*^9, 
  3.82323992662*^9}},ExpressionUUID->"3235dd6f-e7ea-4ea8-8b26-8d6dc36b42b9"]
}, Open  ]],

Cell[TextData[{
 "        Governing equation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["[",
     FontWeight->"Bold"], 
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       RowBox[{
        StyleBox["P",
         FontWeight->"Bold"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], 
         StyleBox[",",
          FontWeight->"Bold"], 
         StyleBox["t",
          FontWeight->"Plain"]}], ")"}]}], 
      RowBox[{"\[PartialD]", "t"}]], " ", "=", " ", 
     RowBox[{"-", " ", 
      SubscriptBox["\[CapitalGamma]", 
       StyleBox["P",
        FontWeight->"Bold"]]}]}]}], TraditionalForm]],ExpressionUUID->
  "cb9ce8e1-b6b8-4f52-bff9-6d67eee3e19a"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox[
     FractionBox[
      StyleBox["\[Delta]F",
       FontWeight->"Plain"], 
      RowBox[{
       StyleBox[
        RowBox[{
         StyleBox["\[Delta]",
          FontWeight->"Plain"], "P"}]], 
       StyleBox["(",
        FontWeight->"Plain"], 
       RowBox[{"r", ",", 
        StyleBox["t",
         FontWeight->"Plain"]}], 
       StyleBox[")",
        FontWeight->"Plain"]}]],
     FontWeight->"Bold"], "]"}], TraditionalForm]],ExpressionUUID->
  "c69918c2-bd9b-4c31-aba6-2983ce6d587b"]
}], "Section",
 CellChangeTimes->{{3.823148922206627*^9, 3.823148928390716*^9}, {
  3.823151094901904*^9, 3.823151165749791*^9}, {3.823239197980247*^9, 
  3.823239204731504*^9}},ExpressionUUID->"5da2ae0b-5d70-4c56-9cc9-\
e071bf0a896b"],

Cell[CellGroupData[{

Cell[TextData[{
 "        Free energy  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["[",
     FontWeight->"Bold"], 
    RowBox[{"F", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["F", "bulk"], "(", 
        StyleBox["P",
         FontWeight->"Bold"], ")"}], "+", 
       RowBox[{
        SubscriptBox["F", "gradient"], "(", 
        StyleBox["P",
         FontWeight->"Bold"], ")"}], "+", 
       RowBox[{
        SubscriptBox["F", "elastic"], "(", "\[Epsilon]", ")"}], "+", 
       RowBox[{
        SubscriptBox["F", "electrostrictive"], "(", 
        RowBox[{
         StyleBox["P",
          FontWeight->"Bold"], ",", "\[Epsilon]"}], ")"}], "+", 
       RowBox[{
        SubscriptBox["F", "elec"], "(", 
        StyleBox["P",
         FontWeight->"Bold"], ")"}]}], "=", 
      RowBox[{"+", "..."}]}]}], 
    StyleBox["]",
     FontWeight->"Bold"]}], TraditionalForm]],ExpressionUUID->
  "e1c95662-2bfd-44b4-a39b-aee37ae33431"]
}], "Section",
 CellChangeTimes->{{3.8231510815977983`*^9, 3.823151092721257*^9}, {
  3.823153109471333*^9, 3.823153186349564*^9}, {3.823161338455106*^9, 
  3.8231613569949636`*^9}},ExpressionUUID->"0318d1e5-1e36-41ba-8187-\
e92dbe09de49"],

Cell[CellGroupData[{

Cell["          Bulk free energy", "Subsection",
 CellChangeTimes->{{3.8232354291921377`*^9, 
  3.8232354386512117`*^9}},ExpressionUUID->"1dbff085-0a86-4b5d-801d-\
662c15197193"],

Cell["\<\
Note this expression is only due to the fact that the parent phase is cubic. \
We can(will) generalize this further assuming the parent phase is some other \
symmetry.\
\>", "Text",
 CellChangeTimes->{{3.823236416537784*^9, 3.8232364422331038`*^9}, {
  3.8232367647476683`*^9, 
  3.823236768731086*^9}},ExpressionUUID->"b3454773-8216-44a5-a0e5-\
67153db34a4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Fbulk", "[", 
   RowBox[{"Px_", ",", "Py_", ",", "Pz_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a1", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["Px", "2"], "+", 
      SuperscriptBox["Py", "2"], "+", 
      SuperscriptBox["Pz", "2"]}], ")"}]}], "+", 
   RowBox[{"a11", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["Px", "4"], "+", 
      SuperscriptBox["Py", "4"], "+", 
      SuperscriptBox["Pz", "4"]}], ")"}]}], "+", 
   RowBox[{"a12", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Px", "2"], 
       SuperscriptBox["Py", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["Py", "2"], 
       SuperscriptBox["Pz", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["Px", "2"], 
       SuperscriptBox["Pz", "2"]}]}], ")"}]}], "+", 
   RowBox[{"a111", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["Px", "6"], "+", 
      SuperscriptBox["Py", "6"], "+", 
      SuperscriptBox["Pz", "6"]}], ")"}]}], "+", 
   RowBox[{"a112", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Px", "2"], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Py", "4"], "+", 
         SuperscriptBox["Pz", "4"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["Py", "2"], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Px", "4"], "+", 
         SuperscriptBox["Pz", "4"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["Pz", "2"], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Px", "4"], "+", 
         SuperscriptBox["Py", "4"]}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{"a123", " ", 
    SuperscriptBox["Px", "2"], 
    SuperscriptBox["Py", "2"], 
    SuperscriptBox["Pz", "2"]}], "+", 
   RowBox[{"a1111", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["Px", "8"], "+", 
      SuperscriptBox["Py", "8"], "+", 
      SuperscriptBox["Pz", "8"]}], ")"}]}], "+", 
   RowBox[{"a1122", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Px", "4"], 
       SuperscriptBox["Py", "4"]}], "+", 
      RowBox[{
       SuperscriptBox["Px", "4"], 
       SuperscriptBox["Pz", "4"]}], "+", 
      RowBox[{
       SuperscriptBox["Py", "4"], 
       SuperscriptBox["Pz", "4"]}]}], ")"}]}], "+", 
   RowBox[{"a1112", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Px", "6"], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Py", "2"], "+", 
         SuperscriptBox["Pz", "2"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["Py", "6"], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Px", "2"], "+", 
         SuperscriptBox["Pz", "2"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["Pz", "6"], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Px", "2"], "+", 
         SuperscriptBox["Py", "2"]}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{"a1123", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Px", "4"], 
       SuperscriptBox["Py", "2"], 
       SuperscriptBox["Pz", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["Px", "2"], 
       SuperscriptBox["Py", "4"], 
       SuperscriptBox["Pz", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["Px", "2"], 
       SuperscriptBox["Py", "2"], 
       SuperscriptBox["Pz", "4"]}]}], ")"}]}]}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"3c626555-cd51-44a8-93d5-07d73ec926bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fbulk", "[", 
  RowBox[{"Px", ",", "Py", ",", "Pz"}], "]"}]], "Input",
 CellChangeTimes->{{3.823238063849679*^9, 3.823238065689006*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"f1f6b01a-69c1-496b-96a8-d86d8d4c341c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a123", " ", 
   SuperscriptBox["Px", "2"], " ", 
   SuperscriptBox["Py", "2"], " ", 
   SuperscriptBox["Pz", "2"]}], "+", 
  RowBox[{"a1", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["Px", "2"], "+", 
     SuperscriptBox["Py", "2"], "+", 
     SuperscriptBox["Pz", "2"]}], ")"}]}], "+", 
  RowBox[{"a12", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["Px", "2"], " ", 
      SuperscriptBox["Py", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["Px", "2"], " ", 
      SuperscriptBox["Pz", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["Py", "2"], " ", 
      SuperscriptBox["Pz", "2"]}]}], ")"}]}], "+", 
  RowBox[{"a11", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["Px", "4"], "+", 
     SuperscriptBox["Py", "4"], "+", 
     SuperscriptBox["Pz", "4"]}], ")"}]}], "+", 
  RowBox[{"a1123", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["Px", "4"], " ", 
      SuperscriptBox["Py", "2"], " ", 
      SuperscriptBox["Pz", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["Px", "2"], " ", 
      SuperscriptBox["Py", "4"], " ", 
      SuperscriptBox["Pz", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["Px", "2"], " ", 
      SuperscriptBox["Py", "2"], " ", 
      SuperscriptBox["Pz", "4"]}]}], ")"}]}], "+", 
  RowBox[{"a1122", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["Px", "4"], " ", 
      SuperscriptBox["Py", "4"]}], "+", 
     RowBox[{
      SuperscriptBox["Px", "4"], " ", 
      SuperscriptBox["Pz", "4"]}], "+", 
     RowBox[{
      SuperscriptBox["Py", "4"], " ", 
      SuperscriptBox["Pz", "4"]}]}], ")"}]}], "+", 
  RowBox[{"a111", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["Px", "6"], "+", 
     SuperscriptBox["Py", "6"], "+", 
     SuperscriptBox["Pz", "6"]}], ")"}]}], "+", 
  RowBox[{"a1111", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["Px", "8"], "+", 
     SuperscriptBox["Py", "8"], "+", 
     SuperscriptBox["Pz", "8"]}], ")"}]}], "+", 
  RowBox[{"a1112", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Px", "2"], "+", 
        SuperscriptBox["Py", "2"]}], ")"}], " ", 
      SuperscriptBox["Pz", "6"]}], "+", 
     RowBox[{
      SuperscriptBox["Py", "6"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Px", "2"], "+", 
        SuperscriptBox["Pz", "2"]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["Px", "6"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Py", "2"], "+", 
        SuperscriptBox["Pz", "2"]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{"a112", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Px", "4"], "+", 
        SuperscriptBox["Py", "4"]}], ")"}], " ", 
      SuperscriptBox["Pz", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["Py", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Px", "4"], "+", 
        SuperscriptBox["Pz", "4"]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["Px", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Py", "4"], "+", 
        SuperscriptBox["Pz", "4"]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.823238065954578*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"b95891f1-3b33-4d7d-9cd6-918239aa7bd2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["          Electrostrictive free energy", "Subsection",
 CellChangeTimes->{{3.82323581693435*^9, 3.823235819838503*^9}, 
   3.8232367749352016`*^9},ExpressionUUID->"114525c9-fd38-49c4-b247-\
7cd3615403b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Felectrostrictive", "[", 
   RowBox[{
   "Px_", ",", "Py_", ",", "Pz_", ",", "exx_", ",", "eyy_", ",", "ezz_", ",", 
    "exy_", ",", "exz_", ",", "eyx_", ",", "eyz_", ",", "ezx_", ",", "ezy_"}],
    "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.5"}], 
           RowBox[{"q", "[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "*", 
           RowBox[{"e", "[", 
            RowBox[{"i", ",", "j"}], "]"}], "*", 
           RowBox[{"P", "[", "k", "]"}], "*", 
           RowBox[{"P", "[", "l", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"VT2", "[", 
          RowBox[{"e", ",", "\[Epsilon]"}], "]"}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"VT4", "[", 
         RowBox[{"q", ",", "q0"}], "]"}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{"polarT", "[", "P", "]"}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{"strainT", "[", "\[Epsilon]", "]"}], "}"}]}], "/.", 
    RowBox[{"cubicF", "[", 
     RowBox[{"q0", ",", "q11", ",", "q12", ",", "q44"}], "]"}]}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.823235824623208*^9, 3.823235834846788*^9}, {
  3.82323799536217*^9, 3.823238022026916*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"6be43089-bdcf-4d42-b9a6-aacafb37f4f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Felectrostrictive", "[", 
    RowBox[{
    "Px", ",", "Py", ",", "Pz", ",", "exx", ",", "eyy", ",", "ezz", ",", 
     "exy", ",", "exz", ",", "eyx", ",", "eyz", ",", "ezx", ",", "ezy"}], 
    "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "/.", "symStrain"}]], "Input",
 CellChangeTimes->{{3.8232380069864893`*^9, 3.8232380284417667`*^9}, {
  3.82323862000712*^9, 3.8232386205126038`*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"b19cce9a-e1dd-45b9-873c-33bb87f1ca63"],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "-", 
  RowBox[{"0.5`", " ", 
   SuperscriptBox["Px", "2"], " ", "q11", " ", "uxx"}], "-", 
  RowBox[{"0.5`", " ", 
   SuperscriptBox["Py", "2"], " ", "q12", " ", "uxx"}], "-", 
  RowBox[{"0.5`", " ", 
   SuperscriptBox["Pz", "2"], " ", "q12", " ", "uxx"}], "-", 
  RowBox[{"0.5`", " ", "Px", " ", "Py", " ", "q44", " ", 
   RowBox[{"(", 
    RowBox[{"uxy", "+", "uyx"}], ")"}]}], "-", 
  RowBox[{"0.5`", " ", 
   SuperscriptBox["Py", "2"], " ", "q11", " ", "uyy"}], "-", 
  RowBox[{"0.5`", " ", 
   SuperscriptBox["Px", "2"], " ", "q12", " ", "uyy"}], "-", 
  RowBox[{"0.5`", " ", 
   SuperscriptBox["Pz", "2"], " ", "q12", " ", "uyy"}], "-", 
  RowBox[{"0.5`", " ", "Px", " ", "Pz", " ", "q44", " ", 
   RowBox[{"(", 
    RowBox[{"uxz", "+", "uzx"}], ")"}]}], "-", 
  RowBox[{"0.5`", " ", "Py", " ", "Pz", " ", "q44", " ", 
   RowBox[{"(", 
    RowBox[{"uyz", "+", "uzy"}], ")"}]}], "-", 
  RowBox[{"0.5`", " ", 
   SuperscriptBox["Pz", "2"], " ", "q11", " ", "uzz"}], "-", 
  RowBox[{"0.5`", " ", 
   SuperscriptBox["Px", "2"], " ", "q12", " ", "uzz"}], "-", 
  RowBox[{"0.5`", " ", 
   SuperscriptBox["Py", "2"], " ", "q12", " ", "uzz"}]}]], "Output",
 CellChangeTimes->{{3.823238017796298*^9, 3.823238028800517*^9}, 
   3.8232386210245934`*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"b2c67401-9ace-4b71-8cdf-98954bf25e07"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["          Elastic energy", "Subsection",
 CellChangeTimes->{{3.823238371035215*^9, 
  3.823238378534293*^9}},ExpressionUUID->"4274e034-4481-4cc9-a0c0-\
49b59382c5dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Felastic", "[", 
   RowBox[{
   "exx_", ",", "eyy_", ",", "ezz_", ",", "exy_", ",", "exz_", ",", "eyx_", 
    ",", "eyz_", ",", "ezx_", ",", "ezy_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"Cijkl", "[", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "*", 
         RowBox[{"e", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "*", 
         RowBox[{"e", "[", 
          RowBox[{"k", ",", "l"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{"VT2", "[", 
        RowBox[{"e", ",", "\[Epsilon]"}], "]"}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{"VT4", "[", 
       RowBox[{"Cijkl", ",", "Cel"}], "]"}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"strainT", "[", "\[Epsilon]", "]"}], "}"}]}], "/.", 
   RowBox[{"cubicF", "[", 
    RowBox[{"Cel", ",", "C11", ",", "C12", ",", "C44"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8232384226018744`*^9, 3.8232384740052643`*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"a8c92058-22b2-4805-9c3d-80135cf80877"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Felastic", "[", 
   RowBox[{
   "exx", ",", "eyy", ",", "ezz", ",", "exy", ",", "exz", ",", "eyx", ",", 
    "eyz", ",", "ezx", ",", "ezy"}], "]"}], "/.", "symStrain"}]], "Input",
 CellChangeTimes->{{3.8232384815210133`*^9, 3.823238489096489*^9}, {
  3.8232385896166277`*^9, 3.823238623638*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"8503c96a-0966-4144-98b5-f4c499846242"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     FractionBox[
      RowBox[{"C11", " ", 
       SuperscriptBox["uxx", "2"]}], "2"], "+", 
     RowBox[{"0.125`", " ", "C44", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"uxy", "+", "uyx"}], ")"}], "2"]}], "+", 
     RowBox[{"C12", " ", "uxx", " ", "uyy"}], "+", 
     FractionBox[
      RowBox[{"C11", " ", 
       SuperscriptBox["uyy", "2"]}], "2"], "+", 
     RowBox[{"0.125`", " ", "C44", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"uxz", "+", "uzx"}], ")"}], "2"]}], "+", 
     RowBox[{"0.125`", " ", "C44", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"uyz", "+", "uzy"}], ")"}], "2"]}], "+", 
     RowBox[{"C12", " ", "uxx", " ", "uzz"}], "+", 
     RowBox[{"C12", " ", "uyy", " ", "uzz"}], "+", 
     FractionBox[
      RowBox[{"C11", " ", 
       SuperscriptBox["uzz", "2"]}], "2"]}], "}"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.823238489401162*^9, 3.823238624171204*^9},
 CellLabel->
  "Out[136]=",ExpressionUUID->"8383f563-2fc1-46c7-810d-388bfe2bb7f2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["          Electrostatic interaction energy", "Subsection",
 CellChangeTimes->{{3.823238658729094*^9, 
  3.823238666092165*^9}},ExpressionUUID->"5818968a-45e5-46d7-8610-\
2fba52413263"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Felec", "[", 
   RowBox[{
   "Px_", ",", "Py_", ",", "Pz_", ",", "d\[CapitalPhi]dx_", ",", 
    "d\[CapitalPhi]dy_", ",", "d\[CapitalPhi]dz_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", "0.5"}], 
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{"Px", " ", "d\[CapitalPhi]dx"}], "+", 
     RowBox[{"Py", " ", "d\[CapitalPhi]dy"}], "+", 
     RowBox[{"Pz", " ", "d\[CapitalPhi]dz"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.823238669231577*^9, 3.823238737395589*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"b40dcbe1-78f0-4559-a488-8be39fe844c2"]
}, Closed]],

Cell[CellGroupData[{

Cell["          Gradient energy:", "Subsection",
 CellChangeTimes->{{3.8232387475626497`*^9, 
  3.823238752752652*^9}},ExpressionUUID->"1339ffbd-823d-4a62-8778-\
2ed65ef32713"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Fgradient", "[", 
   RowBox[{
   "dPxdx_", ",", "dPxdy_", ",", "dPxdz_", ",", "dPydx_", ",", "dPydy_", ",", 
    "dPydz_", ",", "dPzdx_", ",", "dPzdy_", ",", "dPzdz_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], "G11", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["dPxdx", "2"], "+", 
      SuperscriptBox["dPydy", "2"], "+", 
      SuperscriptBox["dPzdz", "2"]}], ")"}]}], "+", 
   RowBox[{"G12", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dPxdx", "*", "dPydy"}], "+", 
      RowBox[{"dPydy", "*", "dPzdz"}], "+", 
      RowBox[{"dPxdx", "*", "dPzdz"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], "G44", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"dPxdy", "+", "dPydx"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"dPzdy", "+", "dPydz"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"dPxdz", "+", "dPzdx"}], ")"}], "2"]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], "Gp44", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"dPxdy", "-", "dPydx"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"dPzdy", "-", "dPydz"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"dPxdz", "-", "dPzdx"}], ")"}], "2"]}], ")"}]}]}]}]], "Input",\

 CellChangeTimes->{{3.823238754758062*^9, 3.823238758891608*^9}, {
  3.823238792897839*^9, 3.823238949615271*^9}, {3.8232390472622223`*^9, 
  3.823239107732535*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"ccb31e99-0b2a-412c-983e-d042d51670f9"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "        Kernel for bulk energy ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    FractionBox[
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["F", "bulk"]}], 
     RowBox[{"\[Delta]", " ", 
      StyleBox["P",
       FontWeight->"Bold"]}]], "]"}], TraditionalForm]],ExpressionUUID->
  "f44d3eb1-b1ea-42bd-b5f2-369522c088ef"]
}], "Section",
 CellChangeTimes->{{3.823239124459477*^9, 
  3.8232391715715847`*^9}},ExpressionUUID->"ebffbc4e-2adf-4d84-8fb1-\
1b9b66a37014"],

Cell[TextData[{
 "Variational differentiation needs derivatives of the form,\n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["R", 
     SubscriptBox["P", "k"]], "=", 
    FractionBox["dF", 
     SubscriptBox["dP", "k"]]}], TraditionalForm]],ExpressionUUID->
  "1c15c71b-42e9-4a01-9588-aa5b88771b59"],
 "  and  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["J", 
     RowBox[{
      SubscriptBox["P", "k"], ",", 
      SubscriptBox["P", "j"]}]], "=", 
    FractionBox[
     SubscriptBox["dR", 
      SubscriptBox["P", "k"]], 
     SubscriptBox["dP", "j"]]}], TraditionalForm]],ExpressionUUID->
  "9b4aa75d-2d3b-4a4b-87e5-67d4313bc6ce"],
 "for k, j = 1, 2, 3 "
}], "Text",
 CellChangeTimes->{{3.82323927431606*^9, 
  3.82323935900733*^9}},ExpressionUUID->"447c3a4f-318b-4beb-a748-\
f63e257e3105"],

Cell[CellGroupData[{

Cell["          Residuals:", "Subsection",
 CellChangeTimes->{{3.7193448819245234`*^9, 3.7193448843282433`*^9}, {
   3.719391818108491*^9, 3.719391818421501*^9}, 3.719392997191592*^9, {
   3.823239372210415*^9, 
   3.8232393763661423`*^9}},ExpressionUUID->"eb65bc6b-b065-418d-a5f6-\
5f5a96793f2d"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"           ", 
    SubscriptBox["R", 
     SubscriptBox["P", "x"]]}], TraditionalForm]],ExpressionUUID->
  "50b62cf8-07e0-4048-8023-34f8af951d5d"],
 ":"
}], "Subsubsection",
 CellChangeTimes->{{3.719344895805732*^9, 3.7193448961113577`*^9}, {
   3.719390807268033*^9, 3.719390813191071*^9}, 3.7193914428088827`*^9, {
   3.71939438998591*^9, 3.719394392368957*^9}, {3.719502109612321*^9, 
   3.7195021115332823`*^9}, {3.8232393821808043`*^9, 3.823239382180834*^9}, {
   3.8232395042236853`*^9, 
   3.82323950422373*^9}},ExpressionUUID->"a794bad2-6776-4972-b1bf-\
827cfa9800a4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Fbulk", "[", 
     RowBox[{"Px", ",", "Py", ",", "Pz"}], "]"}], ",", "Px"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.719344898430873*^9, 3.719344914444131*^9}, {
   3.71939903915683*^9, 3.719399056808853*^9}, {3.719399253062793*^9, 
   3.7193992628429537`*^9}, 3.8232393871427383`*^9},
 CellLabel->
  "In[142]:=",ExpressionUUID->"992b342c-73b3-4259-ad4a-966a1132c726"],

Cell["\<\
2*a1*Px + 4*a11*Power(Px,3) + 6*a111*Power(Px,5) + 8*a1111*Power(Px,7) + \
2*a123*Px*Power(Py,2)*Power(Pz,2) + 
   a12*(2*Px*Power(Py,2) + 2*Px*Power(Pz,2)) + \
a1122*(4*Power(Px,3)*Power(Py,4) + 4*Power(Px,3)*Power(Pz,4)) + 
   a1123*(4*Power(Px,3)*Power(Py,2)*Power(Pz,2) + \
2*Px*Power(Py,4)*Power(Pz,2) + 2*Px*Power(Py,2)*Power(Pz,4)) + 
   a1112*(2*Px*Power(Py,6) + 2*Px*Power(Pz,6) + 6*Power(Px,5)*(Power(Py,2) + \
Power(Pz,2))) + 
   a112*(4*Power(Px,3)*Power(Py,2) + 4*Power(Px,3)*Power(Pz,2) + \
2*Px*(Power(Py,4) + Power(Pz,4)))\
\>", "Output",
 CellChangeTimes->{
  3.7193907979826307`*^9, 3.719395383065854*^9, 3.7193965834114113`*^9, {
   3.719399040684257*^9, 3.7193990574501762`*^9}, {3.719399254738504*^9, 
   3.719399275618236*^9}, 3.7195576453609056`*^9, 3.7221597191515427`*^9, 
   3.823239392440003*^9},
 CellLabel->
  "Out[142]//CForm=",ExpressionUUID->"8ca1d28c-bcaf-4b9e-96a2-85d86a3f74ae"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "           ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", 
    SubscriptBox["P", "y"]], TraditionalForm]],ExpressionUUID->
  "d40c9f5b-aeec-4c4b-8ece-ecd07c2ed73c"],
 ":"
}], "Subsubsection",
 CellChangeTimes->{{3.719344895805732*^9, 3.719344925231728*^9}, {
   3.7193908178164253`*^9, 3.7193908205702753`*^9}, 3.719391444611492*^9, {
   3.7193943969607143`*^9, 3.7193943997949944`*^9}, {3.719502114041711*^9, 
   3.71950211606565*^9}, 3.8232394056025133`*^9, 
   3.823239510563839*^9},ExpressionUUID->"2e543979-28fe-47dc-bd6c-\
20925c4df316"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Fbulk", "[", 
     RowBox[{"Px", ",", "Py", ",", "Pz"}], "]"}], ",", "Py"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.719344898430873*^9, 3.7193449279379253`*^9}, {
   3.719399079117301*^9, 3.719399081248616*^9}, {3.7193992682966213`*^9, 
   3.71939926925795*^9}, 3.823239402470324*^9},
 CellLabel->
  "In[143]:=",ExpressionUUID->"ab58dfda-9269-465d-86e8-c6b313f67158"],

Cell["\<\
2*a1*Py + 4*a11*Power(Py,3) + 6*a111*Power(Py,5) + 8*a1111*Power(Py,7) + \
2*a123*Power(Px,2)*Py*Power(Pz,2) + 
   a12*(2*Power(Px,2)*Py + 2*Py*Power(Pz,2)) + \
a1123*(2*Power(Px,4)*Py*Power(Pz,2) + 4*Power(Px,2)*Power(Py,3)*Power(Pz,2) + \

      2*Power(Px,2)*Py*Power(Pz,4)) + a1122*(4*Power(Px,4)*Power(Py,3) + \
4*Power(Py,3)*Power(Pz,4)) + 
   a1112*(2*Power(Px,6)*Py + 2*Py*Power(Pz,6) + 6*Power(Py,5)*(Power(Px,2) + \
Power(Pz,2))) + 
   a112*(4*Power(Px,2)*Power(Py,3) + 4*Power(Py,3)*Power(Pz,2) + \
2*Py*(Power(Px,4) + Power(Pz,4)))\
\>", "Output",
 CellChangeTimes->{{3.719344909315969*^9, 3.719344928588298*^9}, 
   3.719390801572729*^9, 3.7193953831155033`*^9, 3.719396583446691*^9, 
   3.7193990821362247`*^9, {3.719399269823392*^9, 3.719399276281871*^9}, 
   3.719557645397933*^9, 3.7221597203897943`*^9, 3.823239403212997*^9},
 CellLabel->
  "Out[143]//CForm=",ExpressionUUID->"2a7dd74c-5495-462a-b3c9-40b22ea857ca"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "           ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", 
    SubscriptBox["P", "z"]], TraditionalForm]],ExpressionUUID->
  "f697c6af-6ac1-4c90-a8ad-7b34b010389a"],
 ":"
}], "Subsubsection",
 CellChangeTimes->{{3.719344895805732*^9, 3.7193448961113577`*^9}, {
   3.719344931047133*^9, 3.719344931520187*^9}, {3.719390819056938*^9, 
   3.719390824622945*^9}, 3.719391445469548*^9, {3.7193944039344187`*^9, 
   3.719394407783208*^9}, {3.7195021198318567`*^9, 3.719502126235147*^9}, 
   3.8232394821143637`*^9, {3.823239513235464*^9, 
   3.823239515476005*^9}},ExpressionUUID->"b1314ec2-9f9d-432b-877a-\
df666fd6e745"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Fbulk", "[", 
     RowBox[{"Px", ",", "Py", ",", "Pz"}], "]"}], ",", "Pz"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.719344898430873*^9, 3.71934493373639*^9}, {
   3.71939908381222*^9, 3.719399084994329*^9}, {3.7193992727006607`*^9, 
   3.719399273533628*^9}, 3.82323947858064*^9},
 CellLabel->
  "In[144]:=",ExpressionUUID->"f06f6e0c-015a-4cdb-b540-33046f7b08a9"],

Cell["\<\
2*a1*Pz + 2*a123*Power(Px,2)*Power(Py,2)*Pz + 4*a11*Power(Pz,3) + \
6*a111*Power(Pz,5) + 8*a1111*Power(Pz,7) + 
   a12*(2*Power(Px,2)*Pz + 2*Power(Py,2)*Pz) + a112*(2*(Power(Px,4) + \
Power(Py,4))*Pz + 4*Power(Px,2)*Power(Pz,3) + 
      4*Power(Py,2)*Power(Pz,3)) + a1123*(2*Power(Px,4)*Power(Py,2)*Pz + \
2*Power(Px,2)*Power(Py,4)*Pz + 
      4*Power(Px,2)*Power(Py,2)*Power(Pz,3)) + \
a1122*(4*Power(Px,4)*Power(Pz,3) + 4*Power(Py,4)*Power(Pz,3)) + 
   a1112*(2*Power(Px,6)*Pz + 2*Power(Py,6)*Pz + 6*(Power(Px,2) + \
Power(Py,2))*Power(Pz,5))\
\>", "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.719344909315969*^9, 3.719344934489695*^9}, 
   3.719390802659061*^9, 3.7193953831532917`*^9, 3.719396583482215*^9, 
   3.719399085558289*^9, {3.7193992740357447`*^9, 3.719399277024528*^9}, 
   3.7195576454284477`*^9, 3.7221597217897587`*^9, 3.823239479293943*^9},
 CellLabel->
  "Out[144]//CForm=",ExpressionUUID->"4e43c2f6-e842-4762-89eb-5070ee210272"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["          On-diagonal jacobian statement:", "Subsection",
 CellChangeTimes->{{3.7193914088190393`*^9, 3.719391413701026*^9}, {
  3.719391820083192*^9, 3.719391820360261*^9}, {3.823239496700137*^9, 
  3.823239501432275*^9}},ExpressionUUID->"9afe1d61-662a-4d5c-8c0a-\
a6983253177d"],

Cell[CellGroupData[{

Cell[TextData[{
 "          ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["J", 
    RowBox[{
     SubscriptBox["P", "x"], ",", 
     SubscriptBox["P", "x"]}]], TraditionalForm]],ExpressionUUID->
  "2e677e35-a74a-47bc-916b-fa1954dffa2b"],
 "= ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["dR", 
     SubscriptBox["P", "x"]], "/", 
    SubscriptBox["dP", "x"]}], TraditionalForm]],ExpressionUUID->
  "4d924b80-4a3f-4cb4-a4ca-25704b1e21f1"],
 ":"
}], "Subsubsection",
 CellChangeTimes->{{3.7193914217248793`*^9, 3.719391441186262*^9}, 
   3.823239530753827*^9, 
   3.823239742535245*^9},ExpressionUUID->"4505be3b-3bd8-41c7-b4c5-\
3363b692cb68"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Fbulk", "[", 
       RowBox[{"Px", ",", "Py", ",", "Pz"}], "]"}], ",", "Px"}], "]"}], ",", 
    "Px"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719391458177603*^9, 3.719391467439415*^9}, 
   3.823239533668161*^9},
 CellLabel->
  "In[145]:=",ExpressionUUID->"e0230917-f2d5-4cfb-a28b-ac4a9bae5680"],

Cell["\<\
2*a1 + 12*a11*Power(Px,2) + 30*a111*Power(Px,4) + 56*a1111*Power(Px,6) + \
2*a123*Power(Py,2)*Power(Pz,2) + 
   a12*(2*Power(Py,2) + 2*Power(Pz,2)) + a1122*(12*Power(Px,2)*Power(Py,4) + \
12*Power(Px,2)*Power(Pz,4)) + 
   a1123*(12*Power(Px,2)*Power(Py,2)*Power(Pz,2) + 2*Power(Py,4)*Power(Pz,2) \
+ 2*Power(Py,2)*Power(Pz,4)) + 
   a1112*(2*Power(Py,6) + 2*Power(Pz,6) + 30*Power(Px,4)*(Power(Py,2) + \
Power(Pz,2))) + 
   a112*(12*Power(Px,2)*Power(Py,2) + 12*Power(Px,2)*Power(Pz,2) + \
2*(Power(Py,4) + Power(Pz,4)))\
\>", "Output",
 CellChangeTimes->{3.719391468467498*^9, 3.719395383180853*^9, 
  3.719396583518224*^9, 3.71955764545732*^9, 3.722159725174348*^9, 
  3.8232395340339108`*^9},
 CellLabel->
  "Out[145]//CForm=",ExpressionUUID->"e383a0d5-7aa4-4e4d-bf51-8bf23d9808eb"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "          ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["J", 
    RowBox[{
     SubscriptBox["P", "y"], ",", 
     SubscriptBox["P", "y"]}]], TraditionalForm]],ExpressionUUID->
  "6b79581b-b0ce-4694-8eef-0e17daea3184"],
 "= ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["dR", 
     SubscriptBox["P", "y"]], "/", 
    SubscriptBox["dP", "y"]}], TraditionalForm]],ExpressionUUID->
  "0aae1893-c909-4dca-8c49-053f78d5e106"],
 ":"
}], "Subsubsection",
 CellChangeTimes->{{3.7193914217248793`*^9, 3.719391441186262*^9}, {
  3.7193914824540043`*^9, 3.7193914894877853`*^9}, {3.823239573186942*^9, 
  3.823239578626631*^9}},ExpressionUUID->"ffd155c3-048c-41d9-aaac-\
e15add921e00"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Fbulk", "[", 
       RowBox[{"Px", ",", "Py", ",", "Pz"}], "]"}], ",", "Py"}], "]"}], ",", 
    "Py"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719391458177603*^9, 3.719391467439415*^9}, {
   3.7193914996756496`*^9, 3.7193915008775997`*^9}, 
   3.8232396331298018`*^9},ExpressionUUID->"ded3ef6b-8df4-42d7-9a82-\
5144f68c5b8a"],

Cell["\<\
2*a1 + 12*a11*Power(Py,2) + 30*a111*Power(Py,4) + 56*a1111*Power(Py,6) + 
   2*a123*Power(Px,2)*Power(Pz,2) + a12*(2*Power(Px,2) + 2*Power(Pz,2)) + 
   a1123*(2*Power(Px,4)*Power(Pz,2) + 12*Power(Px,2)*Power(Py,2)*Power(Pz,2) + 
      2*Power(Px,2)*Power(Pz,4)) + 
   a1122*(12*Power(Px,4)*Power(Py,2) + 12*Power(Py,2)*Power(Pz,4)) + 
   a112*(2*Power(Px,4) + 2*Power(Pz,4) + 
      12*Power(Py,2)*(Power(Px,2) + Power(Pz,2))) + 
   a1112*(2*Power(Px,6) + 2*Power(Pz,6) + 
      30*Power(Py,4)*(Power(Px,2) + Power(Pz,2)))\
\>", "Output",
 CellChangeTimes->{3.719391468467498*^9, 3.7193915055046577`*^9, 
  3.719395383208479*^9, 3.719396583554174*^9, 3.719557645486816*^9, 
  3.722159726095756*^9},ExpressionUUID->"a9a2bf6b-ea63-49d2-8337-\
b07210833c6c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "          ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["J", 
    RowBox[{
     SubscriptBox["P", "z"], ",", 
     SubscriptBox["P", "z"]}]], TraditionalForm]],ExpressionUUID->
  "7479da2a-d7a2-4b10-8dc5-674d207113eb"],
 "= ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["dR", 
     SubscriptBox["P", "z"]], "/", 
    SubscriptBox["dP", "z"]}], TraditionalForm]],ExpressionUUID->
  "c17479d2-3fcb-4ddb-aa0f-bba0b65721e3"],
 ":"
}], "Subsubsection",
 CellChangeTimes->{{3.7193914217248793`*^9, 3.719391441186262*^9}, {
   3.719391491483211*^9, 3.719391496921672*^9}, 
   3.823239719900621*^9},ExpressionUUID->"e3664456-3118-4d54-abbf-\
9a0b5f3bf633"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Fbulk", "[", 
       RowBox[{"Px", ",", "Py", ",", "Pz"}], "]"}], ",", "Pz"}], "]"}], ",", 
    "Pz"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719391458177603*^9, 3.719391467439415*^9}, {
   3.719391502954088*^9, 3.719391504258813*^9}, 3.823239722831827*^9},
 CellLabel->
  "In[146]:=",ExpressionUUID->"c7a474a3-9259-421c-9c04-1f8476dc8ae5"],

Cell["\<\
2*a1 + 2*a123*Power(Px,2)*Power(Py,2) + a12*(2*Power(Px,2) + 2*Power(Py,2)) + \
12*a11*Power(Pz,2) + 30*a111*Power(Pz,4) + 
   56*a1111*Power(Pz,6) + a112*(2*(Power(Px,4) + Power(Py,4)) + \
12*Power(Px,2)*Power(Pz,2) + 12*Power(Py,2)*Power(Pz,2)) + 
   a1123*(2*Power(Px,4)*Power(Py,2) + 2*Power(Px,2)*Power(Py,4) + \
12*Power(Px,2)*Power(Py,2)*Power(Pz,2)) + 
   a1122*(12*Power(Px,4)*Power(Pz,2) + 12*Power(Py,4)*Power(Pz,2)) + 
   a1112*(2*Power(Px,6) + 2*Power(Py,6) + 30*(Power(Px,2) + \
Power(Py,2))*Power(Pz,4))\
\>", "Output",
 CellChangeTimes->{3.719391468467498*^9, 3.719391506179204*^9, 
  3.7193953832380238`*^9, 3.719396583592355*^9, 3.719557645515294*^9, 
  3.722159727250704*^9, 3.8232397233646107`*^9},
 CellLabel->
  "Out[146]//CForm=",ExpressionUUID->"283d6ae1-f56d-46fc-8097-40d0666946cf"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["          Off-diagonal jacobian statements:", "Subsection",
 CellChangeTimes->{{3.7193915280629807`*^9, 3.7193915323285637`*^9}, {
  3.7193918214241343`*^9, 3.719391821697309*^9}, {3.82323993898482*^9, 
  3.823239941282403*^9}},ExpressionUUID->"8ce3d775-e747-4f3a-8df5-\
30944464e99f"],

Cell[CellGroupData[{

Cell[TextData[{
 "          ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["J", 
    RowBox[{
     SubscriptBox["P", "x"], ",", 
     SubscriptBox["P", "y"]}]], TraditionalForm]],ExpressionUUID->
  "065e180a-8b23-434f-884c-51255236369e"],
 "= ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["dR", 
     SubscriptBox["P", "x"]], "/", 
    SubscriptBox["dP", "y"]}], TraditionalForm]],ExpressionUUID->
  "b3762c73-da9c-4afe-920d-b7eadeb0e0a7"],
 ":"
}], "Subsubsection",
 CellChangeTimes->{{3.7193914217248793`*^9, 3.719391441186262*^9}, {
   3.719391539403122*^9, 3.7193915420574617`*^9}, {3.719396600311574*^9, 
   3.719396606299691*^9}, 3.8232399445773077`*^9, {3.823240201816114*^9, 
   3.823240207237297*^9}},ExpressionUUID->"9a8e343a-470b-4396-8de7-\
e0a19cd054ef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Fbulk", "[", 
       RowBox[{"Px", ",", "Py", ",", "Pz"}], "]"}], ",", "Px"}], "]"}], ",", 
    "Py"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719391458177603*^9, 3.719391467439415*^9}, {
   3.719391543058577*^9, 3.719391543719152*^9}, 3.823239947091607*^9},
 CellLabel->
  "In[148]:=",ExpressionUUID->"3c6911be-de45-499f-8d2f-bebfb7575079"],

Cell["\<\
4*a12*Px*Py + 16*a1122*Power(Px,3)*Power(Py,3) + a112*(8*Power(Px,3)*Py + \
8*Px*Power(Py,3)) + 
   a1112*(12*Power(Px,5)*Py + 12*Px*Power(Py,5)) + 4*a123*Px*Py*Power(Pz,2) + \

   a1123*(8*Power(Px,3)*Py*Power(Pz,2) + 8*Px*Power(Py,3)*Power(Pz,2) + \
4*Px*Py*Power(Pz,4))\
\>", "Output",
 CellChangeTimes->{3.719391468467498*^9, 3.7193915444117613`*^9, 
  3.719395383265767*^9, 3.7193965836262407`*^9, 3.7195576455197372`*^9, 
  3.722159730670532*^9, 3.8232399519948053`*^9},
 CellLabel->
  "Out[148]//CForm=",ExpressionUUID->"e3bfe523-97ff-4359-8230-9c1de4508c34"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "          ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["J", 
    RowBox[{
     SubscriptBox["P", "x"], ",", 
     SubscriptBox["P", "z"]}]], TraditionalForm]],ExpressionUUID->
  "b78590df-c645-45e6-9e20-1b0d8d7f1e3b"],
 "= ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["dR", 
     SubscriptBox["P", "x"]], "/", 
    SubscriptBox["dP", "z"]}], TraditionalForm]],ExpressionUUID->
  "67463f66-6a3c-4142-8138-04febe6514bd"],
 ":"
}], "Subsubsection",
 CellChangeTimes->{{3.7193914217248793`*^9, 3.719391441186262*^9}, {
   3.719391539403122*^9, 3.71939155248563*^9}, 
   3.82324018897101*^9},ExpressionUUID->"b637d4ce-fe76-4349-96b2-\
4692d281af1a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Fbulk", "[", 
       RowBox[{"Px", ",", "Py", ",", "Pz"}], "]"}], ",", "Px"}], "]"}], ",", 
    "Pz"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719391458177603*^9, 3.719391467439415*^9}, {
   3.719391543058577*^9, 3.7193915553331003`*^9}, 3.823240190198681*^9},
 CellLabel->
  "In[149]:=",ExpressionUUID->"eab84467-0486-4fba-822b-edf82f2e1981"],

Cell["\<\
4*a12*Px*Pz + 4*a123*Px*Power(Py,2)*Pz + 16*a1122*Power(Px,3)*Power(Pz,3) + \
a112*(8*Power(Px,3)*Pz + 8*Px*Power(Pz,3)) + 
   a1123*(8*Power(Px,3)*Power(Py,2)*Pz + 4*Px*Power(Py,4)*Pz + \
8*Px*Power(Py,2)*Power(Pz,3)) + 
   a1112*(12*Power(Px,5)*Pz + 12*Px*Power(Pz,5))\
\>", "Output",
 CellChangeTimes->{
  3.719391468467498*^9, {3.7193915444117613`*^9, 3.7193915557824707`*^9}, 
   3.719395383293231*^9, 3.719396583656081*^9, 3.7195576455488443`*^9, 
   3.7221597315645523`*^9, 3.82324019050441*^9},
 CellLabel->
  "Out[149]//CForm=",ExpressionUUID->"2e626022-9bf6-4766-ba82-19c7949c6da3"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "         ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["J", 
    RowBox[{
     SubscriptBox["P", "y"], ",", 
     SubscriptBox["P", "x"]}]], TraditionalForm]],ExpressionUUID->
  "289ac6a8-ce5d-4015-8aad-44a0b5af867b"],
 "= ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["dR", 
     SubscriptBox["P", "y"]], "/", 
    SubscriptBox["dP", "x"]}], TraditionalForm]],ExpressionUUID->
  "9fa810e5-623e-4942-a234-38cea52a2b80"],
 ":"
}], "Subsubsection",
 CellChangeTimes->{{3.7193914217248793`*^9, 3.719391441186262*^9}, {
  3.719391539403122*^9, 3.7193915420574617`*^9}, {3.71939168120548*^9, 
  3.719391689538424*^9}, {3.823240211773122*^9, 
  3.8232402148465548`*^9}},ExpressionUUID->"c54c1a3b-b43a-4f70-bff5-\
b8178abdf411"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Fbulk", "[", 
       RowBox[{"Px", ",", "Py", ",", "Pz"}], "]"}], ",", "Py"}], "]"}], ",", 
    "Px"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719391458177603*^9, 3.719391467439415*^9}, {
   3.719391543058577*^9, 3.719391543719152*^9}, {3.719391698585593*^9, 
   3.719391701434827*^9}, 3.823240218493505*^9},
 CellLabel->
  "In[150]:=",ExpressionUUID->"4d66ed84-93b9-4fbe-a3b1-98c9c0a5718e"],

Cell["\<\
4*a12*Px*Py + 16*a1122*Power(Px,3)*Power(Py,3) + a112*(8*Power(Px,3)*Py + \
8*Px*Power(Py,3)) + 
   a1112*(12*Power(Px,5)*Py + 12*Px*Power(Py,5)) + 4*a123*Px*Py*Power(Pz,2) + \

   a1123*(8*Power(Px,3)*Py*Power(Pz,2) + 8*Px*Power(Py,3)*Power(Pz,2) + \
4*Px*Py*Power(Pz,4))\
\>", "Output",
 CellChangeTimes->{3.719391468467498*^9, 3.7193915444117613`*^9, 
  3.719391707178925*^9, 3.71939538332166*^9, 3.7193965836861763`*^9, 
  3.719557645578899*^9, 3.722159732570348*^9, 3.823240218909775*^9},
 CellLabel->
  "Out[150]//CForm=",ExpressionUUID->"6bc0890e-6da8-4ade-93aa-03b356ea18c3"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "         ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["J", 
    RowBox[{
     SubscriptBox["P", "y"], ",", 
     SubscriptBox["P", "z"]}]], TraditionalForm]],ExpressionUUID->
  "01da97c9-47c0-4ebd-a2d1-21605ff19622"],
 "= ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["dR", 
     SubscriptBox["P", "y"]], "/", 
    SubscriptBox["dP", "z"]}], TraditionalForm]],ExpressionUUID->
  "8aaddaee-d78f-4420-8d47-2ae811b042a0"],
 ":"
}], "Subsubsection",
 CellChangeTimes->{{3.7193914217248793`*^9, 3.719391441186262*^9}, {
   3.719391539403122*^9, 3.7193915420574617`*^9}, {3.71939168120548*^9, 
   3.719391697491914*^9}, 
   3.8232402268051577`*^9},ExpressionUUID->"ed122b42-013b-4b5e-91f1-\
30f1a14c5ec4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Fbulk", "[", 
       RowBox[{"Px", ",", "Py", ",", "Pz"}], "]"}], ",", "Py"}], "]"}], ",", 
    "Pz"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719391458177603*^9, 3.719391467439415*^9}, {
   3.719391543058577*^9, 3.719391543719152*^9}, {3.719391703599654*^9, 
   3.719391705961341*^9}, 3.823240228733245*^9},
 CellLabel->
  "In[152]:=",ExpressionUUID->"7bdf3f29-3f22-4a97-83fa-299a52297e92"],

Cell["\<\
4*a12*Py*Pz + 4*a123*Power(Px,2)*Py*Pz + 16*a1122*Power(Py,3)*Power(Pz,3) + \
a112*(8*Power(Py,3)*Pz + 8*Py*Power(Pz,3)) + 
   a1123*(4*Power(Px,4)*Py*Pz + 8*Power(Px,2)*Power(Py,3)*Pz + \
8*Power(Px,2)*Py*Power(Pz,3)) + 
   a1112*(12*Power(Py,5)*Pz + 12*Py*Power(Pz,5))\
\>", "Output",
 CellChangeTimes->{3.719391468467498*^9, 3.7193915444117613`*^9, 
  3.719391708242474*^9, 3.719395383349585*^9, 3.719396583717783*^9, 
  3.719557645609716*^9, 3.7221597336615973`*^9, 3.823240229105752*^9, 
  3.823240343708748*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "Out[152]//CForm=",ExpressionUUID->"ccaf564b-d455-4559-aecd-2af4d9cf9f00"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "         ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["J", 
    RowBox[{
     SubscriptBox["P", "z"], ",", 
     SubscriptBox["P", "x"]}]], TraditionalForm]],ExpressionUUID->
  "14e1f826-4aa4-4552-a842-836d14244243"],
 "= ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["dR", 
     SubscriptBox["P", "z"]], "/", 
    SubscriptBox["dP", "x"]}], TraditionalForm]],ExpressionUUID->
  "618fca56-22fb-4a37-ab17-000a34a3e6c5"],
 ":"
}], "Subsubsection",
 CellChangeTimes->{{3.7193914217248793`*^9, 3.719391441186262*^9}, {
   3.719391539403122*^9, 3.7193915420574617`*^9}, {3.71939168120548*^9, 
   3.719391738319785*^9}, 
   3.823240356505415*^9},ExpressionUUID->"c4e219cd-c6f3-451b-a7ff-\
e64bcf226757"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Fbulk", "[", 
       RowBox[{"Px", ",", "Py", ",", "Pz"}], "]"}], ",", "Pz"}], "]"}], ",", 
    "Px"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719391458177603*^9, 3.719391467439415*^9}, {
   3.719391543058577*^9, 3.719391543719152*^9}, {3.719391703599654*^9, 
   3.71939172438769*^9}, 3.8232403594911327`*^9},
 CellLabel->
  "In[153]:=",ExpressionUUID->"fe779fef-06be-4177-bd08-09bf23d561f7"],

Cell["\<\
4*a12*Px*Pz + 4*a123*Px*Power(Py,2)*Pz + 16*a1122*Power(Px,3)*Power(Pz,3) + \
a112*(8*Power(Px,3)*Pz + 8*Px*Power(Pz,3)) + 
   a1123*(8*Power(Px,3)*Power(Py,2)*Pz + 4*Px*Power(Py,4)*Pz + \
8*Px*Power(Py,2)*Power(Pz,3)) + 
   a1112*(12*Power(Px,5)*Pz + 12*Px*Power(Pz,5))\
\>", "Output",
 CellChangeTimes->{3.719391468467498*^9, 3.7193915444117613`*^9, 
  3.719391708242474*^9, 3.719391739128748*^9, 3.719395383377046*^9, 
  3.719396583752777*^9, 3.719557645638362*^9, 3.722159734683291*^9, 
  3.823240359807686*^9},
 CellLabel->
  "Out[153]//CForm=",ExpressionUUID->"746d8209-87ac-497f-8b1d-d6423aecd3c4"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "         ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["J", 
    RowBox[{
     SubscriptBox["P", "z"], ",", 
     SubscriptBox["P", "y"]}]], TraditionalForm]],ExpressionUUID->
  "b6bb5a2b-1dec-4004-8c19-31bd56024fe3"],
 "= ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["dR", 
     SubscriptBox["P", "z"]], "/", 
    SubscriptBox["dP", "y"]}], TraditionalForm]],ExpressionUUID->
  "8ff75e62-ca2b-4163-8943-6a4060cfc028"],
 ":"
}], "Subsubsection",
 CellChangeTimes->{{3.7193914217248793`*^9, 3.719391441186262*^9}, {
   3.719391539403122*^9, 3.7193915420574617`*^9}, {3.71939168120548*^9, 
   3.719391736419343*^9}, 
   3.823240371311267*^9},ExpressionUUID->"9aaf14cb-8f56-4150-8ee1-\
95b4c007f3cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Fbulk", "[", 
       RowBox[{"Px", ",", "Py", ",", "Pz"}], "]"}], ",", "Pz"}], "]"}], ",", 
    "Py"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719391458177603*^9, 3.719391467439415*^9}, {
   3.719391543058577*^9, 3.719391543719152*^9}, {3.719391703599654*^9, 
   3.719391742022808*^9}, 3.823240373218753*^9},
 CellLabel->
  "In[154]:=",ExpressionUUID->"18e137cf-172c-4ba1-9ff3-c8a65c36d186"],

Cell["\<\
4*a12*Py*Pz + 4*a123*Power(Px,2)*Py*Pz + 16*a1122*Power(Py,3)*Power(Pz,3) + \
a112*(8*Power(Py,3)*Pz + 8*Py*Power(Pz,3)) + 
   a1123*(4*Power(Px,4)*Py*Pz + 8*Power(Px,2)*Power(Py,3)*Pz + \
8*Power(Px,2)*Py*Power(Pz,3)) + 
   a1112*(12*Power(Py,5)*Pz + 12*Py*Power(Pz,5))\
\>", "Output",
 CellChangeTimes->{3.719391468467498*^9, 3.7193915444117613`*^9, 
  3.719391708242474*^9, 3.719391743446622*^9, 3.719395383405208*^9, 
  3.719396583784144*^9, 3.7195576456669607`*^9, 3.722159735828678*^9, 
  3.823240373546489*^9},
 CellLabel->
  "Out[154]//CForm=",ExpressionUUID->"983e4e7b-198d-49b2-b5cb-a64d1664111f"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "        Kernel for electrostriction ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    FractionBox[
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["F", "electrostrictive"]}], 
     RowBox[{"\[Delta]", " ", 
      StyleBox["P",
       FontWeight->"Bold"]}]], "]"}], TraditionalForm]],ExpressionUUID->
  "70a5f532-2d47-486f-8b16-a157a5609835"]
}], "Section",
 CellChangeTimes->{{3.8232403903299637`*^9, 
  3.823240421925502*^9}},ExpressionUUID->"c1f7c731-ef58-4e7e-932e-\
5e88dd6ef941"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Require", " ", "derivatives", " ", "of", " ", "the", " ", "form"}],
   "\n"}], "\n", 
 RowBox[{"                             ", 
  RowBox[{
   RowBox[{
    FormBox[
     SubscriptBox["R", 
      SubscriptBox["A", "k"]],
     TraditionalForm], " ", "=", " ", 
    FormBox[
     FractionBox[
      RowBox[{"d", " ", "F"}], 
      RowBox[{"d", " ", 
       SubscriptBox["A", "k"]}]],
     TraditionalForm]}], " ", ",", " ", 
   RowBox[{
    FormBox[
     SubscriptBox["J", 
      RowBox[{
       SubscriptBox["A", "k"], ",", " ", 
       SubscriptBox["A", "j"]}]],
     TraditionalForm], " ", "=", " ", 
    RowBox[{
     RowBox[{
      FormBox[
       FractionBox[
        SubscriptBox["dR", 
         SubscriptBox["A", "k"]], 
        SubscriptBox["dA", "j"]],
       TraditionalForm], " ", "and", " ", "off", " ", "diag", "  ", 
      FormBox[
       SubscriptBox["J", 
        RowBox[{
         SubscriptBox["A", "k"], ",", " ", 
         SubscriptBox["u", "j"]}]],
       TraditionalForm]}], " ", "=", " ", 
     RowBox[{
      FormBox[
       FractionBox[
        SubscriptBox["dR", 
         SubscriptBox["A", "k"]], 
        SubscriptBox["du", "j"]],
       TraditionalForm], "  ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"also", " ", "the", " ", "cross"}], "-", 
        RowBox[{
        "coupling", " ", "with", " ", "mechanical", " ", "equilibrium"}]}], 
       ")"}]}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8232406133237658`*^9, 
  3.82324061332528*^9}},ExpressionUUID->"a51fd80b-04a2-442b-b7f1-\
ace983aeccf5"],

Cell[CellGroupData[{

Cell["Residual statements:", "Subsection",
 CellChangeTimes->{{3.7195611104143467`*^9, 
  3.719561112583774*^9}},ExpressionUUID->"a7dd7750-6311-4867-aa10-\
43f054e66544"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubscriptBox["R", 
   SubscriptBox["A", "x"]], 
  TraditionalForm]],ExpressionUUID->"e20ffb2a-583c-4f57-8f6f-40c6fd2e295e"]], \
"Subsubsection",
 CellChangeTimes->{{3.719560971460051*^9, 3.719560973411968*^9}, {
  3.719561025081622*^9, 
  3.719561025773044*^9}},ExpressionUUID->"d4aff862-219f-4679-b741-\
b7ccf931504a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"dispFrotostrictive", "[", 
     RowBox[{
     "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
      "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
     "]"}], ",", "Ax"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719560987533332*^9, 3.719560992162322*^9}, {
   3.719561028924584*^9, 3.719561032505021*^9}, {3.719561062600532*^9, 
   3.7195610735431833`*^9}, 3.7195616023262177`*^9, {3.719562003654649*^9, 
   3.7195620148596563`*^9}},ExpressionUUID->"d7c04ebb-e8e0-41b4-9c0c-\
15a079769885"],

Cell["\<\
-2*Ax*r11*uxx - r44*((Ay*(uxy + uyx))/2. + (Az*(uxz + uzx))/2.) - 
   r12*(2*Ax*uyy + 2*Ax*uzz)\
\>", "Output",
 CellChangeTimes->{3.7195610740122766`*^9, 3.719562015645938*^9, 
  3.722155751314124*^9},ExpressionUUID->"d3a7341d-68b8-403e-852a-\
4ecfba2aba37"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubscriptBox["R", 
   SubscriptBox["A", "y"]], 
  TraditionalForm]],ExpressionUUID->"5f6f855b-542a-46ff-817b-84e4af68ac12"]], \
"Subsubsection",
 CellChangeTimes->{{3.719560971460051*^9, 3.719560973411968*^9}, {
  3.719561025081622*^9, 3.719561025773044*^9}, {3.7195610887965317`*^9, 
  3.719561089176849*^9}},ExpressionUUID->"04dc4e53-ce15-4fcb-a5ea-\
b8d1df948faa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"dispFrotostrictive", "[", 
     RowBox[{
     "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
      "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
     "]"}], ",", "Ay"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719560987533332*^9, 3.719560992162322*^9}, {
  3.719561028924584*^9, 3.719561032505021*^9}, {3.719561062600532*^9, 
  3.7195610915025167`*^9}, {3.719562019590331*^9, 
  3.719562022264175*^9}},ExpressionUUID->"ac485218-b86a-4a7d-ac46-\
33dec92d9a85"],

Cell["\<\
-2*Ay*r11*uyy - r44*((Ax*(uxy + uyx))/2. + (Az*(uyz + uzy))/2.) - 
   r12*(2*Ay*uxx + 2*Ay*uzz)\
\>", "Output",
 CellChangeTimes->{{3.7195610740122766`*^9, 3.719561092281418*^9}, 
   3.719562025471016*^9, 
   3.722155754191804*^9},ExpressionUUID->"92e9242b-81c4-4f81-b082-\
6759728ad411"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubscriptBox["R", 
   SubscriptBox["A", "z"]], 
  TraditionalForm]],ExpressionUUID->"0a12fc00-784f-4878-8220-cf4f8c7e2dbc"]], \
"Subsubsection",
 CellChangeTimes->{{3.719560971460051*^9, 3.719560973411968*^9}, {
  3.719561025081622*^9, 3.719561025773044*^9}, {3.7195610887965317`*^9, 
  3.719561098466145*^9}},ExpressionUUID->"0f43ff8a-b8f1-41a4-8688-\
d34b088bf9d6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"dispFrotostrictive", "[", 
     RowBox[{
     "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
      "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
     "]"}], ",", "Az"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719560987533332*^9, 3.719560992162322*^9}, {
  3.719561028924584*^9, 3.719561032505021*^9}, {3.719561062600532*^9, 
  3.7195611004754477`*^9}, {3.7195620207158537`*^9, 
  3.719562023736655*^9}},ExpressionUUID->"43247143-cbab-4080-924e-\
3256caeb8377"],

Cell["\<\
-(r12*(2*Az*uxx + 2*Az*uyy)) - r44*((Ax*(uxz + uzx))/2. + (Ay*(uyz + \
uzy))/2.) - 
   2*Az*r11*uzz\
\>", "Output",
 CellChangeTimes->{{3.7195610740122766`*^9, 3.71956110090487*^9}, 
   3.7195620240190973`*^9, 
   3.722155755616394*^9},ExpressionUUID->"ffd770ef-ec68-4d5c-97d0-\
3ab887c73a86"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Residual statements:", "Subsection",
 CellChangeTimes->{{3.7195611104143467`*^9, 
  3.719561112583774*^9}},ExpressionUUID->"faa20aa3-2989-42c6-948f-\
9abd25dde0c8"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubscriptBox["R", 
   SubscriptBox["A", "x"]], 
  TraditionalForm]],ExpressionUUID->"26d76c60-4e26-4592-9b56-f8b812dc7a27"]], \
"Subsubsection",
 CellChangeTimes->{{3.719560971460051*^9, 3.719560973411968*^9}, {
  3.719561025081622*^9, 
  3.719561025773044*^9}},ExpressionUUID->"6ddf2390-af86-4640-952d-\
4236c622af62"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"dispFrotostrictive", "[", 
     RowBox[{
     "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
      "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
     "]"}], ",", "Ax"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719560987533332*^9, 3.719560992162322*^9}, {
   3.719561028924584*^9, 3.719561032505021*^9}, {3.719561062600532*^9, 
   3.7195610735431833`*^9}, 3.7195616023262177`*^9, {3.719562003654649*^9, 
   3.7195620148596563`*^9}},ExpressionUUID->"05a6e1d5-76c8-42b4-b700-\
cbfae45abded"],

Cell["\<\
-2*Ax*r11*uxx - r44*((Ay*(uxy + uyx))/2. + (Az*(uxz + uzx))/2.) - 
   r12*(2*Ax*uyy + 2*Ax*uzz)\
\>", "Output",
 CellChangeTimes->{3.7195610740122766`*^9, 3.719562015645938*^9, 
  3.722155751314124*^9},ExpressionUUID->"89dd1d84-9032-4734-8699-\
b3b4b7532e87"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubscriptBox["R", 
   SubscriptBox["A", "y"]], 
  TraditionalForm]],ExpressionUUID->"fcb568e7-f20c-441a-8a8f-f7f1865edfd8"]], \
"Subsubsection",
 CellChangeTimes->{{3.719560971460051*^9, 3.719560973411968*^9}, {
  3.719561025081622*^9, 3.719561025773044*^9}, {3.7195610887965317`*^9, 
  3.719561089176849*^9}},ExpressionUUID->"0ba20fee-fdb1-4f69-acf5-\
3e6dc6f09aaa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"dispFrotostrictive", "[", 
     RowBox[{
     "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
      "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
     "]"}], ",", "Ay"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719560987533332*^9, 3.719560992162322*^9}, {
  3.719561028924584*^9, 3.719561032505021*^9}, {3.719561062600532*^9, 
  3.7195610915025167`*^9}, {3.719562019590331*^9, 
  3.719562022264175*^9}},ExpressionUUID->"c54a3e73-227c-45e5-b6cb-\
1390423eed77"],

Cell["\<\
-2*Ay*r11*uyy - r44*((Ax*(uxy + uyx))/2. + (Az*(uyz + uzy))/2.) - 
   r12*(2*Ay*uxx + 2*Ay*uzz)\
\>", "Output",
 CellChangeTimes->{{3.7195610740122766`*^9, 3.719561092281418*^9}, 
   3.719562025471016*^9, 
   3.722155754191804*^9},ExpressionUUID->"98a0183f-76ad-49c4-b6f4-\
945e030368d1"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubscriptBox["R", 
   SubscriptBox["A", "z"]], 
  TraditionalForm]],ExpressionUUID->"beb225c5-f875-48d6-a9ad-25a5016aab0e"]], \
"Subsubsection",
 CellChangeTimes->{{3.719560971460051*^9, 3.719560973411968*^9}, {
  3.719561025081622*^9, 3.719561025773044*^9}, {3.7195610887965317`*^9, 
  3.719561098466145*^9}},ExpressionUUID->"e56431a9-23ae-4fbe-8f1b-\
b1d03d0bafb2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"dispFrotostrictive", "[", 
     RowBox[{
     "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
      "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
     "]"}], ",", "Az"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719560987533332*^9, 3.719560992162322*^9}, {
  3.719561028924584*^9, 3.719561032505021*^9}, {3.719561062600532*^9, 
  3.7195611004754477`*^9}, {3.7195620207158537`*^9, 
  3.719562023736655*^9}},ExpressionUUID->"a7a1a5c7-4a52-41c2-870c-\
9c15d6421cc6"],

Cell["\<\
-(r12*(2*Az*uxx + 2*Az*uyy)) - r44*((Ax*(uxz + uzx))/2. + (Ay*(uyz + \
uzy))/2.) - 
   2*Az*r11*uzz\
\>", "Output",
 CellChangeTimes->{{3.7195610740122766`*^9, 3.71956110090487*^9}, 
   3.7195620240190973`*^9, 
   3.722155755616394*^9},ExpressionUUID->"79952b7e-1fdf-4ab7-a5c9-\
cc0d85f0fdae"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["On-diagonal jacobians:", "Subsection",
 CellChangeTimes->{{3.7195611163545513`*^9, 
  3.7195611186195927`*^9}},ExpressionUUID->"e6bd844e-c2da-4c77-90a4-\
59afa85e78fe"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["J", 
    RowBox[{
     SubscriptBox["A", "x"], ",", " ", 
     SubscriptBox["A", "x"]}]], "=", " ", 
   FractionBox[
    RowBox[{"d", " ", 
     SubscriptBox["R", 
      SubscriptBox["A", "x"]]}], 
    RowBox[{"d", " ", 
     SubscriptBox["A", "x"]}]]}], 
  TraditionalForm]],ExpressionUUID->"b02ac5ab-1a2f-4c84-8efc-5f44f13dd10c"]], \
"Subsubsection",
 CellChangeTimes->{{3.719560971460051*^9, 3.719560973411968*^9}, {
  3.719561025081622*^9, 3.719561025773044*^9}, {3.719561127347425*^9, 
  3.719561147748179*^9}},ExpressionUUID->"7f2ebf36-8005-4bdc-bb5b-\
ccfa82b06144"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dispFrotostrictive", "[", 
       RowBox[{
       "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
        "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
       "]"}], ",", "Ax"}], "]"}], ",", "Ax"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719560987533332*^9, 3.719560992162322*^9}, {
   3.719561028924584*^9, 3.719561032505021*^9}, {3.719561062600532*^9, 
   3.7195610735431833`*^9}, {3.719561149858275*^9, 3.7195611522390547`*^9}, {
   3.719561494777814*^9, 3.719561613448691*^9}, 
   3.719562090539543*^9},ExpressionUUID->"ebb96ae4-9649-4999-89ff-\
07fd679549b4"],

Cell["-2*r11*uxx - r12*(2*uyy + 2*uzz)", "Output",
 CellChangeTimes->{3.7195615901567593`*^9, 3.719562101550708*^9, 
  3.722155763373938*^9},ExpressionUUID->"c61a8c8e-832f-4f7f-a381-\
cfb2652b92ee"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["J", 
    RowBox[{
     SubscriptBox["A", "y"], ",", " ", 
     SubscriptBox["A", "y"]}]], "=", " ", 
   FractionBox[
    RowBox[{"d", " ", 
     SubscriptBox["R", 
      SubscriptBox["A", "y"]]}], 
    RowBox[{"d", " ", 
     SubscriptBox["A", "y"]}]]}], 
  TraditionalForm]],ExpressionUUID->"1bb3104d-b01e-4b65-a3e0-3d8df70b4866"]], \
"Subsubsection",
 CellChangeTimes->{{3.719560971460051*^9, 3.719560973411968*^9}, {
  3.719561025081622*^9, 3.719561025773044*^9}, {3.719561127347425*^9, 
  3.719561147748179*^9}, {3.719561222131082*^9, 
  3.719561226529119*^9}},ExpressionUUID->"32e24dbc-e354-4a9c-bea2-\
7949af6f78d9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dispFrotostrictive", "[", 
       RowBox[{
       "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
        "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
       "]"}], ",", "Ay"}], "]"}], ",", "Ay"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719560987533332*^9, 3.719560992162322*^9}, {
  3.719561028924584*^9, 3.719561032505021*^9}, {3.719561062600532*^9, 
  3.7195610735431833`*^9}, {3.719561149858275*^9, 3.7195611522390547`*^9}, {
  3.7195612646487226`*^9, 3.719561265913286*^9}, {3.719562093807145*^9, 
  3.719562097677862*^9}},ExpressionUUID->"54e9db65-fc9f-48de-a255-\
e957b233c703"],

Cell["-2*r11*uyy - r12*(2*uxx + 2*uzz)", "Output",
 CellChangeTimes->{3.7195610740122766`*^9, 3.719561152647622*^9, 
  3.719561266211257*^9, 3.719562100526889*^9, 
  3.722155764898725*^9},ExpressionUUID->"ffee83bb-6c86-44c7-b3fd-\
b0d58fcbe9ea"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["J", 
    RowBox[{
     SubscriptBox["A", "z"], ",", " ", 
     SubscriptBox["A", "z"]}]], "=", " ", 
   FractionBox[
    RowBox[{"d", " ", 
     SubscriptBox["R", 
      SubscriptBox["A", "z"]]}], 
    RowBox[{"d", " ", 
     SubscriptBox["A", "z"]}]]}], 
  TraditionalForm]],ExpressionUUID->"5165df49-549b-47b0-a6c4-540bb05fbd73"]], \
"Subsubsection",
 CellChangeTimes->{{3.719560971460051*^9, 3.719560973411968*^9}, {
  3.719561025081622*^9, 3.719561025773044*^9}, {3.719561127347425*^9, 
  3.719561147748179*^9}, {3.719561222131082*^9, 3.719561226529119*^9}, {
  3.719561271066511*^9, 
  3.719561277360305*^9}},ExpressionUUID->"fe50e87a-fd7d-4f18-a8bd-\
e6a3b114b251"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dispFrotostrictive", "[", 
       RowBox[{
       "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
        "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
       "]"}], ",", "Az"}], "]"}], ",", "Az"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719560987533332*^9, 3.719560992162322*^9}, {
  3.719561028924584*^9, 3.719561032505021*^9}, {3.719561062600532*^9, 
  3.7195610735431833`*^9}, {3.719561149858275*^9, 3.7195611522390547`*^9}, {
  3.7195612646487226`*^9, 3.7195612807323227`*^9}, {3.719562095722924*^9, 
  3.71956209913842*^9}},ExpressionUUID->"25453c10-156f-47bb-ae77-\
6dd40f416df4"],

Cell["-(r12*(2*uxx + 2*uyy)) - 2*r11*uzz", "Output",
 CellChangeTimes->{
  3.7195610740122766`*^9, 3.719561152647622*^9, {3.719561266211257*^9, 
   3.7195612810572166`*^9}, 3.719562099567336*^9, 
   3.722155765969492*^9},ExpressionUUID->"5cae6058-1a98-4481-a6d0-\
0e05558665c7"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Off-diagonal jacobians", "Subsubsection",
 CellChangeTimes->{{3.719562585277133*^9, 
  3.719562588098082*^9}},ExpressionUUID->"3f2363de-dd7b-49c0-8f9d-\
29ced3091828"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dispFrotostrictive", "[", 
       RowBox[{
       "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
        "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
       "]"}], ",", "Ax"}], "]"}], ",", "Ay"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.71956268044128*^9, 
  3.7195626806174803`*^9}},ExpressionUUID->"1820b38f-b957-4e52-b23a-\
945fc1730c98"],

Cell["-(r44*(uxy + uyx))/2.", "Output",
 CellChangeTimes->{3.7195626809833593`*^9, 
  3.722155767029522*^9},ExpressionUUID->"bd27d9cb-3f50-4441-a67d-\
541c05c7fc0d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dispFrotostrictive", "[", 
       RowBox[{
       "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
        "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
       "]"}], ",", "Ax"}], "]"}], ",", "Az"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719562683171817*^9, 
  3.7195626832982483`*^9}},ExpressionUUID->"61da3e77-16b4-404e-af45-\
0fc7a4c528a8"],

Cell["-(r44*(uxz + uzx))", "Output",
 CellChangeTimes->{
  3.719562683574994*^9},ExpressionUUID->"13856003-7e25-436a-8606-\
a2d9c2a40956"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"dispFrotostrictive", "[", 
      RowBox[{
      "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
       "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
      "]"}], ",", "Ax"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"uxx", "\[Rule]", "hx"}], ",", 
     RowBox[{"uxy", "\[Rule]", "hy"}], ",", 
     RowBox[{"uxz", "\[Rule]", "hz"}], ",", 
     RowBox[{"uyy", "\[Rule]", "0"}], ",", 
     RowBox[{"uzz", "\[Rule]", "0"}], ",", 
     RowBox[{"uyx", "\[Rule]", "0"}], ",", 
     RowBox[{"uzx", "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.71956278412628*^9, 3.719562839025581*^9}, {
  3.719562938686153*^9, 
  3.719562940212886*^9}},ExpressionUUID->"e15a947f-1289-4ee7-ad31-\
828c2b9ef5f4"],

Cell["-2*Ax*hx*r11 - ((Ay*hy)/2. + (Az*hz)/2.)*r44", "Output",
 CellChangeTimes->{
  3.719562798962015*^9, {3.71956283030693*^9, 3.7195628394951973`*^9}, 
   3.7195629406395903`*^9, 
   3.722155771233355*^9},ExpressionUUID->"6890346e-8c22-4827-8e13-\
9529c440f550"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"dispFrotostrictive", "[", 
      RowBox[{
      "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
       "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
      "]"}], ",", "Ax"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"uyx", "\[Rule]", "hx"}], ",", 
     RowBox[{"uyy", "\[Rule]", "hy"}], ",", 
     RowBox[{"uyz", "\[Rule]", "hz"}], ",", 
     RowBox[{"uxx", "\[Rule]", "0"}], ",", 
     RowBox[{"uzz", "\[Rule]", "0"}], ",", 
     RowBox[{"uxy", "\[Rule]", "0"}], ",", 
     RowBox[{"uzx", "\[Rule]", "0"}], ",", 
     RowBox[{"uxz", "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.719562850567247*^9, 3.7195628742923517`*^9}, {
  3.7195629307995367`*^9, 
  3.719562932829604*^9}},ExpressionUUID->"097960cc-0ea1-4cee-9182-\
21f03109ba28"],

Cell["-2*Ax*hy*r12 - (Ay*hx*r44)/2.", "Output",
 CellChangeTimes->{{3.719562869127907*^9, 3.7195628750634117`*^9}, 
   3.71956294212477*^9, 
   3.7221557745101433`*^9},ExpressionUUID->"48e5d98e-5d2c-4a8f-a66b-\
13c0ed0ca855"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"dispFrotostrictive", "[", 
      RowBox[{
      "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
       "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
      "]"}], ",", "Ax"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"uzx", "\[Rule]", "hx"}], ",", 
     RowBox[{"uzy", "\[Rule]", "hy"}], ",", 
     RowBox[{"uzz", "\[Rule]", "hz"}], ",", 
     RowBox[{"uxx", "\[Rule]", "0"}], ",", 
     RowBox[{"uyy", "\[Rule]", "0"}], ",", 
     RowBox[{"uxy", "\[Rule]", "0"}], ",", 
     RowBox[{"uxz", "\[Rule]", "0"}], ",", 
     RowBox[{"uyx", "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7195628925454407`*^9, 
  3.719562936643976*^9}},ExpressionUUID->"c0afd812-3ce9-4769-87c7-\
ab1f7f8948f7"],

Cell["-2*Ax*hz*r12 - (Az*hx*r44)/2.", "Output",
 CellChangeTimes->{{3.719562908614238*^9, 3.719562943252102*^9}, 
   3.722155776781493*^9},ExpressionUUID->"3bfd8368-973f-43d6-a22b-\
52d8a6ef54cb"]
}, Open  ]],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{
  Inherited, 3},ExpressionUUID->"84e586ed-e346-4f8f-9883-edbc1b1a312a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dispFrotostrictive", "[", 
       RowBox[{
       "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
        "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
       "]"}], ",", "Ay"}], "]"}], ",", "Ax"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719562686769828*^9, 
  3.719562687007681*^9}},ExpressionUUID->"346823d9-d549-4e23-97d6-\
492e63dcfb46"],

Cell["-(r44*(uxy + uyx))/2.", "Output",
 CellChangeTimes->{3.719562687502594*^9, 
  3.722155777854401*^9},ExpressionUUID->"c612bca4-9ae8-46d7-a55b-\
4771333e1ec9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dispFrotostrictive", "[", 
       RowBox[{
       "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
        "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
       "]"}], ",", "Ay"}], "]"}], ",", "Az"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719562689897038*^9, 3.719562690005521*^9}, {
  3.7195630827741947`*^9, 
  3.719563083680079*^9}},ExpressionUUID->"baa8d92b-f96a-469d-9d15-\
44a5803fe89f"],

Cell["-(r44*(uyz + uzy))/2.", "Output",
 CellChangeTimes->{3.719562690588614*^9, 3.719563084257132*^9, 
  3.722155779116666*^9},ExpressionUUID->"371501eb-9f0d-482d-9ec3-\
a783da90216a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"dispFrotostrictive", "[", 
      RowBox[{
      "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
       "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
      "]"}], ",", "Ay"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"uxx", "\[Rule]", "hx"}], ",", 
     RowBox[{"uxy", "\[Rule]", "hy"}], ",", 
     RowBox[{"uxz", "\[Rule]", "hz"}], ",", 
     RowBox[{"uyy", "\[Rule]", "0"}], ",", 
     RowBox[{"uzz", "\[Rule]", "0"}], ",", 
     RowBox[{"uyx", "\[Rule]", "0"}], ",", 
     RowBox[{"uyz", "\[Rule]", "0"}], ",", 
     RowBox[{"uzy", "\[Rule]", "0"}], ",", 
     RowBox[{"uzx", "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7195630858436823`*^9, 3.719563086278984*^9}, {
  3.719563137929694*^9, 
  3.719563146123485*^9}},ExpressionUUID->"f1539ce2-6f52-4172-a2c4-\
08904bd4532c"],

Cell["-2*Ay*hx*r12 - (Ax*hy*r44)/2.", "Output",
 CellChangeTimes->{
  3.719563089049782*^9, {3.7195631330992002`*^9, 3.719563146549584*^9}, 
   3.722155780472432*^9},ExpressionUUID->"c118f5c4-2f4d-4d9b-a2f4-\
384077fffbf9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"dispFrotostrictive", "[", 
      RowBox[{
      "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
       "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
      "]"}], ",", "Ay"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"uyx", "\[Rule]", "hx"}], ",", 
     RowBox[{"uyy", "\[Rule]", "hy"}], ",", 
     RowBox[{"uyz", "\[Rule]", "hz"}], ",", 
     RowBox[{"uxx", "\[Rule]", "0"}], ",", 
     RowBox[{"uzz", "\[Rule]", "0"}], ",", 
     RowBox[{"uxy", "\[Rule]", "0"}], ",", 
     RowBox[{"uzx", "\[Rule]", "0"}], ",", 
     RowBox[{"uzy", "\[Rule]", "0"}], ",", 
     RowBox[{"uxz", "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.719563126614066*^9, 
  3.7195631574293747`*^9}},ExpressionUUID->"0e363baf-2bc1-452c-be02-\
f3992dea3cbd"],

Cell["-2*Ay*hy*r11 - ((Ax*hx)/2. + (Az*hz)/2.)*r44", "Output",
 CellChangeTimes->{{3.719563127147458*^9, 3.7195631578745604`*^9}, 
   3.722155781850662*^9},ExpressionUUID->"edfa4572-d3b6-4215-9f66-\
3e2110cb79f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"dispFrotostrictive", "[", 
      RowBox[{
      "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
       "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
      "]"}], ",", "Ay"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"uzx", "\[Rule]", "hx"}], ",", 
     RowBox[{"uzy", "\[Rule]", "hy"}], ",", 
     RowBox[{"uzz", "\[Rule]", "hz"}], ",", 
     RowBox[{"uyy", "\[Rule]", "0"}], ",", 
     RowBox[{"uxx", "\[Rule]", "0"}], ",", 
     RowBox[{"uyx", "\[Rule]", "0"}], ",", 
     RowBox[{"uxy", "\[Rule]", "0"}], ",", 
     RowBox[{"uyz", "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.719563097250825*^9, 
  3.719563114011756*^9}},ExpressionUUID->"6e13592f-7b89-40a6-944c-\
827d0823882a"],

Cell["-2*Ay*hz*r12 - (Az*hy*r44)/2.", "Output",
 CellChangeTimes->{{3.719563109331872*^9, 3.7195631145911837`*^9}, 
   3.722155782816787*^9},ExpressionUUID->"4070a950-b689-4a1d-a14b-\
b904a768b7c8"]
}, Open  ]],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{
  Inherited, 3},ExpressionUUID->"9fdd1c5b-c183-4254-bdf1-dd0077a6d1c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dispFrotostrictive", "[", 
       RowBox[{
       "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
        "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
       "]"}], ",", "Az"}], "]"}], ",", "Ax"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719562694429799*^9, 
  3.719562694519136*^9}},ExpressionUUID->"b821f865-cfd1-4ae6-a326-\
1b77daea45fb"],

Cell["-(r44*(uxz + uzx))/2.", "Output",
 CellChangeTimes->{3.719562694794245*^9, 
  3.722155785111041*^9},ExpressionUUID->"967c3c76-dfae-4830-b708-\
276298d854f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dispFrotostrictive", "[", 
       RowBox[{
       "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
        "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
       "]"}], ",", "Ax"}], "]"}], ",", "Ay"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.719562696693975*^9, 
  3.71956269676123*^9}},ExpressionUUID->"7d6c1450-db09-426f-ba59-\
46105c5b90f1"],

Cell["-(r44*(uxy + uyx))/2.", "Output",
 CellChangeTimes->{3.7195626970412188`*^9, 
  3.722155786180273*^9},ExpressionUUID->"7569e2b9-b6f5-475a-844e-\
941b1f08136f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"dispFrotostrictive", "[", 
      RowBox[{
      "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
       "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
      "]"}], ",", "Az"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"uxx", "\[Rule]", "hx"}], ",", 
     RowBox[{"uxy", "\[Rule]", "hy"}], ",", 
     RowBox[{"uxz", "\[Rule]", "hz"}], ",", 
     RowBox[{"uyy", "\[Rule]", "0"}], ",", 
     RowBox[{"uzz", "\[Rule]", "0"}], ",", 
     RowBox[{"uyx", "\[Rule]", "0"}], ",", 
     RowBox[{"uyz", "\[Rule]", "0"}], ",", 
     RowBox[{"uzy", "\[Rule]", "0"}], ",", 
     RowBox[{"uzx", "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7195632158991127`*^9, 
  3.7195632162045107`*^9}},ExpressionUUID->"2c97fd1c-24e6-424f-af91-\
fa88261e9d97"],

Cell["-2*Az*hx*r12 - (Ax*hz*r44)/2.", "Output",
 CellChangeTimes->{3.71956321653916*^9, 
  3.7221557874110413`*^9},ExpressionUUID->"f1f50b0c-a04f-414d-a8fc-\
11c3c79ada9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"dispFrotostrictive", "[", 
      RowBox[{
      "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
       "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
      "]"}], ",", "Az"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"uyx", "\[Rule]", "hx"}], ",", 
     RowBox[{"uyy", "\[Rule]", "hy"}], ",", 
     RowBox[{"uyz", "\[Rule]", "hz"}], ",", 
     RowBox[{"uxx", "\[Rule]", "0"}], ",", 
     RowBox[{"uzz", "\[Rule]", "0"}], ",", 
     RowBox[{"uxy", "\[Rule]", "0"}], ",", 
     RowBox[{"uzx", "\[Rule]", "0"}], ",", 
     RowBox[{"uzy", "\[Rule]", "0"}], ",", 
     RowBox[{"uxz", "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7195632386449757`*^9, 
  3.7195632389320374`*^9}},ExpressionUUID->"4c395bc7-aa86-4c06-9cf9-\
ce65ae17ff8f"],

Cell["-2*Az*hy*r12 - (Ay*hz*r44)/2.", "Output",
 CellChangeTimes->{3.719563241002448*^9, 
  3.72215578838937*^9},ExpressionUUID->"3ba4040f-e2fa-4da1-8936-5d6298333d6b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"dispFrotostrictive", "[", 
      RowBox[{
      "Ax", ",", "Ay", ",", "Az", ",", "uxx", ",", "uyy", ",", "uzz", ",", 
       "uxy", ",", "uxz", ",", "uyx", ",", "uyz", ",", "uzx", ",", "uzy"}], 
      "]"}], ",", "Az"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"uzx", "\[Rule]", "hx"}], ",", 
     RowBox[{"uzy", "\[Rule]", "hy"}], ",", 
     RowBox[{"uzz", "\[Rule]", "hz"}], ",", 
     RowBox[{"uyy", "\[Rule]", "0"}], ",", 
     RowBox[{"uxx", "\[Rule]", "0"}], ",", 
     RowBox[{"uyx", "\[Rule]", "0"}], ",", 
     RowBox[{"uxy", "\[Rule]", "0"}], ",", 
     RowBox[{"uyz", "\[Rule]", "0"}], ",", 
     RowBox[{"uxz", "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.719563255251977*^9, 
  3.719563266652136*^9}},ExpressionUUID->"121b2d66-9153-4a47-b850-\
dee20152f44d"],

Cell["-2*Az*hz*r11 - ((Ax*hx)/2. + (Ay*hy)/2.)*r44", "Output",
 CellChangeTimes->{{3.7195632562601347`*^9, 3.719563267173419*^9}, 
   3.72215578977596*^9},ExpressionUUID->"1569a04f-03c6-4e0e-8a0b-\
79887e874fee"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["    Ferromagnets", "Chapter",
 CellChangeTimes->{{3.82314797402414*^9, 3.823147975537004*^9}, 
   3.823148035279624*^9},ExpressionUUID->"758459e7-ef4f-49dc-882e-\
bb6956ca3e88"],

Cell[CellGroupData[{

Cell["        Material coefficients", "Section",
 CellChangeTimes->{{3.823148328834231*^9, 
  3.823148332764502*^9}},ExpressionUUID->"80812cd6-b1bb-449f-886b-\
21fc76e7e084"],

Cell[CellGroupData[{

Cell["        Py (permalloy)", "Subsection",
 CellChangeTimes->{{3.823148771265864*^9, 
  3.823148790059431*^9}},ExpressionUUID->"1bcf7195-f09f-4887-bfbb-\
b621f6b5a139"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MassScale", "=", "\"\<Picograms\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeScale", "=", "\"\<Microseconds\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LengthScale", "=", "\"\<Micrometers\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ChargeScale", "=", "\"\<Microcoulombs\>\""}], ";"}]}], "Input",Expr\
essionUUID->"293d8cfc-eb2a-48ab-bf96-252eb9b9f6a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"func", "[", 
   RowBox[{
    RowBox[{"1.30", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "11"}]]}], ",", 
    FractionBox[
     RowBox[{"\"\<Kilograms\>\"", 
      SuperscriptBox["\"\<Meters\>\"", "2"]}], 
     RowBox[{
      SuperscriptBox["\"\<Seconds\>\"", "2"], "\"\<Meters\>\""}]], ",", 
    FractionBox[
     RowBox[{"MassScale", " ", 
      SuperscriptBox["LengthScale", "2"]}], 
     RowBox[{
      SuperscriptBox["TimeScale", "2"], "LengthScale"}]]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"func", "[", 
   RowBox[{"1200000.0", ",", 
    FractionBox["\"\<Coulombs\>\"", 
     RowBox[{"\"\<Seconds\>\"", "\"\<Meters\>\""}]], ",", 
    FractionBox["ChargeScale", 
     RowBox[{"TimeScale", " ", "LengthScale"}]]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]H", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"func", "[", 
   RowBox[{
    RowBox[{"2.2101", "\[Times]", 
     SuperscriptBox["10", "5"]}], ",", 
    FractionBox[
     RowBox[{"\"\<Meters\>\"", " ", "\"\<Seconds\>\""}], 
     RowBox[{"\"\<Coulombs\>\"", "\"\<Seconds\>\""}]], ",", 
    FractionBox[
     RowBox[{"LengthScale", " ", "TimeScale"}], 
     RowBox[{"ChargeScale", " ", "TimeScale"}]]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]0", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"func", "[", 
   RowBox[{
    RowBox[{"1.2566370614", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}], ",", 
    FractionBox[
     RowBox[{"\"\<Kilograms\>\"", "\"\<Meters\>\"", 
      SuperscriptBox["\"\<Seconds\>\"", "2"]}], 
     RowBox[{
      SuperscriptBox["\"\<Seconds\>\"", "2"], 
      SuperscriptBox["\"\<Coulombs\>\"", "2"]}]], ",", 
    FractionBox[
     RowBox[{"MassScale", " ", "LengthScale", " ", 
      SuperscriptBox["TimeScale", "2"]}], 
     RowBox[{
      SuperscriptBox["TimeScale", "2"], 
      SuperscriptBox["ChargeScale", "2"]}]]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8231488749277153`*^9, 3.8231488950357103`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"eaa32d20-00aa-49a9-b23a-9848f6dff607"],

Cell[BoxData[
 RowBox[{
  RowBox[{"set", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{"\"\<A=\>\"", ",", 
    RowBox[{"A", "[", 
     RowBox[{
     "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
     "]"}], ",", "\[IndentingNewLine]", "\"\<\[Gamma]H=\>\"", ",", 
    RowBox[{"\[Gamma]H", "[", 
     RowBox[{
     "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
     "]"}], ",", "\[IndentingNewLine]", "\"\<\[Mu]0=\>\"", ",", 
    RowBox[{"\[Mu]0", "[", 
     RowBox[{
     "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
     "]"}], ",", "\[IndentingNewLine]", "\"\<Ms=\>\"", ",", 
    RowBox[{"M", "[", 
     RowBox[{
     "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
     "]"}]}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.823148845456642*^9, 3.823148869791877*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"0072e5dc-e422-4590-81fb-279ce4ab917f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"set", "[", 
  RowBox[{
  "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.82314889875379*^9, 3.823148912663929*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"14cb2a2c-4afd-4553-b69e-8b150e9b939c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"A=\"\>", ",", 
   TemplateBox[{"0.013000000000000001`", 
     RowBox[{
      "\"pg\"", "\[ThinSpace]", "\"\[Micro]m\"", "\[InvisibleSpace]", "\"/\"",
        "\[InvisibleSpace]", 
       SuperscriptBox["\"\[Micro]s\"", "2"]}], 
     "picogram micrometers per microsecond squared", 
     FractionBox[
      RowBox[{"\"Micrometers\"", " ", "\"Picograms\""}], 
      SuperscriptBox["\"Microseconds\"", "2"]]},
    "Quantity"], ",", "\<\"\[Gamma]H=\"\>", ",", 
   TemplateBox[{"221010.00000000003`", 
     RowBox[{
      "\"\[Micro]m\"", "\[InvisibleSpace]", "\"/\"", "\[InvisibleSpace]", 
       "\"\[Micro]C\""}], "micrometers per microcoulomb", 
     FractionBox["\"Micrometers\"", "\"Microcoulombs\""]},
    "Quantity"], ",", "\<\"\[Mu]0=\"\>", ",", 
   TemplateBox[{"1256.6370614`", 
     RowBox[{
      "\"pg\"", "\[ThinSpace]", "\"\[Micro]m\"", "\[InvisibleSpace]", "\"/\"",
        "\[InvisibleSpace]", 
       SuperscriptBox["\"\[Micro]C\"", "2"]}], 
     "picogram micrometers per microcoulomb squared", 
     FractionBox[
      RowBox[{"\"Micrometers\"", " ", "\"Picograms\""}], 
      SuperscriptBox["\"Microcoulombs\"", "2"]]},
    "Quantity"], ",", "\<\"Ms=\"\>", ",", 
   TemplateBox[{"1.2`", 
     RowBox[{
      "\"\[Micro]C\"", "\[InvisibleSpace]", "\"/(\"", "\[InvisibleSpace]", 
       "\"\[Micro]m\"", "\[ThinSpace]", "\"\[Micro]s\"", "\[InvisibleSpace]", 
       "\")\""}], "microcoulombs per micrometer microsecond", 
     FractionBox["\"Microcoulombs\"", 
      RowBox[{"\"Micrometers\"", " ", "\"Microseconds\""}]]},
    "Quantity"]}], "}"}]], "Output",
 CellChangeTimes->{3.823148913120969*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"68e97e53-2187-48da-8878-3b6a7dfba0bf"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "        Effective fields ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["[",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["H",
      FontWeight->"Bold"], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        StyleBox["H",
         FontWeight->"Bold"], "exch"], "(", 
       StyleBox["m",
        FontWeight->"Bold"], ")"}], "+", 
      RowBox[{
       SubscriptBox[
        StyleBox["H",
         FontWeight->"Bold"], "demag"], "(", 
       StyleBox["m",
        FontWeight->"Bold"], ")"}], "+", 
      SubscriptBox[
       StyleBox["H",
        FontWeight->"Bold"], "appl"], "+", 
      RowBox[{
       SubscriptBox[
        StyleBox["H",
         FontWeight->"Bold"], "anis"], "(", 
       StyleBox["m",
        FontWeight->"Bold"], ")"}]}]}], 
    StyleBox["]",
     FontWeight->"Bold"]}], TraditionalForm]],ExpressionUUID->
  "afab536f-072e-4775-bb79-24da021f697c"]
}], "Section",
 CellChangeTimes->{{3.823149004069243*^9, 3.823149009574404*^9}, {
  3.823150999048298*^9, 3.823151040583872*^9}, {3.823161409557742*^9, 
  3.8231614291912317`*^9}},ExpressionUUID->"71df5d96-f5a9-4ffe-9519-\
46d556f98fe6"],

Cell[CellGroupData[{

Cell[TextData[{
 "        Exchange field ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox[
       StyleBox["H",
        FontWeight->"Bold"], "exch"], "=", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", 
         SubscriptBox["A", "e"]}], 
        RowBox[{
         SubscriptBox["M", "s"], " "}]], 
       RowBox[{
        SuperscriptBox["\[Del]", "2"], 
        StyleBox["m",
         FontWeight->"Bold"]}]}]}], ")"}], " "}], TraditionalForm]],
  ExpressionUUID->"098a6c06-40f9-41ad-a6f4-c5c91a65c6b6"]
}], "Subsection",
 CellChangeTimes->{{3.823149091755207*^9, 3.823149102351474*^9}, {
  3.8231528754911203`*^9, 
  3.8231529222104053`*^9}},ExpressionUUID->"f29e61f8-efa7-4034-8c60-\
0dfcb50811e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hexc", "=", 
   RowBox[{"\[CapitalSigma]exc", "  ", 
    FractionBox[
     RowBox[{"2", " ", "Ae"}], 
     RowBox[{"Ms", " "}]], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d2mxdx2", "+", "d2mxdy2", "+", "d2mxdz2"}], ",", 
      RowBox[{"d2mydx2", "+", "d2mydy2", "+", "d2mydz2"}], ",", 
      RowBox[{"d2mzdx2", "+", "d2mzdy2", "+", "d2mzdz2"}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.749445910486377*^9, 3.749446069078456*^9}, 
   3.752230091804883*^9, {3.752230226708441*^9, 3.7522302340193243`*^9}, {
   3.7531832929552517`*^9, 3.753183325690769*^9}, {3.757506627867985*^9, 
   3.757506628155224*^9}, {3.768127856791979*^9, 3.768127857445191*^9}, {
   3.768128499558729*^9, 3.768128501069751*^9}, {3.768131423347054*^9, 
   3.768131426940933*^9}, 3.7693148151011333`*^9, {3.777881307320821*^9, 
   3.777881318632682*^9}, {3.777881642613761*^9, 3.777881681364541*^9}, {
   3.777881765199153*^9, 3.777881769293357*^9}, {3.7782404304768877`*^9, 
   3.7782404426344557`*^9}, {3.778837227583349*^9, 3.778837228333824*^9}, {
   3.778998271176955*^9, 3.778998271847414*^9}, {3.779258008778675*^9, 
   3.7792580092750263`*^9}, {3.788759228184538*^9, 3.788759307844858*^9}, {
   3.789211397600712*^9, 3.789211397982698*^9}, {3.78971251474741*^9, 
   3.789712527161633*^9}, {3.7909373487327213`*^9, 3.7909373519755898`*^9}, {
   3.79095073127884*^9, 3.790950731875654*^9}, {3.793682415186614*^9, 
   3.793682427839735*^9}, 3.823149170811215*^9},
 CellLabel->"In[99]:=",ExpressionUUID->"3f090a8b-d3a9-43c5-bd63-48b9f79b95dd"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "        Demagnetization field ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox[
      StyleBox["H",
       FontWeight->"Bold"], "int"], "=", 
     RowBox[{"-", 
      RowBox[{"\[Del]", 
       SubscriptBox["\[CapitalPhi]", 
        StyleBox["H",
         FontWeight->"Bold"]]}]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "e4cd0b1b-4874-48d3-9451-c4a508e987a7"]
}], "Subsection",
 CellChangeTimes->{{3.8231491118261127`*^9, 3.823149135637599*^9}, {
  3.8231529370739107`*^9, 
  3.8231529638989964`*^9}},ExpressionUUID->"0b862b60-4ea9-4549-aba8-\
2e8a1f253fa3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hint", "=", 
   RowBox[{
    RowBox[{"-", "\[CapitalSigma]int"}], 
    RowBox[{"{", " ", 
     RowBox[{
     "d\[CapitalPhi]dx", ",", "d\[CapitalPhi]dy", ",", "d\[CapitalPhi]dz"}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.749446533831688*^9, 3.749446666945119*^9}, {
   3.749446789733314*^9, 3.7494467936051817`*^9}, {3.749446865439075*^9, 
   3.749446869390739*^9}, {3.749447292309141*^9, 3.749447299829809*^9}, {
   3.751102658108469*^9, 3.7511026792265387`*^9}, {3.7511119076078777`*^9, 
   3.7511119077673063`*^9}, {3.753008077691921*^9, 3.753008080011551*^9}, 
   3.7530081368903713`*^9, {3.7531790797906723`*^9, 3.753179093789392*^9}, {
   3.75318350159783*^9, 3.753183513086712*^9}, {3.7575063145661583`*^9, 
   3.757506322916897*^9}, {3.757508239852392*^9, 3.757508242331109*^9}, {
   3.768109466951543*^9, 3.768109468326877*^9}, {3.7681317784545393`*^9, 
   3.7681317960848618`*^9}, {3.768147708813032*^9, 3.768147727696533*^9}, 
   3.769314831002612*^9, {3.7698508359339*^9, 3.7698508375155087`*^9}, {
   3.774954236172525*^9, 3.7749542418518677`*^9}, {3.778837810325754*^9, 
   3.778837810661017*^9}, {3.778998284646345*^9, 3.778998285013022*^9}, {
   3.7897125622312403`*^9, 3.789712562615157*^9}, 3.823149171813486*^9},
 CellLabel->
  "In[100]:=",ExpressionUUID->"edb61ec0-adcb-4fc1-a042-daf0dcd0c26e"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "        Magnetocrystalline anisotropy ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox[
      StyleBox["H",
       FontWeight->"Bold"], "anis"], "=", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SubscriptBox["K", "1"], 
        SuperscriptBox[
         SubscriptBox["M", "s"], "2"]]}], 
      FractionBox[
       RowBox[{"\[Delta]", "(", 
        RowBox[{
         StyleBox["m",
          FontWeight->"Bold"], "\[CenterDot]", 
         StyleBox["n",
          FontWeight->"Bold"]}], ")"}], 
       RowBox[{"\[Delta]", " ", 
        StyleBox["m",
         FontWeight->"Bold"]}]]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "7dc40786-00c4-4799-80fb-3b704e9b0ce1"]
}], "Subsection",
 CellChangeTimes->{{3.8231491527302732`*^9, 3.823149164116877*^9}, {
  3.8231530193282633`*^9, 
  3.8231530882240877`*^9}},ExpressionUUID->"e1e712fa-5e27-4002-a746-\
cd3cb4e4b2ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hanis", " ", "=", " ", 
   RowBox[{"\[CapitalSigma]anis", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", " ", 
           FractionBox["K1", 
            SuperscriptBox["Ms", "2"]]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"mx", " ", "nx"}], "+", 
             RowBox[{"my", " ", "ny"}], "+", 
             RowBox[{"mz", " ", "nz"}]}], ")"}], "2"]}], ")"}], ",", "mx"}], 
       "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", " ", 
           FractionBox["K1", 
            SuperscriptBox["Ms", "2"]]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"mx", " ", "nx"}], "+", 
             RowBox[{"my", " ", "ny"}], "+", 
             RowBox[{"mz", " ", "nz"}]}], ")"}], "2"]}], ")"}], ",", "my"}], 
       "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["K1", 
            SuperscriptBox["Ms", "2"]]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"mx", " ", "nx"}], "+", 
             RowBox[{"my", " ", "ny"}], "+", 
             RowBox[{"mz", " ", "nz"}]}], ")"}], "2"]}], ")"}], ",", "mz"}], 
       "]"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{3.823149172619276*^9},
 CellLabel->
  "In[101]:=",ExpressionUUID->"71c6f74c-c9c3-4bdc-bbbe-9bda21a966b0"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "        Governing equation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["[",
     FontWeight->"Bold"], " ", 
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       StyleBox["m",
        FontWeight->"Bold"]}], 
      RowBox[{"\[PartialD]", "t"}]], "=", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "\[Gamma]"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[Alpha]", "2"]}], ")"}]], 
      StyleBox["m",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], "\[Times]", " ", 
      StyleBox["H",
       FontWeight->"Bold"]}]}]}], TraditionalForm]],ExpressionUUID->
  "592457b7-3af7-4fc2-a7c3-81845ba14726"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[Gamma]", " ", "\[Alpha]"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[Alpha]", "2"]}], ")"}]]}], 
      StyleBox["m",
       FontWeight->"Bold"], "\[Times]", 
      RowBox[{"(", 
       RowBox[{
        StyleBox["m",
         FontWeight->"Bold"], "\[Times]", 
        StyleBox["H",
         FontWeight->"Bold"]}], ")"}]}], "+", " ", 
     RowBox[{
      SubscriptBox["\[Alpha]", "LL"], "(", 
      RowBox[{
       StyleBox["m",
        FontWeight->"Bold"], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["H",
        FontWeight->"Bold"]}], ")"}], "+", 
     RowBox[{"s", ".", "t", "."}]}], 
    StyleBox["]",
     FontWeight->"Bold"]}], TraditionalForm]],ExpressionUUID->
  "8acb5e15-7fc2-4429-935a-52fe4b68bb6c"]
}], "Section",
 CellChangeTimes->{{3.823148922206627*^9, 3.823148928390716*^9}, {
  3.823150615111183*^9, 3.8231506293599167`*^9}, {3.823150747950761*^9, 
  3.823150748549569*^9}, {3.823150795684841*^9, 3.8231509262696753`*^9}, {
  3.8231512481797132`*^9, 
  3.8231512984116573`*^9}},ExpressionUUID->"561ed868-d16a-4d18-90b8-\
e77a1b0b776b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HRHS", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"-", "\[Gamma]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["\[Alpha]", "2"]}], ")"}], "Ms"}]], " ", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mx", ",", "my", ",", "mz"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Hx", ",", "Hy", ",", "Hz"}], "}"}]}], "]"}]}], "-", " ", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Alpha]", " ", "\[Gamma]"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Alpha]", "2"]}], ")"}]], 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mx", ",", "my", ",", "mz"}], "}"}], ",", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mx", ",", "my", ",", "mz"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Hx", ",", "Hy", ",", "Hz"}], "}"}]}], "]"}]}], 
         "]"}]}]}], ")"}], "+", "st\[Tau]"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.82314919662469*^9, 3.823149212122205*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"4aa8480d-077c-4767-9edf-99b149a12936"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RHSmx", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]h", " ", 
      RowBox[{"HRHS", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "/.", "effectiveFieldSubstitute"}], "/.", 
    RowBox[{"{", 
     RowBox[{"st\[Tau]", "\[Rule]", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmy", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]h", " ", 
      RowBox[{"HRHS", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "/.", "effectiveFieldSubstitute"}], "/.", 
    RowBox[{"{", 
     RowBox[{"st\[Tau]", "\[Rule]", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmz", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]h", " ", 
      RowBox[{"HRHS", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "/.", "effectiveFieldSubstitute"}], "/.", 
    RowBox[{"{", 
     RowBox[{"st\[Tau]", "\[Rule]", "0"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.823149275834787*^9, 3.823149298710684*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"98b89b1a-5b50-439c-afd9-3dbe3b7c1ce0"],

Cell["\<\
Interesting... we moved over 1/Ms to both sides, this canceled the Ms on the \
damping term but brought it to the precessional term. This could be a \
problem...\
\>", "Text",
 CellChangeTimes->{{3.823150186607751*^9, 
  3.823150231702965*^9}},ExpressionUUID->"1d7de1d0-64a7-4719-9696-\
82d1e6f8f268"]
}, Closed]],

Cell[CellGroupData[{

Cell["        Algebra for exchange term", "Section",
 CellChangeTimes->{{3.8231493209040737`*^9, 
  3.823149327819518*^9}},ExpressionUUID->"2396f8a0-dd60-420e-8cce-\
072d7c0547aa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expandRHSmx", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"RHSmx", ",", "\[CapitalSigma]exc"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
       "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
       "d2mzdz2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numTermsRHSmx", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"RHSmx", ",", "\[CapitalSigma]exc"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
        "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
        "d2mzdz2"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"RHSmxEXCH", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"expandRHSmx", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "/.", "intByParts1"}], ",", 
        RowBox[{"varvec", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "numTermsRHSmx"}], "}"}]}], "]"}], "/.", 
    "intByParts2"}], "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.82314995118071*^9, 3.823149957781766*^9}, {
  3.823150058644405*^9, 3.823150059255477*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"ee17ac49-a45f-4c6a-8f4d-d3cace439586"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["Ms", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], 
  RowBox[{"2", " ", "Ae", " ", "\[Gamma]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"dmzdx", " ", "d\[Psi]hdx", " ", "my"}], "+", 
     RowBox[{"dmzdy", " ", "d\[Psi]hdy", " ", "my"}], "+", 
     RowBox[{"dmzdz", " ", "d\[Psi]hdz", " ", "my"}], "-", 
     RowBox[{"dmydx", " ", "d\[Psi]hdx", " ", "mz"}], "-", 
     RowBox[{"dmydy", " ", "d\[Psi]hdy", " ", "mz"}], "-", 
     RowBox[{"dmydz", " ", "d\[Psi]hdz", " ", "mz"}], "+", 
     RowBox[{
     "dmydx", " ", "d\[Psi]hdx", " ", "Ms", " ", "mx", " ", "my", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmydy", " ", "d\[Psi]hdy", " ", "Ms", " ", "mx", " ", "my", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmydz", " ", "d\[Psi]hdz", " ", "Ms", " ", "mx", " ", "my", " ", 
      "\[Alpha]"}], "-", 
     RowBox[{"dmxdx", " ", "d\[Psi]hdx", " ", "Ms", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmxdy", " ", "d\[Psi]hdy", " ", "Ms", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmxdz", " ", "d\[Psi]hdz", " ", "Ms", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]"}], "+", 
     RowBox[{
     "dmzdx", " ", "d\[Psi]hdx", " ", "Ms", " ", "mx", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmzdy", " ", "d\[Psi]hdy", " ", "Ms", " ", "mx", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmzdz", " ", "d\[Psi]hdz", " ", "Ms", " ", "mx", " ", "mz", " ", 
      "\[Alpha]"}], "-", 
     RowBox[{"dmxdx", " ", "d\[Psi]hdx", " ", "Ms", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmxdy", " ", "d\[Psi]hdy", " ", "Ms", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmxdz", " ", "d\[Psi]hdz", " ", "Ms", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]"}], "+", 
     RowBox[{"Ms", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["dmydx", "2"], " ", "mx"}], "+", 
        RowBox[{
         SuperscriptBox["dmydy", "2"], " ", "mx"}], "+", 
        RowBox[{
         SuperscriptBox["dmydz", "2"], " ", "mx"}], "+", 
        RowBox[{
         SuperscriptBox["dmzdx", "2"], " ", "mx"}], "+", 
        RowBox[{
         SuperscriptBox["dmzdy", "2"], " ", "mx"}], "+", 
        RowBox[{
         SuperscriptBox["dmzdz", "2"], " ", "mx"}], "-", 
        RowBox[{"dmxdx", " ", "dmydx", " ", "my"}], "-", 
        RowBox[{"dmxdy", " ", "dmydy", " ", "my"}], "-", 
        RowBox[{"dmxdz", " ", "dmydz", " ", "my"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dmxdx", " ", "dmzdx"}], "+", 
           RowBox[{"dmxdy", " ", "dmzdy"}], "+", 
           RowBox[{"dmxdz", " ", "dmzdz"}]}], ")"}], " ", "mz"}]}], ")"}], 
      " ", "\[Alpha]", " ", "\[Psi]h"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.823150061973235*^9},
 CellLabel->
  "Out[119]=",ExpressionUUID->"884f9faf-a682-49a8-9936-cdd13d17a58c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expandRHSmy", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"RHSmy", ",", "\[CapitalSigma]exc"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
       "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
       "d2mzdz2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numTermsRHSmy", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"RHSmy", ",", "\[CapitalSigma]exc"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
        "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
        "d2mzdz2"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"RHSmyEXCH", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"expandRHSmy", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "/.", "intByParts1"}], ",", 
        RowBox[{"varvec", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "numTermsRHSmy"}], "}"}]}], "]"}], "/.", 
    "intByParts2"}], "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{
  3.823149974611458*^9, {3.823150055212843*^9, 3.823150055970642*^9}, {
   3.8231501541609898`*^9, 3.82315015478885*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"ce39e57f-e0a8-4873-a360-41e0d1b16eb3"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["Ms", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], 
  RowBox[{"2", " ", "Ae", " ", "\[Gamma]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "dmzdx"}], " ", "d\[Psi]hdx", " ", "mx"}], "-", 
     RowBox[{"dmzdy", " ", "d\[Psi]hdy", " ", "mx"}], "-", 
     RowBox[{"dmzdz", " ", "d\[Psi]hdz", " ", "mx"}], "+", 
     RowBox[{"dmxdx", " ", "d\[Psi]hdx", " ", "mz"}], "+", 
     RowBox[{"dmxdy", " ", "d\[Psi]hdy", " ", "mz"}], "+", 
     RowBox[{"dmxdz", " ", "d\[Psi]hdz", " ", "mz"}], "-", 
     RowBox[{"dmydx", " ", "d\[Psi]hdx", " ", "Ms", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmydy", " ", "d\[Psi]hdy", " ", "Ms", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmydz", " ", "d\[Psi]hdz", " ", "Ms", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]"}], "+", 
     RowBox[{
     "dmxdx", " ", "d\[Psi]hdx", " ", "Ms", " ", "mx", " ", "my", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmxdy", " ", "d\[Psi]hdy", " ", "Ms", " ", "mx", " ", "my", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmxdz", " ", "d\[Psi]hdz", " ", "Ms", " ", "mx", " ", "my", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmzdx", " ", "d\[Psi]hdx", " ", "Ms", " ", "my", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmzdy", " ", "d\[Psi]hdy", " ", "Ms", " ", "my", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmzdz", " ", "d\[Psi]hdz", " ", "Ms", " ", "my", " ", "mz", " ", 
      "\[Alpha]"}], "-", 
     RowBox[{"dmydx", " ", "d\[Psi]hdx", " ", "Ms", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmydy", " ", "d\[Psi]hdy", " ", "Ms", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmydz", " ", "d\[Psi]hdz", " ", "Ms", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]"}], "+", 
     RowBox[{"Ms", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "dmxdx"}], " ", "dmydx", " ", "mx"}], "-", 
        RowBox[{"dmxdy", " ", "dmydy", " ", "mx"}], "-", 
        RowBox[{"dmxdz", " ", "dmydz", " ", "mx"}], "+", 
        RowBox[{
         SuperscriptBox["dmxdx", "2"], " ", "my"}], "+", 
        RowBox[{
         SuperscriptBox["dmxdy", "2"], " ", "my"}], "+", 
        RowBox[{
         SuperscriptBox["dmxdz", "2"], " ", "my"}], "+", 
        RowBox[{
         SuperscriptBox["dmzdx", "2"], " ", "my"}], "+", 
        RowBox[{
         SuperscriptBox["dmzdy", "2"], " ", "my"}], "+", 
        RowBox[{
         SuperscriptBox["dmzdz", "2"], " ", "my"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dmydx", " ", "dmzdx"}], "+", 
           RowBox[{"dmydy", " ", "dmzdy"}], "+", 
           RowBox[{"dmydz", " ", "dmzdz"}]}], ")"}], " ", "mz"}]}], ")"}], 
      " ", "\[Alpha]", " ", "\[Psi]h"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.8231501562235527`*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"024ad78a-23b0-409a-8e32-b6743b523445"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expandRHSmz", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"RHSmz", ",", "\[CapitalSigma]exc"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
       "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
       "d2mzdz2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numTermsRHSmz", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"RHSmz", ",", "\[CapitalSigma]exc"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
        "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
        "d2mzdz2"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"RHSmzEXCH", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"expandRHSmz", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "/.", "intByParts1"}], ",", 
        RowBox[{"varvec", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "numTermsRHSmz"}], "}"}]}], "]"}], "/.", 
    "intByParts2"}], "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.823150314429163*^9, 3.8231503228251266`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"81edb96c-ba96-4bcf-bc8c-0e3a0e38c00d"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["Ms", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], 
  RowBox[{"2", " ", "Ae", " ", "\[Gamma]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"dmydx", " ", "d\[Psi]hdx", " ", "mx"}], "+", 
     RowBox[{"dmydy", " ", "d\[Psi]hdy", " ", "mx"}], "+", 
     RowBox[{"dmydz", " ", "d\[Psi]hdz", " ", "mx"}], "-", 
     RowBox[{"dmxdx", " ", "d\[Psi]hdx", " ", "my"}], "-", 
     RowBox[{"dmxdy", " ", "d\[Psi]hdy", " ", "my"}], "-", 
     RowBox[{"dmxdz", " ", "d\[Psi]hdz", " ", "my"}], "-", 
     RowBox[{"dmzdx", " ", "d\[Psi]hdx", " ", "Ms", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmzdy", " ", "d\[Psi]hdy", " ", "Ms", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmzdz", " ", "d\[Psi]hdz", " ", "Ms", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmzdx", " ", "d\[Psi]hdx", " ", "Ms", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmzdy", " ", "d\[Psi]hdy", " ", "Ms", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"dmzdz", " ", "d\[Psi]hdz", " ", "Ms", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]"}], "+", 
     RowBox[{
     "dmxdx", " ", "d\[Psi]hdx", " ", "Ms", " ", "mx", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmxdy", " ", "d\[Psi]hdy", " ", "Ms", " ", "mx", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmxdz", " ", "d\[Psi]hdz", " ", "Ms", " ", "mx", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmydx", " ", "d\[Psi]hdx", " ", "Ms", " ", "my", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmydy", " ", "d\[Psi]hdy", " ", "Ms", " ", "my", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{
     "dmydz", " ", "d\[Psi]hdz", " ", "Ms", " ", "my", " ", "mz", " ", 
      "\[Alpha]"}], "+", 
     RowBox[{"Ms", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "dmxdx"}], " ", "dmzdx", " ", "mx"}], "-", 
        RowBox[{"dmxdy", " ", "dmzdy", " ", "mx"}], "-", 
        RowBox[{"dmxdz", " ", "dmzdz", " ", "mx"}], "-", 
        RowBox[{"dmydx", " ", "dmzdx", " ", "my"}], "-", 
        RowBox[{"dmydy", " ", "dmzdy", " ", "my"}], "-", 
        RowBox[{"dmydz", " ", "dmzdz", " ", "my"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["dmxdx", "2"], "+", 
           SuperscriptBox["dmxdy", "2"], "+", 
           SuperscriptBox["dmxdz", "2"], "+", 
           SuperscriptBox["dmydx", "2"], "+", 
           SuperscriptBox["dmydy", "2"], "+", 
           SuperscriptBox["dmydz", "2"]}], ")"}], " ", "mz"}]}], ")"}], " ", 
      "\[Alpha]", " ", "\[Psi]h"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.823150323844399*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"1856c70f-8637-44b0-b4ce-d728d2af5310"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        Kernel for exchange", "Section",
 CellChangeTimes->{{3.823150338940117*^9, 
  3.823150372039863*^9}},ExpressionUUID->"2f02d2bd-0e0e-4eb3-87f0-\
04e73133a678"],

Cell[CellGroupData[{

Cell["        Residuals:", "Subsection",
 CellChangeTimes->{{3.823150365548266*^9, 
  3.823150375920673*^9}},ExpressionUUID->"2dcb3fed-ca30-4079-8597-\
fe5e0ff5479d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmxEXCH", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.7887665036032877`*^9, 3.788766590205453*^9}, {
   3.789224392003375*^9, 3.789224399088542*^9}, {3.789224691119982*^9, 
   3.789224691695429*^9}, {3.7897212240198193`*^9, 3.789721226389922*^9}, {
   3.7905739546066113`*^9, 3.79057395582373*^9}, {3.7905739956927223`*^9, 
   3.790574017931569*^9}, {3.790574211589744*^9, 3.790574214197143*^9}, {
   3.790937395250658*^9, 3.790937395438311*^9}, {3.790938364846133*^9, 
   3.790938365421235*^9}, 3.790939161021018*^9, {3.790941879820983*^9, 
   3.790941880583666*^9}, {3.7909421549030533`*^9, 3.790942155876746*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"79fd22c5-0677-46b9-9dfc-fe242b778343"],

Cell["\<\
(2*Ae*g0*(dmzdx*dtestdx*my + dmzdy*dtestdy*my + dmzdz*dtestdz*my + \
alpha*dmydx*dtestdx*Ms*mx*my + alpha*dmydy*dtestdy*Ms*mx*my + 
       alpha*dmydz*dtestdz*Ms*mx*my - alpha*dmxdx*dtestdx*Ms*Power(my,2) - \
alpha*dmxdy*dtestdy*Ms*Power(my,2) - 
       alpha*dmxdz*dtestdz*Ms*Power(my,2) - dmydx*dtestdx*mz - \
dmydy*dtestdy*mz - dmydz*dtestdz*mz + alpha*dmzdx*dtestdx*Ms*mx*mz + 
       alpha*dmzdy*dtestdy*Ms*mx*mz + alpha*dmzdz*dtestdz*Ms*mx*mz - \
alpha*dmxdx*dtestdx*Ms*Power(mz,2) - 
       alpha*dmxdy*dtestdy*Ms*Power(mz,2) - \
alpha*dmxdz*dtestdz*Ms*Power(mz,2) + 
       alpha*Ms*(Power(dmydx,2)*mx + Power(dmydy,2)*mx + Power(dmydz,2)*mx + \
Power(dmzdx,2)*mx + Power(dmzdy,2)*mx + 
          Power(dmzdz,2)*mx - dmxdx*dmydx*my - dmxdy*dmydy*my - \
dmxdz*dmydz*my - (dmxdx*dmzdx + dmxdy*dmzdy + dmxdz*dmzdz)*mz)*test))/
   ((1 + Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{{3.788766501308622*^9, 3.788766521499352*^9}, {
   3.788766556232833*^9, 3.788766608306416*^9}, 3.788767592755156*^9, 
   3.7887677924812317`*^9, 3.788767833483213*^9, 3.7888489455002728`*^9, 
   3.788849351143167*^9, 3.788849711750602*^9, 3.78921105357539*^9, 
   3.7892114329160767`*^9, {3.789224389554401*^9, 3.789224399965054*^9}, 
   3.789224650756081*^9, 3.789224692139022*^9, 3.7894601862303534`*^9, 
   3.78971352732668*^9, 3.7897199499595947`*^9, 3.7897212272885323`*^9, {
   3.7905739919062023`*^9, 3.7905740184987993`*^9}, 3.790574214974779*^9, {
   3.7909373914223948`*^9, 3.790937396138855*^9}, 3.790938326460455*^9, 
   3.790938366982645*^9, 3.790939162665497*^9, {3.7909418616601877`*^9, 
   3.7909418818508997`*^9}, 3.7909419651089163`*^9, 3.790942157190597*^9, 
   3.7909507687901897`*^9, 3.79126864068408*^9, 3.79126904829109*^9, 
   3.793683316578801*^9, 3.8067388312593193`*^9, 3.806739720030931*^9, 
   3.806742170579068*^9, 3.8068172280956783`*^9, 3.819453581581943*^9, 
   3.823150391808757*^9, 3.8231504435500507`*^9},
 CellLabel->
  "Out[128]//CForm=",ExpressionUUID->"c6a74596-d201-49f5-9d03-033649021e74"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmyEXCH", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.7887665799184*^9, 3.788766580317924*^9}, {
   3.788766611581106*^9, 3.788766612302409*^9}, {3.789224402573848*^9, 
   3.78922440397211*^9}, {3.789224688343865*^9, 3.789224688967578*^9}, 
   3.78972123073936*^9, {3.790574226290237*^9, 3.7905742293302307`*^9}, {
   3.790937398548139*^9, 3.79093739872077*^9}, {3.790938362795417*^9, 
   3.7909383631040993`*^9}, {3.790941892779089*^9, 3.790941893872539*^9}, {
   3.790942159023299*^9, 3.790942171774754*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"9445b612-1932-49cd-a2dc-1844aebe34ea"],

Cell["\<\
(2*Ae*g0*(-(dmzdx*dtestdx*mx) - dmzdy*dtestdy*mx - dmzdz*dtestdz*mx - \
alpha*dmydx*dtestdx*Ms*Power(mx,2) - 
       alpha*dmydy*dtestdy*Ms*Power(mx,2) - \
alpha*dmydz*dtestdz*Ms*Power(mx,2) + alpha*dmxdx*dtestdx*Ms*mx*my + 
       alpha*dmxdy*dtestdy*Ms*mx*my + alpha*dmxdz*dtestdz*Ms*mx*my + \
dmxdx*dtestdx*mz + dmxdy*dtestdy*mz + dmxdz*dtestdz*mz + 
       alpha*dmzdx*dtestdx*Ms*my*mz + alpha*dmzdy*dtestdy*Ms*my*mz + \
alpha*dmzdz*dtestdz*Ms*my*mz - 
       alpha*dmydx*dtestdx*Ms*Power(mz,2) - \
alpha*dmydy*dtestdy*Ms*Power(mz,2) - alpha*dmydz*dtestdz*Ms*Power(mz,2) + 
       alpha*Ms*(-(dmxdx*dmydx*mx) - dmxdy*dmydy*mx - dmxdz*dmydz*mx + \
Power(dmxdx,2)*my + Power(dmxdy,2)*my + Power(dmxdz,2)*my + 
          Power(dmzdx,2)*my + Power(dmzdy,2)*my + Power(dmzdz,2)*my - \
(dmydx*dmzdx + dmydy*dmzdy + dmydz*dmzdz)*mz)*test))/
   ((1 + Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{
  3.788766580850893*^9, 3.788766612877716*^9, 3.78876759277076*^9, 
   3.788767792599042*^9, 3.788767834582532*^9, 3.788848945795844*^9, 
   3.7888493512499037`*^9, 3.788849712828071*^9, 3.789211054714602*^9, 
   3.789211434198256*^9, 3.789224404399119*^9, 3.789224651415595*^9, 
   3.789224689487124*^9, 3.789460187747799*^9, 3.789713530140608*^9, 
   3.789719951525585*^9, 3.789721264831463*^9, 3.7905742297096024`*^9, 
   3.7909373992327967`*^9, 3.790938329092622*^9, 3.79093836815796*^9, 
   3.790939169121087*^9, 3.790941898334902*^9, 3.7909419643519783`*^9, {
   3.7909421636612997`*^9, 3.79094217574363*^9}, 3.790950769606798*^9, 
   3.791268647165443*^9, 3.791269049841016*^9, 3.793683318255158*^9, 
   3.8067388312701797`*^9, 3.806739720139344*^9, 3.806742170755103*^9, 
   3.806817230303933*^9, 3.8194535865264893`*^9, 3.82315044513526*^9},
 CellLabel->
  "Out[129]//CForm=",ExpressionUUID->"885e7f6c-1296-4c85-b889-121661bd58eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmzEXCH", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.78876658391778*^9, 3.7887665842540894`*^9}, {
   3.788766615116439*^9, 3.788766615503327*^9}, {3.789224406367539*^9, 
   3.789224408569437*^9}, {3.789224685615699*^9, 3.789224686175523*^9}, 
   3.789721232850727*^9, {3.790574232465568*^9, 3.790574234946233*^9}, {
   3.790937401103056*^9, 3.7909374012697773`*^9}, {3.7909383373896437`*^9, 
   3.79093835687037*^9}, {3.790941895142663*^9, 3.7909418958212557`*^9}, {
   3.790942167296096*^9, 3.790942173898416*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"edf23143-6597-46bb-8eda-cab6c7ac2639"],

Cell["\<\
(2*Ae*g0*(dmydx*dtestdx*mx + dmydy*dtestdy*mx + dmydz*dtestdz*mx - \
alpha*dmzdx*dtestdx*Ms*Power(mx,2) - 
       alpha*dmzdy*dtestdy*Ms*Power(mx,2) - \
alpha*dmzdz*dtestdz*Ms*Power(mx,2) - dmxdx*dtestdx*my - dmxdy*dtestdy*my - 
       dmxdz*dtestdz*my - alpha*dmzdx*dtestdx*Ms*Power(my,2) - \
alpha*dmzdy*dtestdy*Ms*Power(my,2) - 
       alpha*dmzdz*dtestdz*Ms*Power(my,2) + alpha*dmxdx*dtestdx*Ms*mx*mz + \
alpha*dmxdy*dtestdy*Ms*mx*mz + 
       alpha*dmxdz*dtestdz*Ms*mx*mz + alpha*dmydx*dtestdx*Ms*my*mz + \
alpha*dmydy*dtestdy*Ms*my*mz + alpha*dmydz*dtestdz*Ms*my*mz + 
       alpha*Ms*(-(dmxdx*dmzdx*mx) - dmxdy*dmzdy*mx - dmxdz*dmzdz*mx - \
dmydx*dmzdx*my - dmydy*dmzdy*my - dmydz*dmzdz*my + 
          (Power(dmxdx,2) + Power(dmxdy,2) + Power(dmxdz,2) + Power(dmydx,2) \
+ Power(dmydy,2) + Power(dmydz,2))*mz)*test))/
   ((1 + Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{
  3.788766584640018*^9, 3.788766616003661*^9, 3.7887675929168*^9, 
   3.7887677927187557`*^9, 3.788767835653442*^9, 3.78884894601062*^9, 
   3.788849351341001*^9, 3.788849713749051*^9, 3.7892110560727673`*^9, 
   3.78921143514633*^9, 3.789224408963687*^9, 3.78922465249994*^9, 
   3.7892246867864103`*^9, 3.7894601891039658`*^9, 3.789713532298283*^9, 
   3.78971995304801*^9, 3.789721266263465*^9, 3.790574235358863*^9, 
   3.790937402128479*^9, {3.7909383306717453`*^9, 3.790938368221581*^9}, 
   3.7909391716723137`*^9, 3.7909418991139603`*^9, 3.790941962759951*^9, 
   3.790942104720394*^9, {3.790942168392202*^9, 3.790942174888774*^9}, 
   3.7909507708673067`*^9, 3.791268649508407*^9, 3.791269051522208*^9, 
   3.793683319986457*^9, 3.8067388314065313`*^9, 3.806739720251569*^9, 
   3.806742171247849*^9, 3.806817232189094*^9, 3.819453591273374*^9, 
   3.823150446943499*^9},
 CellLabel->
  "Out[130]//CForm=",ExpressionUUID->"082f1f32-0d65-4725-ba1b-1c13a3b7fb96"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        On-diagonal jacobian entries", "Subsection",
 CellChangeTimes->{{3.8231505360972223`*^9, 3.8231505462854013`*^9}, {
  3.823150593919609*^9, 
  3.823150594623035*^9}},ExpressionUUID->"abb39c8d-b5de-4d28-8cca-\
f5a4ceb6d036"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxEXCH", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.788766625931375*^9, 3.788766733461341*^9}, {
   3.7887668545278893`*^9, 3.788766855295376*^9}, {3.7887669153900223`*^9, 
   3.788767095058152*^9}, 3.78876719259743*^9, {3.789224658053955*^9, 
   3.7892246818790283`*^9}, 3.789721235331017*^9, {3.790574252592458*^9, 
   3.790574255888419*^9}, 3.790938516647736*^9, {3.7909419000572557`*^9, 
   3.790941909443611*^9}, {3.7909421791951427`*^9, 3.790942179593205*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"8fb1568d-3add-4f45-a525-1c922a2bf45e"],

Cell["\<\
(2*Ae*alpha*g0*(-(dphidz*dtestdz*Power(my,2)) - dphidz*dtestdz*Power(mz,2) + \
dmydx*dtestdx*my*phi + dmydy*dtestdy*my*phi + 
       dmydz*dtestdz*my*phi + dmzdx*dtestdx*mz*phi + dmzdy*dtestdy*mz*phi + \
dmzdz*dtestdz*mz*phi - dphidz*(dmydz*my + dmzdz*mz)*test + 
       (Power(dmydx,2) + Power(dmydy,2) + Power(dmydz,2) + Power(dmzdx,2) + \
Power(dmzdy,2) + Power(dmzdz,2))*phi*test - 
       dphidy*(dtestdy*Power(my,2) + dtestdy*Power(mz,2) + dmydy*my*test + \
dmzdy*mz*test) - 
       dphidx*(dtestdx*(Power(my,2) + Power(mz,2)) + (dmydx*my + \
dmzdx*mz)*test)))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{{3.788766632008133*^9, 3.788766648025016*^9}, 
   3.788766682638452*^9, 3.78876673400174*^9, 3.788766881413435*^9, {
   3.788766916933836*^9, 3.7887671090354977`*^9}, 3.7887671932820673`*^9, 
   3.78876759315943*^9, 3.788767792877295*^9, 3.788767838459116*^9, 
   3.7888489462109737`*^9, 3.788849351495001*^9, 3.788849715493628*^9, 
   3.789211057531961*^9, 3.789211436648541*^9, {3.7892246536620483`*^9, 
   3.789224682467248*^9}, 3.789460190915688*^9, 3.789713534040369*^9, 
   3.789719954486865*^9, {3.789721237586265*^9, 3.7897212625600233`*^9}, {
   3.790574257561987*^9, 3.790574267229103*^9}, 3.790938525216605*^9, 
   3.790939173590217*^9, {3.790941901908885*^9, 3.7909419185484877`*^9}, 
   3.790941961771316*^9, 3.7909421806653547`*^9, 3.79095077202835*^9, 
   3.791268652647053*^9, 3.7912690536871843`*^9, 3.7936833241696663`*^9, 
   3.806738831555254*^9, 3.806739720374791*^9, 3.806742171534554*^9, 
   3.819453596120048*^9, 3.823150559138112*^9},
 CellLabel->
  "Out[131]//CForm=",ExpressionUUID->"0f6a3fdf-b259-449b-9bf2-d998be5d1da8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyEXCH", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.7887671164038982`*^9, 3.788767118465036*^9}, {
   3.788767199684679*^9, 3.7887672033402233`*^9}, {3.7892246623736467`*^9, 
   3.7892246786229877`*^9}, 3.789721236709538*^9, {3.7905742612962933`*^9, 
   3.7905742619733562`*^9}, {3.790938519387527*^9, 3.7909385200750513`*^9}, {
   3.7909419026126757`*^9, 3.790941906923915*^9}, 3.790942182554388*^9},
 CellLabel->
  "In[132]:=",ExpressionUUID->"3daebc25-f3b2-4fdf-8b4a-f8620b9632ca"],

Cell["\<\
(2*Ae*alpha*g0*(-(dphidz*dtestdz*Power(mx,2)) - dphidz*dtestdz*Power(mz,2) + \
dmxdx*dtestdx*mx*phi + dmxdy*dtestdy*mx*phi + 
       dmxdz*dtestdz*mx*phi + dmzdx*dtestdx*mz*phi + dmzdy*dtestdy*mz*phi + \
dmzdz*dtestdz*mz*phi - dphidz*(dmxdz*mx + dmzdz*mz)*test + 
       (Power(dmxdx,2) + Power(dmxdy,2) + Power(dmxdz,2) + Power(dmzdx,2) + \
Power(dmzdy,2) + Power(dmzdz,2))*phi*test - 
       dphidy*(dtestdy*Power(mx,2) + dtestdy*Power(mz,2) + dmxdy*mx*test + \
dmzdy*mz*test) - 
       dphidx*(dtestdx*(Power(mx,2) + Power(mz,2)) + (dmxdx*mx + \
dmzdx*mz)*test)))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.823150569672126*^9},
 CellLabel->
  "Out[132]//CForm=",ExpressionUUID->"bd0c98e0-83d8-4a33-b1dd-b31bed70e9c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzEXCH", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[133]:=",ExpressionUUID->"d114960d-0fc1-442f-8e42-9975784493c8"],

Cell["\<\
(2*Ae*alpha*g0*(-(dphidz*dtestdz*Power(mx,2)) - dphidz*dtestdz*Power(my,2) + \
dmxdx*dtestdx*mx*phi + dmxdy*dtestdy*mx*phi + 
       dmxdz*dtestdz*mx*phi + dmydx*dtestdx*my*phi + dmydy*dtestdy*my*phi + \
dmydz*dtestdz*my*phi - dphidz*(dmxdz*mx + dmydz*my)*test + 
       (Power(dmxdx,2) + Power(dmxdy,2) + Power(dmxdz,2) + Power(dmydx,2) + \
Power(dmydy,2) + Power(dmydz,2))*phi*test - 
       dphidy*(dtestdy*Power(mx,2) + dtestdy*Power(my,2) + dmxdy*mx*test + \
dmydy*my*test) - 
       dphidx*(dtestdx*(Power(mx,2) + Power(my,2)) + (dmxdx*mx + \
dmydx*my)*test)))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.82315057905896*^9},
 CellLabel->
  "Out[133]//CForm=",ExpressionUUID->"66b37e94-8538-4f4c-8da8-84c603aa4edc"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        Off-diagonal jacobian entries", "Subsection",
 CellChangeTimes->{{3.823150585431354*^9, 
  3.823150597271212*^9}},ExpressionUUID->"9c9c765a-c221-4236-9c32-\
b690e2a42e24"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxEXCH", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[134]:=",ExpressionUUID->"744086df-8cb8-4036-bbbe-92dea9a44f85"],

Cell["\<\
(2*Ae*g0*(-((dphidx*dtestdx + dphidy*dtestdy + dphidz*dtestdz)*mz) + \
(dmzdx*dtestdx + dmzdy*dtestdy + dmzdz*dtestdz)*phi + 
       alpha*Ms*(dphidx*dtestdx*mx*my + dphidy*dtestdy*mx*my + \
dphidz*dtestdz*mx*my + dmydx*dtestdx*mx*phi + dmydy*dtestdy*mx*phi + 
          dmydz*dtestdz*mx*phi - 2*dmxdx*dtestdx*my*phi - \
2*dmxdy*dtestdy*my*phi - 2*dmxdz*dtestdz*my*phi + 
          (2*dmydx*dphidx*mx + 2*dmydy*dphidy*mx + 2*dmydz*dphidz*mx - \
dmxdx*dphidx*my - dmxdy*dphidy*my - dmxdz*dphidz*my - 
             (dmxdx*dmydx + dmxdy*dmydy + dmxdz*dmydz)*phi)*test)))/((1 + \
Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{3.8231506928669367`*^9},
 CellLabel->
  "Out[134]//CForm=",ExpressionUUID->"4ebc0444-c9fa-446a-b256-a99e3262e87d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxEXCH", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[135]:=",ExpressionUUID->"e2458c0d-2418-4656-a3d0-6dd0e5a02da5"],

Cell["\<\
(2*Ae*g0*(dphidx*dtestdx*my + dphidy*dtestdy*my + dphidz*dtestdz*my + \
alpha*dphidx*dtestdx*Ms*mx*mz + alpha*dphidy*dtestdy*Ms*mx*mz + 
       alpha*dphidz*dtestdz*Ms*mx*mz - dmydx*dtestdx*phi - dmydy*dtestdy*phi \
- dmydz*dtestdz*phi + alpha*dmzdx*dtestdx*Ms*mx*phi + 
       alpha*dmzdy*dtestdy*Ms*mx*phi + alpha*dmzdz*dtestdz*Ms*mx*phi - \
2*alpha*dmxdx*dtestdx*Ms*mz*phi - 
       2*alpha*dmxdy*dtestdy*Ms*mz*phi - 2*alpha*dmxdz*dtestdz*Ms*mz*phi + 
       alpha*Ms*(2*dmzdx*dphidx*mx + 2*dmzdy*dphidy*mx + 2*dmzdz*dphidz*mx - \
(dmxdx*dphidx + dmxdy*dphidy + dmxdz*dphidz)*mz - 
          (dmxdx*dmzdx + dmxdy*dmzdy + dmxdz*dmzdz)*phi)*test))/((1 + \
Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{3.823150706050523*^9},
 CellLabel->
  "Out[135]//CForm=",ExpressionUUID->"88941e37-0600-4503-b192-0d6f76f69476"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyEXCH", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[136]:=",ExpressionUUID->"ca3c4e90-55b5-412a-ba6c-c8c1bb821186"],

Cell["\<\
(2*Ae*g0*((dphidx*dtestdx + dphidy*dtestdy + dphidz*dtestdz)*mz - \
(dmzdx*dtestdx + dmzdy*dtestdy + dmzdz*dtestdz)*phi + 
       alpha*Ms*(dphidx*dtestdx*mx*my + dphidy*dtestdy*mx*my + \
dphidz*dtestdz*mx*my - 2*dmydx*dtestdx*mx*phi - 2*dmydy*dtestdy*mx*phi - 
          2*dmydz*dtestdz*mx*phi + dmxdx*dtestdx*my*phi + \
dmxdy*dtestdy*my*phi + dmxdz*dtestdz*my*phi - 
          (dmydx*dphidx*mx + dmydy*dphidy*mx + dmydz*dphidz*mx - \
2*dmxdx*dphidx*my - 2*dmxdy*dphidy*my - 2*dmxdz*dphidz*my + 
             dmxdx*dmydx*phi + dmxdy*dmydy*phi + dmxdz*dmydz*phi)*test)))/((1 \
+ Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{3.823150707766218*^9},
 CellLabel->
  "Out[136]//CForm=",ExpressionUUID->"2e52c13e-0bb0-4127-b2c0-9b534a85a1c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyEXCH", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[137]:=",ExpressionUUID->"2f885001-4c92-4b18-96b5-ac6c7d6913e7"],

Cell["\<\
(2*Ae*g0*(-(dphidx*dtestdx*mx) - dphidy*dtestdy*mx - dphidz*dtestdz*mx + \
alpha*dphidx*dtestdx*Ms*my*mz + 
       alpha*dphidy*dtestdy*Ms*my*mz + alpha*dphidz*dtestdz*Ms*my*mz + \
dmxdx*dtestdx*phi + dmxdy*dtestdy*phi + dmxdz*dtestdz*phi + 
       alpha*dmzdx*dtestdx*Ms*my*phi + alpha*dmzdy*dtestdy*Ms*my*phi + \
alpha*dmzdz*dtestdz*Ms*my*phi - 
       2*alpha*dmydx*dtestdx*Ms*mz*phi - 2*alpha*dmydy*dtestdy*Ms*mz*phi - \
2*alpha*dmydz*dtestdz*Ms*mz*phi + 
       alpha*Ms*(2*dmzdx*dphidx*my + 2*dmzdy*dphidy*my + 2*dmzdz*dphidz*my - \
(dmydx*dphidx + dmydy*dphidy + dmydz*dphidz)*mz - 
          (dmydx*dmzdx + dmydy*dmzdy + dmydz*dmzdz)*phi)*test))/((1 + \
Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{3.823150725322674*^9},
 CellLabel->
  "Out[137]//CForm=",ExpressionUUID->"8e8a3b50-54c1-4468-8813-8da1f2ca5a37"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzEXCH", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[138]:=",ExpressionUUID->"4c404825-052f-4a77-b71d-29e1e43b3840"],

Cell["\<\
(2*Ae*g0*(-(dphidx*dtestdx*my) - dphidy*dtestdy*my - dphidz*dtestdz*my + \
alpha*dphidx*dtestdx*Ms*mx*mz + 
       alpha*dphidy*dtestdy*Ms*mx*mz + alpha*dphidz*dtestdz*Ms*mx*mz + \
dmydx*dtestdx*phi + dmydy*dtestdy*phi + dmydz*dtestdz*phi - 
       2*alpha*dmzdx*dtestdx*Ms*mx*phi - 2*alpha*dmzdy*dtestdy*Ms*mx*phi - \
2*alpha*dmzdz*dtestdz*Ms*mx*phi + 
       alpha*dmxdx*dtestdx*Ms*mz*phi + alpha*dmxdy*dtestdy*Ms*mz*phi + \
alpha*dmxdz*dtestdz*Ms*mz*phi - 
       alpha*Ms*(dmzdx*dphidx*mx + dmzdy*dphidy*mx + dmzdz*dphidz*mx - \
2*dmxdx*dphidx*mz - 2*dmxdy*dphidy*mz - 2*dmxdz*dphidz*mz + 
          dmxdx*dmzdx*phi + dmxdy*dmzdy*phi + dmxdz*dmzdz*phi)*test))/((1 + \
Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{3.823150727179471*^9},
 CellLabel->
  "Out[138]//CForm=",ExpressionUUID->"f430233d-6b26-4ba9-9f6f-ef3c642ef6ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzEXCH", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[139]:=",ExpressionUUID->"2901b736-69f9-4f0c-934c-823e47423150"],

Cell["\<\
(2*Ae*g0*(dphidx*dtestdx*mx + dphidy*dtestdy*mx + dphidz*dtestdz*mx + \
alpha*dphidx*dtestdx*Ms*my*mz + alpha*dphidy*dtestdy*Ms*my*mz + 
       alpha*dphidz*dtestdz*Ms*my*mz - dmxdx*dtestdx*phi - dmxdy*dtestdy*phi \
- dmxdz*dtestdz*phi - 2*alpha*dmzdx*dtestdx*Ms*my*phi - 
       2*alpha*dmzdy*dtestdy*Ms*my*phi - 2*alpha*dmzdz*dtestdz*Ms*my*phi + \
alpha*dmydx*dtestdx*Ms*mz*phi + 
       alpha*dmydy*dtestdy*Ms*mz*phi + alpha*dmydz*dtestdz*Ms*mz*phi - 
       alpha*Ms*(dmzdx*dphidx*my + dmzdy*dphidy*my + dmzdz*dphidz*my - \
2*dmydx*dphidx*mz - 2*dmydy*dphidy*mz - 2*dmydz*dphidz*mz + 
          dmydx*dmzdx*phi + dmydy*dmzdy*phi + dmydz*dmzdz*phi)*test))/((1 + \
Power(alpha,2))*Power(Ms,2))\
\>", "Output",
 CellChangeTimes->{3.823150738361082*^9},
 CellLabel->
  "Out[139]//CForm=",ExpressionUUID->"56b656a2-79d6-4b65-9ef8-bd0e7f4cb418"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["        Kernel for interaction", "Section",
 CellChangeTimes->{{3.823151223451388*^9, 
  3.823151230767522*^9}},ExpressionUUID->"047aa2f6-b27c-4f3e-b5b0-\
37bb43990839"],

Cell[CellGroupData[{

Cell["        Residuals", "Subsection",
 CellChangeTimes->{{3.8231518724781446`*^9, 
  3.8231518770113993`*^9}},ExpressionUUID->"c33de142-c5fe-4952-85c9-\
acc18d1efc0c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHSmxINT", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"RHSmx", ",", "\[CapitalSigma]int"}], "]"}], "//", 
   "Expand"}]}]], "Input",
 CellChangeTimes->{{3.789719989727571*^9, 3.789719990847418*^9}, 
   3.790574309037211*^9, {3.790942214124803*^9, 3.790942214371675*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"194e88a0-6c82-4e75-8688-c8e7ec9ae10a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"d\[CapitalPhi]dz", " ", "my", " ", "\[Gamma]", " ", "\[Psi]h"}], 
   RowBox[{"Ms", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"d\[CapitalPhi]dy", " ", "mz", " ", "\[Gamma]", " ", "\[Psi]h"}], 
   RowBox[{"Ms", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
   "d\[CapitalPhi]dy", " ", "mx", " ", "my", " ", "\[Alpha]", " ", "\[Gamma]",
     " ", "\[Psi]h"}], 
   RowBox[{"1", "+", 
    SuperscriptBox["\[Alpha]", "2"]}]], "-", 
  FractionBox[
   RowBox[{"d\[CapitalPhi]dx", " ", 
    SuperscriptBox["my", "2"], " ", "\[Alpha]", " ", "\[Gamma]", " ", 
    "\[Psi]h"}], 
   RowBox[{"1", "+", 
    SuperscriptBox["\[Alpha]", "2"]}]], "+", 
  FractionBox[
   RowBox[{
   "d\[CapitalPhi]dz", " ", "mx", " ", "mz", " ", "\[Alpha]", " ", "\[Gamma]",
     " ", "\[Psi]h"}], 
   RowBox[{"1", "+", 
    SuperscriptBox["\[Alpha]", "2"]}]], "-", 
  FractionBox[
   RowBox[{"d\[CapitalPhi]dx", " ", 
    SuperscriptBox["mz", "2"], " ", "\[Alpha]", " ", "\[Gamma]", " ", 
    "\[Psi]h"}], 
   RowBox[{"1", "+", 
    SuperscriptBox["\[Alpha]", "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.788768371632365*^9, 3.788848948677628*^9, 3.788849352694433*^9, 
   3.788849728255604*^9, 3.789211066981797*^9, 3.7892114477929153`*^9, 
   3.789224772232357*^9, 3.789460202815075*^9, 3.789712913599732*^9, {
   3.789719971925721*^9, 3.789719991186401*^9}, 3.7897224335937643`*^9, {
   3.790574310385408*^9, 3.790574317812516*^9}, 3.790577305334509*^9, 
   3.790577383583762*^9, 3.790938920492763*^9, 3.790939185494164*^9, 
   3.790942215065105*^9, 3.790945692165905*^9, 3.791268669736842*^9, 
   3.791269069819805*^9, 3.793683604206596*^9, 3.8067388332840023`*^9, 
   3.806739721539978*^9, 3.806742174395669*^9, 3.819453650754521*^9, 
   3.823151812998564*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"047e7cc0-7a84-4b5c-b872-e0cfb4e93fe0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmxINT", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[148]:=",ExpressionUUID->"d1d9d50f-cc42-4e5a-9223-21a3ceb6388e"],

Cell["\<\
(g0*(-(dPotdy*mz) + dPotdz*(my + alpha*Ms*mx*mz) + alpha*Ms*(dPotdy*mx*my - \
dPotdx*(Power(my,2) + Power(mz,2))))*test)/
   ((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.823151822914668*^9, 3.823151865415551*^9},
 CellLabel->
  "Out[148]//CForm=",ExpressionUUID->"d4e36dd5-f178-4a14-b8fb-88322731aff2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHSmyINT", "=", 
  RowBox[{"D", "[", 
   RowBox[{"RHSmy", ",", "\[CapitalSigma]int"}], "]"}]}]], "Input",
 CellLabel->
  "In[149]:=",ExpressionUUID->"fef6e744-d8ee-4796-95fa-5f4a2415a3e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"d\[CapitalPhi]dz", " ", "mx", " ", "\[Gamma]"}], 
      RowBox[{"Ms", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]]}], "+", 
    FractionBox[
     RowBox[{"d\[CapitalPhi]dx", " ", "mz", " ", "\[Gamma]"}], 
     RowBox[{"Ms", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"d\[CapitalPhi]dy", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]", " ", "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "+", 
    FractionBox[
     RowBox[{
     "d\[CapitalPhi]dx", " ", "mx", " ", "my", " ", "\[Alpha]", " ", 
      "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "+", 
    FractionBox[
     RowBox[{
     "d\[CapitalPhi]dz", " ", "my", " ", "mz", " ", "\[Alpha]", " ", 
      "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "-", 
    FractionBox[
     RowBox[{"d\[CapitalPhi]dy", " ", 
      SuperscriptBox["mz", "2"], " ", "\[Alpha]", " ", "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]]}], ")"}], " ", "\[Psi]h"}]], "Output",\

 CellChangeTimes->{{3.823151838686267*^9, 3.82315186611779*^9}},
 CellLabel->
  "Out[149]=",ExpressionUUID->"44078560-d20a-4a05-9779-8e2bcadf291f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmyINT", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[147]:=",ExpressionUUID->"1b4cd2d3-9915-4293-8527-dd7e4addac93"],

Cell["\<\
(g0*(dPotdx*mz + dPotdz*(-mx + alpha*Ms*my*mz) + alpha*Ms*(dPotdx*mx*my - \
dPotdy*(Power(mx,2) + Power(mz,2))))*test)/
   ((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{{3.823151839807111*^9, 3.8231518639351587`*^9}},
 CellLabel->
  "Out[147]//CForm=",ExpressionUUID->"8ac9fe2d-ff1a-4488-82ff-f548709e8075"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHSmzINT", "=", 
  RowBox[{"D", "[", 
   RowBox[{"RHSmz", ",", "\[CapitalSigma]int"}], "]"}]}]], "Input",
 CellLabel->
  "In[146]:=",ExpressionUUID->"49aa4302-5dac-4ad3-8d44-d64c3ad0c7e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{"d\[CapitalPhi]dy", " ", "mx", " ", "\[Gamma]"}], 
     RowBox[{"Ms", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"d\[CapitalPhi]dx", " ", "my", " ", "\[Gamma]"}], 
     RowBox[{"Ms", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"d\[CapitalPhi]dz", " ", 
      SuperscriptBox["mx", "2"], " ", "\[Alpha]", " ", "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "-", 
    FractionBox[
     RowBox[{"d\[CapitalPhi]dz", " ", 
      SuperscriptBox["my", "2"], " ", "\[Alpha]", " ", "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "+", 
    FractionBox[
     RowBox[{
     "d\[CapitalPhi]dx", " ", "mx", " ", "mz", " ", "\[Alpha]", " ", 
      "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "+", 
    FractionBox[
     RowBox[{
     "d\[CapitalPhi]dy", " ", "my", " ", "mz", " ", "\[Alpha]", " ", 
      "\[Gamma]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]]}], ")"}], " ", "\[Psi]h"}]], "Output",\

 CellChangeTimes->{{3.823151849381711*^9, 3.823151863347665*^9}},
 CellLabel->
  "Out[146]=",ExpressionUUID->"17d33e19-a22d-48f3-9673-aa87726ea5fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmzINT", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[145]:=",ExpressionUUID->"f1755b89-03dd-4ba0-b81e-50bdfda97df2"],

Cell["\<\
(g0*(-(dPotdx*my) + alpha*Ms*(-(dPotdz*(Power(mx,2) + Power(my,2))) + \
dPotdx*mx*mz) + dPotdy*(mx + alpha*Ms*my*mz))*test)/
   ((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.823151862293811*^9},
 CellLabel->
  "Out[145]//CForm=",ExpressionUUID->"88a34cc3-9ee9-4722-addb-6fabc0277098"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        On-diagonal jacobian entries", "Subsection",
 CellChangeTimes->{{3.823151882742093*^9, 
  3.8231518961697817`*^9}},ExpressionUUID->"c1c54794-7876-4f07-86a4-\
c16a3b25c713"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxINT", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[150]:=",ExpressionUUID->"6643024b-06ee-4b94-9e3c-a506dbe602e2"],

Cell["\<\
(alpha*g0*(dPotdy*my + dPotdz*mz)*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{3.823152007398583*^9},
 CellLabel->
  "Out[150]//CForm=",ExpressionUUID->"7f2710fa-eba4-4084-b1b5-df9e8bd0e075"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyINT", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[151]:=",ExpressionUUID->"27d9e5f9-0efd-4419-bc7b-ccf5decee5b3"],

Cell["\<\
(alpha*g0*(dPotdx*mx + dPotdz*mz)*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{3.823152015385253*^9},
 CellLabel->
  "Out[151]//CForm=",ExpressionUUID->"ec6820f6-f322-4f22-896f-860335cededc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzINT", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[152]:=",ExpressionUUID->"b8f30609-920e-483c-881a-6a5ee0816950"],

Cell["\<\
(alpha*g0*(dPotdx*mx + dPotdy*my)*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{3.823152022656448*^9},
 CellLabel->
  "Out[152]//CForm=",ExpressionUUID->"9b0e21a2-ee64-49b8-9458-9e7284fb648b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        Off-diagonal jacobian entries", "Subsection",
 CellChangeTimes->{{3.82315188971838*^9, 
  3.8231518965418987`*^9}},ExpressionUUID->"c15ae1f0-d8d7-4437-8ff6-\
4861cddc5991"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxINT", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[153]:=",ExpressionUUID->"2fee91e9-9fb7-4b56-81ac-e599d3bdddc0"],

Cell["\<\
(g0*(dPotdz + alpha*Ms*(dPotdy*mx - 2*dPotdx*my))*phi*test)/((1 + \
Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.82315204599724*^9},
 CellLabel->
  "Out[153]//CForm=",ExpressionUUID->"27f0722a-5f93-4306-a3a6-23a817669a05"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxINT", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[154]:=",ExpressionUUID->"85eed928-eb68-4283-8ee5-fdb84daba9c5"],

Cell["\<\
(g0*(-dPotdy + alpha*Ms*(dPotdz*mx - 2*dPotdx*mz))*phi*test)/((1 + \
Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.82315204696579*^9},
 CellLabel->
  "Out[154]//CForm=",ExpressionUUID->"bb1fab76-80fd-438a-a454-90e4bc20e59f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"RHSmxINT", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d\[CapitalPhi]dx", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dx", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dy", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dy", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dz", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dz", "[", "\[CapitalPhi]0", "]"}]}]}], 
        "}"}]}], ",", "\[CapitalPhi]0"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dx", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidx"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dy", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidy"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dz", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidz"}]}], "}"}]}], "//", "FullSimplify"}], "//", 
  "CForm"}]], "Input",
 CellLabel->
  "In[155]:=",ExpressionUUID->"c5310808-7a86-4aca-86f1-2dc8b03a5a71"],

Cell["\<\
(g0*(-(dphidy*mz) + dphidz*(my + alpha*Ms*mx*mz) + alpha*Ms*(dphidy*mx*my - \
dphidx*(Power(my,2) + Power(mz,2))))*test)/
   ((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.8231520604855413`*^9},
 CellLabel->
  "Out[155]//CForm=",ExpressionUUID->"7dbe93dc-2281-4ddd-b8be-e01c189814c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyINT", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[156]:=",ExpressionUUID->"54478118-094d-4150-a7a0-fd0ba26d26ee"],

Cell["\<\
-((g0*(dPotdz + alpha*Ms*(2*dPotdy*mx - dPotdx*my))*phi*test)/((1 + \
Power(alpha,2))*Ms))\
\>", "Output",
 CellChangeTimes->{3.8231520957585173`*^9},
 CellLabel->
  "Out[156]//CForm=",ExpressionUUID->"8b8d4dc8-63bf-43f8-bced-b53644c87b8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyINT", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[157]:=",ExpressionUUID->"f21aa3ee-56b4-4544-8332-e60833e1073f"],

Cell["\<\
(g0*(dPotdx + alpha*Ms*(dPotdz*my - 2*dPotdy*mz))*phi*test)/((1 + \
Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.8231521035428762`*^9},
 CellLabel->
  "Out[157]//CForm=",ExpressionUUID->"9e7bad4d-e012-46e0-9d48-48d4d8776594"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"RHSmyINT", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d\[CapitalPhi]dx", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dx", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dy", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dy", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dz", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dz", "[", "\[CapitalPhi]0", "]"}]}]}], 
        "}"}]}], ",", "\[CapitalPhi]0"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dx", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidx"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dy", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidy"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dz", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidz"}]}], "}"}]}], "//", "FullSimplify"}], "//", 
  "CForm"}]], "Input",
 CellLabel->
  "In[158]:=",ExpressionUUID->"fe961710-f123-46dd-a4a7-2b32ecb51a64"],

Cell["\<\
(g0*(dphidx*mz + dphidz*(-mx + alpha*Ms*my*mz) + alpha*Ms*(dphidx*mx*my - \
dphidy*(Power(mx,2) + Power(mz,2))))*test)/
   ((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.8231521128381243`*^9},
 CellLabel->
  "Out[158]//CForm=",ExpressionUUID->"f08596f2-0be0-4098-9fd9-03fb2f5ab5f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzINT", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[159]:=",ExpressionUUID->"026b227b-06d5-4b86-b817-fbe30d84c9a3"],

Cell["\<\
(g0*(dPotdy + alpha*Ms*(-2*dPotdz*mx + dPotdx*mz))*phi*test)/((1 + \
Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.823152131826785*^9},
 CellLabel->
  "Out[159]//CForm=",ExpressionUUID->"8fc9139b-4fa1-4342-a364-52951259d3b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzINT", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[160]:=",ExpressionUUID->"75072a16-1b23-449c-80bf-180ba8bf557b"],

Cell["\<\
-((g0*(dPotdx + alpha*Ms*(2*dPotdz*my - dPotdy*mz))*phi*test)/((1 + \
Power(alpha,2))*Ms))\
\>", "Output",
 CellChangeTimes->{3.823152140864798*^9},
 CellLabel->
  "Out[160]//CForm=",ExpressionUUID->"6047f7a9-8fb2-487b-8309-47b85abe798a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"RHSmzINT", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d\[CapitalPhi]dx", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dx", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dy", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dy", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dz", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dz", "[", "\[CapitalPhi]0", "]"}]}]}], 
        "}"}]}], ",", "\[CapitalPhi]0"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
      RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
      RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dx", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidx"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dy", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidy"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dz", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidz"}]}], "}"}]}], "//", "FullSimplify"}], "//", 
  "CForm"}]], "Input",
 CellLabel->
  "In[161]:=",ExpressionUUID->"59732993-10a7-408f-b7a2-63ae9d8de1e7"],

Cell["\<\
(g0*(-(dphidx*my) + alpha*Ms*(-(dphidz*(Power(mx,2) + Power(my,2))) + \
dphidx*mx*mz) + dphidy*(mx + alpha*Ms*my*mz))*test)/
   ((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{3.8231521493397017`*^9},
 CellLabel->
  "Out[161]//CForm=",ExpressionUUID->"837849d5-41d2-4622-b1be-b37a716549eb"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["        Kernel for anisotropy", "Section",
 CellChangeTimes->{{3.823151234995804*^9, 3.823151237130513*^9}, 
   3.8231513098935337`*^9, {3.82315264226467*^9, 
   3.823152648684462*^9}},ExpressionUUID->"20d7a4b4-184d-4755-9e53-\
90540003931c"],

Cell[CellGroupData[{

Cell["        Residuals", "Subsection",
 CellChangeTimes->{{3.823152684894875*^9, 
  3.823152690985876*^9}},ExpressionUUID->"cd211fbc-351b-496a-89c0-\
ca785cd0d290"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHSmxANIS", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"RHSmx", ",", "\[CapitalSigma]anis"}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7936837282263727`*^9, 3.793683740025003*^9}, {
   3.793686275553967*^9, 3.793686288706811*^9}, {3.7936896126371593`*^9, 
   3.793689616608951*^9}, 3.805454599443227*^9, {3.8054546616787157`*^9, 
   3.805454701118083*^9}, {3.8066705649573183`*^9, 3.806670586607864*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"3d4abe0b-62c2-417f-a6bc-897ee613e099"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "K1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"mx", " ", "nx"}], "+", 
     RowBox[{"my", " ", "ny"}], "+", 
     RowBox[{"mz", " ", "nz"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "Ms"}], " ", 
      SuperscriptBox["mz", "2"], " ", "nx", " ", "\[Alpha]"}], "+", 
     RowBox[{"my", " ", 
      RowBox[{"(", 
       RowBox[{"nz", "+", 
        RowBox[{"Ms", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "my"}], " ", "nx"}], "+", 
           RowBox[{"mx", " ", "ny"}]}], ")"}], " ", "\[Alpha]"}]}], ")"}]}], 
     "+", 
     RowBox[{"mz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "ny"}], "+", 
        RowBox[{"Ms", " ", "mx", " ", "nz", " ", "\[Alpha]"}]}], ")"}]}]}], 
    ")"}], " ", "\[Gamma]", " ", "\[Psi]h"}], 
  RowBox[{
   SuperscriptBox["Ms", "3"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.7936837302096024`*^9, 3.793683740418088*^9}, 
   3.7936839901231337`*^9, {3.793686276681919*^9, 3.793686289026273*^9}, 
   3.7936882039771757`*^9, 3.793688268151649*^9, 3.793688356956215*^9, {
   3.793689611165124*^9, 3.793689617565627*^9}, {3.805454659571197*^9, 
   3.8054547016613483`*^9}, {3.80667058306112*^9, 3.806670586953286*^9}, 
   3.806738839243154*^9, 3.806739725618174*^9, 3.823152676114403*^9},
 CellLabel->
  "Out[163]=",ExpressionUUID->"b1350e0e-3199-49b2-a841-f386405ff653"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"RHSmx", ",", "\[CapitalSigma]anis"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.793684633672611*^9, 3.7936846347692337`*^9}, {
  3.793685099660344*^9, 3.793685135916422*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"4dc2ce33-c844-4320-9d53-78f637ddf159"],

Cell["\<\
(2*g0*K1*(mx*nx + my*ny + mz*nz)*(-(mz*ny) + my*nz + \
alpha*Ms*(-(Power(my,2)*nx) + mx*my*ny + mz*(-(mz*nx) + mx*nz)))*psi)/
   ((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{
  3.793684635185522*^9, {3.7936851129410143`*^9, 3.7936851366856127`*^9}, 
   3.793688357797451*^9, 3.8066466265980597`*^9, 3.80667060135433*^9, 
   3.806738839439707*^9, 3.806739725772284*^9, 3.823152698738182*^9},
 CellLabel->
  "Out[164]//CForm=",ExpressionUUID->"89f67057-e0e0-4068-908b-f46d1d931091"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHSmyANIS", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"RHSmy", ",", "\[CapitalSigma]anis"}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7936839947085867`*^9, 3.7936839968741617`*^9}, {
   3.793686267673934*^9, 3.793686292180025*^9}, 3.8054547056084213`*^9, {
   3.806670573145239*^9, 3.806670598408065*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"da2fccd4-774d-43d1-8e7d-42f6ca04c3d1"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "K1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"mx", " ", "nx"}], "+", 
      RowBox[{"my", " ", "ny"}], "+", 
      RowBox[{"mz", " ", "nz"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Ms", " ", 
       SuperscriptBox["mz", "2"], " ", "ny", " ", "\[Alpha]"}], "+", 
      RowBox[{"mx", " ", 
       RowBox[{"(", 
        RowBox[{"nz", "+", 
         RowBox[{"Ms", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "my"}], " ", "nx"}], "+", 
            RowBox[{"mx", " ", "ny"}]}], ")"}], " ", "\[Alpha]"}]}], ")"}]}], 
      "-", 
      RowBox[{"mz", " ", 
       RowBox[{"(", 
        RowBox[{"nx", "+", 
         RowBox[{"Ms", " ", "my", " ", "nz", " ", "\[Alpha]"}]}], ")"}]}]}], 
     ")"}], " ", "\[Gamma]", " ", "\[Psi]h"}], 
   RowBox[{
    SuperscriptBox["Ms", "3"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.793683997289197*^9, {3.793686272280545*^9, 3.793686292457985*^9}, {
   3.793688336655774*^9, 3.7936883585543737`*^9}, {3.805454689513319*^9, 
   3.805454706055525*^9}, 3.806670598736536*^9, 3.806738839739691*^9, 
   3.8067397259306393`*^9, 3.823152718594288*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"5b611af6-edef-4406-96e2-820e207ae755"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"RHSmy", ",", "\[CapitalSigma]anis"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.79368464340898*^9, 3.793684644936432*^9}, 
   3.793685142391006*^9},
 CellLabel->
  "In[166]:=",ExpressionUUID->"80484777-95b7-423a-a47d-d9fa714402fb"],

Cell["\<\
(-2*g0*K1*(mx*nx + my*ny + mz*nz)*(-(mz*nx) + mx*nz + alpha*Ms*(-(mx*my*nx) + \
Power(mx,2)*ny + mz*(mz*ny - my*nz)))*psi)/
   ((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.7936846453645144`*^9, 3.793685145202984*^9, 
  3.7936883594126053`*^9, 3.805454707574782*^9, 3.806670969198398*^9, 
  3.806738839754539*^9, 3.8067397260905657`*^9, 3.823152719567428*^9},
 CellLabel->
  "Out[166]//CForm=",ExpressionUUID->"fed9c463-e084-4556-b60f-90d547aa5222"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHSmzANIS", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"RHSmz", ",", "\[CapitalSigma]anis"}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7936840038757153`*^9, 3.793684006226294*^9}, 
   3.805454709610236*^9, 3.8066705778954287`*^9, {3.806670970099453*^9, 
   3.806670971562399*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"d6535aa0-3bd2-41d9-9a32-2323c290e62c"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "K1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"mx", " ", "nx"}], "+", 
      RowBox[{"my", " ", "ny"}], "+", 
      RowBox[{"mz", " ", "nz"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "mx"}], " ", "ny"}], "+", 
      RowBox[{"Ms", " ", 
       SuperscriptBox["my", "2"], " ", "nz", " ", "\[Alpha]"}], "+", 
      RowBox[{"Ms", " ", "mx", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "mz"}], " ", "nx"}], "+", 
         RowBox[{"mx", " ", "nz"}]}], ")"}], " ", "\[Alpha]"}], "+", 
      RowBox[{"my", " ", 
       RowBox[{"(", 
        RowBox[{"nx", "-", 
         RowBox[{"Ms", " ", "mz", " ", "ny", " ", "\[Alpha]"}]}], ")"}]}]}], 
     ")"}], " ", "\[Gamma]", " ", "\[Psi]h"}], 
   RowBox[{
    SuperscriptBox["Ms", "3"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.793684006594008*^9, 3.793688360200121*^9, 3.805454710026421*^9, {
   3.806670968046197*^9, 3.806670971889991*^9}, 3.8067388399614477`*^9, 
   3.806739726332405*^9, 3.82315272043937*^9},
 CellLabel->
  "Out[167]=",ExpressionUUID->"7257df2d-159f-4617-bf9b-589b8c420d64"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"RHSmz", ",", "\[CapitalSigma]anis"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.793684650825317*^9, 3.793684651841311*^9}, 
   3.793685143762727*^9},
 CellLabel->
  "In[168]:=",ExpressionUUID->"efc77100-988a-4d29-a9e1-870be39f9172"],

Cell["\<\
(-2*g0*K1*(mx*nx + my*ny + mz*nz)*(my*(nx - alpha*Ms*mz*ny) + \
alpha*Ms*Power(my,2)*nz + mx*(-(alpha*Ms*mz*nx) - ny + alpha*Ms*mx*nz))*
     psi)/((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.793684652177547*^9, 3.7936851445908327`*^9, 
  3.793688361330283*^9, 3.806670973903376*^9, 3.8067388401735897`*^9, 
  3.8067397264903183`*^9, 3.8231527213792963`*^9},
 CellLabel->
  "Out[168]//CForm=",ExpressionUUID->"3f2c061a-4ec0-491d-9ad5-268370540a4f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        On-diagonal jacobian entries:", "Subsection",
 CellChangeTimes->{{3.8231527304690437`*^9, 
  3.8231527655988493`*^9}},ExpressionUUID->"a7edf84f-cb69-42b0-baa0-\
4bb19a2d8660"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxANIS", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[169]:=",ExpressionUUID->"1c4043d6-6bec-4b21-98a3-2c707dce71b2"],

Cell["\<\
(2*g0*K1*(-(mz*nx*ny) + my*nx*nz + alpha*Ms*(Power(my,2)*(-Power(nx,2) + \
Power(ny,2)) + 2*my*ny*(mx*nx + mz*nz) + 
          mz*(-(mz*Power(nx,2)) + 2*mx*nx*nz + mz*Power(nz,2))))*phi*psi)/((1 \
+ Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.8231527457955008`*^9},
 CellLabel->
  "Out[169]//CForm=",ExpressionUUID->"e21af621-c416-4801-95c1-b0a4a7ee47bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyANIS", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[170]:=",ExpressionUUID->"16490150-e32e-4caa-afd9-fb531933eaf6"],

Cell["\<\
(2*g0*K1*(ny*(mz*nx - mx*nz) + alpha*Ms*(Power(mx,2)*(nx - ny)*(nx + ny) + \
2*mx*nx*(my*ny + mz*nz) + 
          mz*(-(mz*Power(ny,2)) + 2*my*ny*nz + mz*Power(nz,2))))*phi*psi)/((1 \
+ Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.82315274905449*^9},
 CellLabel->
  "Out[170]//CForm=",ExpressionUUID->"7e2bbf59-c1a0-4f01-8d5b-db7f433cb920"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzANIS", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[171]:=",ExpressionUUID->"fa1acfb3-c08d-4e6f-8c97-c34b80385126"],

Cell["\<\
(2*g0*K1*(-(my*nx*nz) + mx*ny*nz + alpha*Ms*(Power(mx*nx + my*ny,2) + \
2*mz*(mx*nx + my*ny)*nz - 
          (Power(mx,2) + Power(my,2))*Power(nz,2)))*phi*psi)/((1 + \
Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.823152752095683*^9},
 CellLabel->
  "Out[171]//CForm=",ExpressionUUID->"a8dde704-0677-4a18-a302-9ad54c201124"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        Off-diagonal jacobian entries:", "Subsection",
 CellChangeTimes->{{3.823152768268887*^9, 
  3.823152776226118*^9}},ExpressionUUID->"cf5f258c-db07-4f24-91f6-\
e7340f7f17bd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxANIS", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[172]:=",ExpressionUUID->"4da72b83-b70b-400f-8c72-03863e37d17b"],

Cell["\<\
(2*g0*K1*(-(mz*Power(ny,2)) + mx*nx*nz + 2*my*ny*nz + mz*Power(nz,2) + 
       alpha*Ms*(Power(mx,2)*nx*ny - nx*(3*Power(my,2)*ny + Power(mz,2)*ny + \
2*my*mz*nz) + 
          2*mx*(-(my*Power(nx,2)) + my*Power(ny,2) + mz*ny*nz)))*phi*psi)/((1 \
+ Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.823152818548811*^9},
 CellLabel->
  "Out[172]//CForm=",ExpressionUUID->"14b30260-97ea-46f9-9fa8-2f5d71c27090"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxANIS", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[173]:=",ExpressionUUID->"f31c41cb-cd5f-421a-81f9-19aaae87ef6a"],

Cell["\<\
(2*g0*K1*(-((2*alpha*Ms*mz*nx + ny)*(mx*nx + my*ny)) - 2*mz*ny*nz + 
       alpha*Ms*(Power(mx,2)*nx - (Power(my,2) + 3*Power(mz,2))*nx + \
2*mx*my*ny)*nz + (my + 2*alpha*Ms*mx*mz)*Power(nz,2))*phi*psi)/
   ((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.8231528196250563`*^9},
 CellLabel->
  "Out[173]//CForm=",ExpressionUUID->"75f13465-c166-4636-ac9b-c963dbe0d85c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyANIS", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[174]:=",ExpressionUUID->"59dfb573-81ba-4e50-87b7-fb84f134d6df"],

Cell["\<\
(-2*g0*K1*(-(mz*Power(nx,2)) + 2*mx*nx*nz + my*ny*nz + mz*Power(nz,2) + 
       alpha*Ms*(3*Power(mx,2)*nx*ny + nx*(-(Power(my,2)*ny) + Power(mz,2)*ny \
- 2*my*mz*nz) + 
          2*mx*(-(my*Power(nx,2)) + my*Power(ny,2) + mz*ny*nz)))*phi*psi)/((1 \
+ Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.82315282093994*^9},
 CellLabel->
  "Out[174]//CForm=",ExpressionUUID->"5f4e8ffe-9423-411b-b1d1-e1a031c95541"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyANIS", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[175]:=",ExpressionUUID->"5db78344-106e-406c-9345-fe7172a62cad"],

Cell["\<\
(2*g0*K1*((mx*nx + my*ny)*(nx - 2*alpha*Ms*mz*ny) + 2*(alpha*Ms*mx*my + \
mz)*nx*nz + 
       alpha*Ms*(-Power(mx,2) + Power(my,2) - 3*Power(mz,2))*ny*nz - (mx - \
2*alpha*Ms*my*mz)*Power(nz,2))*phi*psi)/
   ((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.823152822067833*^9},
 CellLabel->
  "Out[175]//CForm=",ExpressionUUID->"904cc4c3-9ea0-4182-91fd-5089907ce223"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzANIS", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[176]:=",ExpressionUUID->"67e6d9bd-91c1-4060-bb00-a6cc113adff2"],

Cell["\<\
(2*g0*K1*(-(alpha*Ms*Power(my,2)*nx*nz) + ny*(2*mx*nx + mz*nz) + 
       alpha*Ms*(-3*Power(mx,2)*nx*nz + Power(mz,2)*nx*nz + 2*mx*mz*(nx - \
nz)*(nx + nz)) + 
       my*(-Power(nx,2) + 2*alpha*Ms*mz*nx*ny + ny*(ny - \
2*alpha*Ms*mx*nz)))*phi*psi)/((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.82315282306927*^9},
 CellLabel->
  "Out[176]//CForm=",ExpressionUUID->"a67c4e24-cb5b-48f3-b923-2f71a45651de"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzANIS", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "psi"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[177]:=",ExpressionUUID->"b25ed57b-4d62-4949-8c67-89a3dbbf4956"],

Cell["\<\
(-2*g0*K1*(alpha*Ms*Power(mx,2)*ny*nz + 3*alpha*Ms*Power(my,2)*ny*nz + mz*(nx \
- alpha*Ms*mz*ny)*nz + 
       mx*(Power(nx,2) - Power(ny,2) + 2*alpha*Ms*nx*(-(mz*ny) + my*nz)) + \
2*my*(nx*ny + alpha*Ms*mz*(-Power(ny,2) + Power(nz,2))))*phi*
     psi)/((1 + Power(alpha,2))*Power(Ms,3))\
\>", "Output",
 CellChangeTimes->{3.823152824644224*^9},
 CellLabel->
  "Out[177]//CForm=",ExpressionUUID->"18d31623-a116-47fa-a00a-e20438305dc0"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "        Kernel for LLB ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Alpha]", "LL"], "(", 
      RowBox[{
       StyleBox["m",
        FontWeight->"Bold"], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["H",
        FontWeight->"Bold"]}], ")"}], " ", "=", " ", 
     RowBox[{
      SubscriptBox["\[Alpha]", "LL"], " ", 
      FractionBox[
       RowBox[{"\[Gamma]", " "}], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[Alpha]", "2"]}], ")"}]], " ", 
      RowBox[{
       SuperscriptBox["m", "2"], "(", 
       RowBox[{
        SuperscriptBox["m", "2"], "-", "1"}], ")"}], 
      StyleBox["m",
       FontWeight->"Bold"]}]}], "]"}], TraditionalForm]],ExpressionUUID->
  "f569cfd9-7942-4884-a5de-3eac4480b35a"]
}], "Section",
 CellChangeTimes->{{3.823151241835174*^9, 3.823151243354587*^9}, 
   3.823151310481769*^9, {3.823152178201023*^9, 3.823152197225645*^9}, {
   3.823152310638907*^9, 
   3.823152355702224*^9}},ExpressionUUID->"663533f7-cd90-4ac3-abb4-\
07c6984ab1ca"],

Cell[CellGroupData[{

Cell["        Residuals:", "Subsection",
 CellChangeTimes->{{3.823152297829833*^9, 
  3.8231523027622766`*^9}},ExpressionUUID->"fcfaabf0-3cb1-4b23-8012-\
7b126e55e0bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]0", " ", 
    FractionBox[
     RowBox[{"\[Alpha]ll", " "}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Alpha]", "2"]}]], "*", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["mx", "2"], "+", 
      SuperscriptBox["my", "2"], "+", 
      SuperscriptBox["mz", "2"]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["mx", "2"], "+", 
      SuperscriptBox["my", "2"], "+", 
      SuperscriptBox["mz", "2"], "-", "1"}], ")"}], 
    RowBox[{"{", 
     RowBox[{"mx", ",", "my", ",", "mz"}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]ll", "\[Rule]", "alphaLL"}], ",", 
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]0", "\[Rule]", "g0"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellLabel->
  "In[162]:=",ExpressionUUID->"2dba5e94-21f3-4fe6-b07e-6ff6affab9fa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"alphaLL", " ", "g0", " ", "mx", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["mx", "2"], "+", 
       SuperscriptBox["my", "2"], "+", 
       SuperscriptBox["mz", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["mx", "2"], "+", 
       SuperscriptBox["my", "2"], "+", 
       SuperscriptBox["mz", "2"]}], ")"}]}], 
    RowBox[{"1", "+", 
     SuperscriptBox["alpha", "2"]}]], ",", 
   FractionBox[
    RowBox[{"alphaLL", " ", "g0", " ", "my", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["mx", "2"], "+", 
       SuperscriptBox["my", "2"], "+", 
       SuperscriptBox["mz", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["mx", "2"], "+", 
       SuperscriptBox["my", "2"], "+", 
       SuperscriptBox["mz", "2"]}], ")"}]}], 
    RowBox[{"1", "+", 
     SuperscriptBox["alpha", "2"]}]], ",", 
   FractionBox[
    RowBox[{"alphaLL", " ", "g0", " ", "mz", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["mx", "2"], "+", 
       SuperscriptBox["my", "2"], "+", 
       SuperscriptBox["mz", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["mx", "2"], "+", 
       SuperscriptBox["my", "2"], "+", 
       SuperscriptBox["mz", "2"]}], ")"}]}], 
    RowBox[{"1", "+", 
     SuperscriptBox["alpha", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.8231523057320747`*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"3031d4aa-9c72-4f4d-ade6-eca7787fbf08"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["        On-diagonal jacobian entries:", "Subsection",
 CellChangeTimes->{{3.8231523930363503`*^9, 
  3.823152413827661*^9}},ExpressionUUID->"0cf55a52-f41e-4a3b-a912-\
3b57e376b561"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Gamma]0", " ", 
           FractionBox[
            RowBox[{"\[Alpha]ll", " "}], 
            RowBox[{"1", "+", 
             SuperscriptBox["\[Alpha]", "2"]}]], "*", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mx", "2"], "+", 
             SuperscriptBox["my", "2"], "+", 
             SuperscriptBox["mz", "2"]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mx", "2"], "+", 
             SuperscriptBox["my", "2"], "+", 
             SuperscriptBox["mz", "2"], "-", "1"}], ")"}], 
           RowBox[{"{", 
            RowBox[{"mx", ",", "my", ",", "mz"}], "}"}]}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/.", "algFEM1"}], ",", "m0x"}], 
      "]"}], "/.", "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]ll", "\[Rule]", "alphaLL"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]0", "\[Rule]", "g0"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.7927386125227213`*^9, 3.792738667324563*^9}, 
   3.792738702415381*^9, 
   3.792741241620014*^9},ExpressionUUID->"d829af12-81ad-40e6-9ce5-\
d90035b5baae"],

Cell["\<\
(alphaLL*g0*(5*Power(mx,4) + (-1 + Power(my,2) + Power(mz,2))*(Power(my,2) + \
Power(mz,2)) + Power(mx,2)*(-3 + 6*Power(my,2) + 6*Power(mz,2)))*phi)/(1 + \
Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{{3.7927386349284983`*^9, 3.7927387029582853`*^9}, 
   3.792741242271716*^9, 3.793683632736528*^9, 3.80673883709032*^9, 
   3.8067397242874804`*^9, 
   3.806742180507421*^9},ExpressionUUID->"4085d93e-e97c-49dd-8299-\
a9afff28681d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Gamma]0", " ", 
           FractionBox[
            RowBox[{"\[Alpha]ll", " "}], 
            RowBox[{"1", "+", 
             SuperscriptBox["\[Alpha]", "2"]}]], "*", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mx", "2"], "+", 
             SuperscriptBox["my", "2"], "+", 
             SuperscriptBox["mz", "2"]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mx", "2"], "+", 
             SuperscriptBox["my", "2"], "+", 
             SuperscriptBox["mz", "2"], "-", "1"}], ")"}], 
           RowBox[{"{", 
            RowBox[{"mx", ",", "my", ",", "mz"}], "}"}]}], ")"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/.", "algFEM1"}], ",", "m0y"}], 
      "]"}], "/.", "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]ll", "\[Rule]", "alphaLL"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]0", "\[Rule]", "g0"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.7927386762516937`*^9, 3.7927387010531483`*^9}, 
   3.792741240404998*^9},ExpressionUUID->"90de07be-d2e4-4c42-b6d7-\
aca865e0ead2"],

Cell["\<\
(alphaLL*g0*(Power(mx,4) + 5*Power(my,4) - Power(mz,2) + Power(mz,4) + \
Power(mx,2)*(-1 + 6*Power(my,2) + 2*Power(mz,2)) + Power(my,2)*(-3 + \
6*Power(mz,2)))*phi)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{{3.792738679207881*^9, 3.79273870141928*^9}, 
   3.7927412409945517`*^9, 3.793683633820573*^9, 3.806738837308495*^9, 
   3.8067397244176292`*^9, 
   3.806742180897624*^9},ExpressionUUID->"8a317554-90eb-4ac4-bf34-\
3b65e14b5d22"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Gamma]0", " ", 
           FractionBox[
            RowBox[{"\[Alpha]ll", " "}], 
            RowBox[{"1", "+", 
             SuperscriptBox["\[Alpha]", "2"]}]], "*", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mx", "2"], "+", 
             SuperscriptBox["my", "2"], "+", 
             SuperscriptBox["mz", "2"]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mx", "2"], "+", 
             SuperscriptBox["my", "2"], "+", 
             SuperscriptBox["mz", "2"], "-", "1"}], ")"}], 
           RowBox[{"{", 
            RowBox[{"mx", ",", "my", ",", "mz"}], "}"}]}], ")"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/.", "algFEM1"}], ",", "m0z"}], 
      "]"}], "/.", "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]ll", "\[Rule]", "alphaLL"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]0", "\[Rule]", "g0"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.792738682540381*^9, 3.792738699115341*^9}, 
   3.7927412390449343`*^9},ExpressionUUID->"ee8d5562-8c5a-4001-a560-\
b165fcad7b90"],

Cell["\<\
(alphaLL*g0*(Power(mx,4) + Power(my,4) - 3*Power(mz,2) + 5*Power(mz,4) + \
Power(my,2)*(-1 + 6*Power(mz,2)) + Power(mx,2)*(-1 + 2*Power(my,2) + \
6*Power(mz,2)))*phi)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{{3.792738684587799*^9, 3.7927386995579967`*^9}, 
   3.7927412396799173`*^9, 3.793683634618815*^9, 3.806738837749178*^9, 
   3.806739724546715*^9, 
   3.806742181265965*^9},ExpressionUUID->"37f4a706-1f6b-44f1-bbc3-\
4caf99adfecd"]
}, Open  ]]
}, Closed]],

Cell["        Off-diagonal jacobian entries:", "Subsection",
 CellChangeTimes->{{3.823152407908724*^9, 
  3.823152417471059*^9}},ExpressionUUID->"cc749f2d-2d4d-47b0-95d9-\
7902fdb83b40"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["    Other (scratch)", "Chapter",
 CellChangeTimes->{{3.823169189616075*^9, 3.823169190191506*^9}, {
   3.8231723322200108`*^9, 3.8231723337720623`*^9}, 
   3.823238498076232*^9},ExpressionUUID->"57fe9b2c-f2e9-4b89-ad1a-\
6412a8f822db"],

Cell[CellGroupData[{

Cell["film", "Section",
 CellChangeTimes->{{3.8231723419956007`*^9, 
  3.823172343411159*^9}},ExpressionUUID->"dc59816c-8373-43c5-8e2b-\
deb0ea4b1a41"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"C11", "=", "175.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"C12", "=", "79.4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"C44", "=", "111.1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"e11", "=", "0.025"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"e22", "=", "0.025"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s00", "=", 
   RowBox[{"C11", "*", "e11"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"s11", "=", 
   RowBox[{"C11", "*", "e22"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"s22", "=", 
   RowBox[{
    RowBox[{"C12", "*", "e11"}], "+", 
    RowBox[{"C12", "*", "e22"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.823169203966625*^9, 3.823169203967847*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"4d8b45d8-a08c-4768-8bac-bbbbd06f9aaf"],

Cell[CellGroupData[{

Cell[BoxData["s00"], "Input",
 CellChangeTimes->{{3.823169209168129*^9, 3.823169209407609*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"f05c1242-7293-4893-a1fa-a93b32b7d0d0"],

Cell[BoxData["4.375`"], "Output",
 CellChangeTimes->{3.823169209744378*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"717cb67b-9ead-44bd-b589-b4ec56a97ca1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"func", "[", 
  RowBox[{
   RowBox[{"5", "/", "10"}], ",", 
   FractionBox["\"\<Volts\>\"", "\"\<Nanometers\>\""], ",", 
   FractionBox["\"\<Megavolts\>\"", "\"\<Centimeters\>\""]}], "]"}]], "Input",\

 CellChangeTimes->{{3.823170132902706*^9, 3.823170186861773*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"6c189421-8b5a-42d0-8a39-5039ab3d3326"],

Cell[BoxData[
 TemplateBox[{"5", 
   RowBox[{
    "\"MV\"", "\[InvisibleSpace]", "\"/\"", "\[InvisibleSpace]", "\"cm\""}], 
   "megavolts per centimeter", 
   FractionBox["\"Megavolts\"", "\"Centimeters\""]},
  "Quantity"]], "Output",
 CellChangeTimes->{{3.8231701614524508`*^9, 3.823170187283621*^9}},
 CellLabel->"Out[13]=",ExpressionUUID->"f92d6b43-2fa6-46ac-8032-a4ddd5cc0b65"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1213, 969},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"12.2 for Linux x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"523752da-37bc-43ae-87cb-378d18ccc5df"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 212, 4, 98, "Title",ExpressionUUID->"ebc18a75-c4e1-49dd-838b-d0c8ff912763"],
Cell[CellGroupData[{
Cell[817, 30, 221, 4, 69, "Chapter",ExpressionUUID->"5441bba2-423a-4c0d-9ffc-e5edeeb48100"],
Cell[CellGroupData[{
Cell[1063, 38, 172, 3, 67, "Section",ExpressionUUID->"12bd110e-b09a-44f8-841e-9c5d197e841e"],
Cell[1238, 43, 372, 9, 30, "Input",ExpressionUUID->"6d9b666e-5dbb-46fd-94e7-33aef6aafa8a"],
Cell[1613, 54, 153, 3, 35, "Text",ExpressionUUID->"ca3e17df-ac3b-40d1-aa84-f547bd858c35"],
Cell[1769, 59, 435, 10, 75, "Input",ExpressionUUID->"605aba92-17ae-4205-91d8-9a7659e9a384"],
Cell[CellGroupData[{
Cell[2229, 73, 574, 16, 54, "Input",ExpressionUUID->"1892d17d-27b2-4b8b-94dc-87869d71f4fa"],
Cell[2806, 91, 534, 12, 42, "Output",ExpressionUUID->"77e9a8ef-d9a0-4014-ac75-8d5c8a14140a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[3389, 109, 237, 4, 53, "Section",ExpressionUUID->"db5ce5f6-8789-4b65-95a7-18a927eaeca8"],
Cell[3629, 115, 2279, 64, 97, "Input",ExpressionUUID->"1ca755ac-49aa-43df-b917-d8a909ba1ddf"],
Cell[5911, 181, 16351, 440, 559, "Input",ExpressionUUID->"c5ff5347-cd13-4494-820b-16853e833e42"],
Cell[22265, 623, 6865, 210, 394, "Input",ExpressionUUID->"186ae615-8cb2-48a9-b5b5-b100bf1f8732"]
}, Closed]],
Cell[CellGroupData[{
Cell[29167, 838, 171, 3, 53, "Section",ExpressionUUID->"2e54c9af-338a-4b60-a60b-94baa3d3602f"],
Cell[29341, 843, 13914, 411, 653, "Input",ExpressionUUID->"ee610166-5c22-4f17-8c56-1c170d3f5627"],
Cell[43258, 1256, 2901, 85, 204, "Input",ExpressionUUID->"96b479c7-9851-4b81-a4b7-5213ad725f43"]
}, Closed]],
Cell[CellGroupData[{
Cell[46196, 1346, 168, 3, 53, "Section",ExpressionUUID->"0cab8b2a-af49-48c4-9bb9-ad7d3853943c"],
Cell[46367, 1351, 2817, 75, 204, "Input",ExpressionUUID->"5c2c7011-a069-438e-8163-5636797022fe"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49233, 1432, 238, 4, 69, "Chapter",ExpressionUUID->"7a035d01-4419-4dfa-8464-9f36e563fa83"],
Cell[CellGroupData[{
Cell[49496, 1440, 174, 3, 67, "Section",ExpressionUUID->"28cfd32f-5d2f-4679-ba3f-71ab50c7c33c"],
Cell[CellGroupData[{
Cell[49695, 1447, 570, 16, 54, "Subsection",ExpressionUUID->"e63d1d95-158a-406e-bb47-4d3dd76d7507"],
Cell[50268, 1465, 599, 17, 119, "Input",ExpressionUUID->"9d78ea87-567c-4f7f-92de-f0bbef9ef26a"],
Cell[CellGroupData[{
Cell[50892, 1486, 22861, 539, 2970, "Input",ExpressionUUID->"df2db43e-de59-4b2e-8507-d61dc375a349"],
Cell[73756, 2027, 928, 12, 607, "Output",ExpressionUUID->"1e16d244-119b-411f-acf6-26c1af7ce245"]
}, Open  ]]
}, Closed]],
Cell[74711, 2043, 566, 16, 38, "Subsection",ExpressionUUID->"72e10825-d014-413f-a842-21d38a5da6ad"],
Cell[75280, 2061, 593, 15, 38, "Subsection",ExpressionUUID->"3235dd6f-e7ea-4ea8-8b26-8d6dc36b42b9"]
}, Open  ]],
Cell[75888, 2079, 1492, 51, 79, "Section",ExpressionUUID->"5da2ae0b-5d70-4c56-9cc9-e071bf0a896b"],
Cell[CellGroupData[{
Cell[77405, 2134, 1204, 37, 57, "Section",ExpressionUUID->"0318d1e5-1e36-41ba-8187-e92dbe09de49"],
Cell[CellGroupData[{
Cell[78634, 2175, 178, 3, 54, "Subsection",ExpressionUUID->"1dbff085-0a86-4b5d-801d-662c15197193"],
Cell[78815, 2180, 370, 8, 35, "Text",ExpressionUUID->"b3454773-8216-44a5-a0e5-67153db34a4f"],
Cell[79188, 2190, 3397, 114, 79, "Input",ExpressionUUID->"3c626555-cd51-44a8-93d5-07d73ec926bf"],
Cell[CellGroupData[{
Cell[82610, 2308, 243, 5, 30, "Input",ExpressionUUID->"f1f6b01a-69c1-496b-96a8-d86d8d4c341c"],
Cell[82856, 2315, 3385, 113, 83, "Output",ExpressionUUID->"b95891f1-3b33-4d7d-9cd6-918239aa7bd2"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[86290, 2434, 210, 3, 38, "Subsection",ExpressionUUID->"114525c9-fd38-49c4-b247-7cd3615403b5"],
Cell[86503, 2439, 1764, 47, 75, "Input",ExpressionUUID->"6be43089-bdcf-4d42-b9a6-aacafb37f4f5"],
Cell[CellGroupData[{
Cell[88292, 2490, 520, 12, 30, "Input",ExpressionUUID->"b19cce9a-e1dd-45b9-873c-33bb87f1ca63"],
Cell[88815, 2504, 1382, 32, 57, "Output",ExpressionUUID->"b2c67401-9ace-4b71-8cdf-98954bf25e07"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[90246, 2542, 172, 3, 38, "Subsection",ExpressionUUID->"4274e034-4481-4cc9-a0c0-49b59382c5dd"],
Cell[90421, 2547, 1484, 40, 92, "Input",ExpressionUUID->"a8c92058-22b2-4805-9c3d-80135cf80877"],
Cell[CellGroupData[{
Cell[91930, 2591, 413, 9, 30, "Input",ExpressionUUID->"8503c96a-0966-4144-98b5-f4c499846242"],
Cell[92346, 2602, 1145, 31, 52, "Output",ExpressionUUID->"8383f563-2fc1-46c7-810d-388bfe2bb7f2"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[93540, 2639, 190, 3, 38, "Subsection",ExpressionUUID->"5818968a-45e5-46d7-8610-2fba52413263"],
Cell[93733, 2644, 587, 15, 30, "Input",ExpressionUUID->"b40dcbe1-78f0-4559-a488-8be39fe844c2"]
}, Closed]],
Cell[CellGroupData[{
Cell[94357, 2664, 176, 3, 38, "Subsection",ExpressionUUID->"1339ffbd-823d-4a62-8778-2ed65ef32713"],
Cell[94536, 2669, 1700, 51, 108, "Input",ExpressionUUID->"ccb31e99-0b2a-412c-983e-d042d51670f9"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[96285, 2726, 487, 15, 73, "Section",ExpressionUUID->"ebffbc4e-2adf-4d84-8fb1-1b9b66a37014"],
Cell[96775, 2743, 821, 27, 73, "Text",ExpressionUUID->"447c3a4f-318b-4beb-a748-f63e257e3105"],
Cell[CellGroupData[{
Cell[97621, 2774, 297, 5, 54, "Subsection",ExpressionUUID->"eb65bc6b-b065-418d-a5f6-5f5a96793f2d"],
Cell[CellGroupData[{
Cell[97943, 2783, 630, 15, 47, "Subsubsection",ExpressionUUID->"a794bad2-6776-4972-b1bf-827cfa9800a4"],
Cell[CellGroupData[{
Cell[98598, 2802, 461, 11, 30, "Input",ExpressionUUID->"992b342c-73b3-4259-ad4a-966a1132c726"],
Cell[99062, 2815, 923, 18, 120, "Output",ExpressionUUID->"8ca1d28c-bcaf-4b9e-96a2-85d86a3f74ae"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[100034, 2839, 564, 14, 41, "Subsubsection",ExpressionUUID->"2e543979-28fe-47dc-bd6c-20925c4df316"],
Cell[CellGroupData[{
Cell[100623, 2857, 461, 11, 30, "Input",ExpressionUUID->"ab58dfda-9269-465d-86e8-c6b313f67158"],
Cell[101087, 2870, 943, 18, 120, "Output",ExpressionUUID->"2a7dd74c-5495-462a-b3c9-40b22ea857ca"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[102079, 2894, 637, 15, 39, "Subsubsection",ExpressionUUID->"b1314ec2-9f9d-432b-877a-df666fd6e745"],
Cell[CellGroupData[{
Cell[102741, 2913, 457, 11, 30, "Input",ExpressionUUID->"f06f6e0c-015a-4cdb-b540-33046f7b08a9"],
Cell[103201, 2926, 973, 18, 120, "Output",ExpressionUUID->"4e43c2f6-e842-4762-89eb-5070ee210272",
 InitializationCell->True]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104235, 2951, 286, 4, 54, "Subsection",ExpressionUUID->"9afe1d61-662a-4d5c-8c0a-a6983253177d"],
Cell[CellGroupData[{
Cell[104546, 2959, 653, 22, 47, "Subsubsection",ExpressionUUID->"4505be3b-3bd8-41c7-b4c5-3363b692cb68"],
Cell[CellGroupData[{
Cell[105224, 2985, 425, 12, 30, "Input",ExpressionUUID->"e0230917-f2d5-4cfb-a28b-ac4a9bae5680"],
Cell[105652, 2999, 795, 16, 120, "Output",ExpressionUUID->"e383a0d5-7aa4-4e4d-bf51-8bf23d9808eb"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[106496, 3021, 703, 22, 41, "Subsubsection",ExpressionUUID->"ffd155c3-048c-41d9-aaac-e15add921e00"],
Cell[CellGroupData[{
Cell[107224, 3047, 455, 12, 30, "Input",ExpressionUUID->"ded3ef6b-8df4-42d7-9a82-5144f68c5b8a"],
Cell[107682, 3061, 765, 14, 178, "Output",ExpressionUUID->"a9a2bf6b-ea63-49d2-8337-b07210833c6c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[108496, 3081, 677, 22, 39, "Subsubsection",ExpressionUUID->"e3664456-3118-4d54-abbf-9a0b5f3bf633"],
Cell[CellGroupData[{
Cell[109198, 3107, 471, 12, 30, "Input",ExpressionUUID->"c7a474a3-9259-421c-9c04-1f8476dc8ae5"],
Cell[109672, 3121, 818, 15, 120, "Output",ExpressionUUID->"283d6ae1-f56d-46fc-8097-40d0666946cf"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[110551, 3143, 291, 4, 54, "Subsection",ExpressionUUID->"8ce3d775-e747-4f3a-8df5-30944464e99f"],
Cell[CellGroupData[{
Cell[110867, 3151, 777, 23, 49, "Subsubsection",ExpressionUUID->"9a8e343a-470b-4396-8de7-e0a19cd054ef"],
Cell[CellGroupData[{
Cell[111669, 3178, 471, 12, 30, "Input",ExpressionUUID->"3c6911be-de45-499f-8d2f-bebfb7575079"],
Cell[112143, 3192, 576, 12, 84, "Output",ExpressionUUID->"e3bfe523-97ff-4359-8230-9c1de4508c34"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[112768, 3210, 675, 22, 39, "Subsubsection",ExpressionUUID->"b637d4ce-fe76-4349-96b2-4692d281af1a"],
Cell[CellGroupData[{
Cell[113468, 3236, 473, 12, 30, "Input",ExpressionUUID->"eab84467-0486-4fba-822b-edf82f2e1981"],
Cell[113944, 3250, 602, 12, 84, "Output",ExpressionUUID->"2e626022-9bf6-4766-ba82-19c7949c6da3"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[114595, 3268, 750, 23, 41, "Subsubsection",ExpressionUUID->"c54c1a3b-b43a-4f70-bff5-b8178abdf411"],
Cell[CellGroupData[{
Cell[115370, 3295, 521, 13, 30, "Input",ExpressionUUID->"4d66ed84-93b9-4fbe-a3b1-98c9c0a5718e"],
Cell[115894, 3310, 593, 12, 84, "Output",ExpressionUUID->"6bc0890e-6da8-4ade-93aa-03b356ea18c3"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[116536, 3328, 729, 23, 41, "Subsubsection",ExpressionUUID->"ed122b42-013b-4b5e-91f1-30f1a14c5ec4"],
Cell[CellGroupData[{
Cell[117290, 3355, 521, 13, 30, "Input",ExpressionUUID->"7bdf3f29-3f22-4a97-83fa-299a52297e92"],
Cell[117814, 3370, 655, 13, 100, "Output",ExpressionUUID->"ccaf564b-d455-4559-aecd-2af4d9cf9f00"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[118518, 3389, 727, 23, 39, "Subsubsection",ExpressionUUID->"c4e219cd-c6f3-451b-a7ff-e64bcf226757"],
Cell[CellGroupData[{
Cell[119270, 3416, 522, 13, 30, "Input",ExpressionUUID->"fe779fef-06be-4177-bd08-09bf23d561f7"],
Cell[119795, 3431, 615, 12, 84, "Output",ExpressionUUID->"746d8209-87ac-497f-8b1d-d6423aecd3c4"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[120459, 3449, 727, 23, 41, "Subsubsection",ExpressionUUID->"9aaf14cb-8f56-4150-8ee1-95b4c007f3cb"],
Cell[CellGroupData[{
Cell[121211, 3476, 521, 13, 30, "Input",ExpressionUUID->"18e137cf-172c-4ba1-9ff3-c8a65c36d186"],
Cell[121735, 3491, 617, 12, 84, "Output",ExpressionUUID->"983e4e7b-198d-49b2-b5cb-a64d1664111f"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[122425, 3511, 504, 15, 73, "Section",ExpressionUUID->"c1f7c731-ef58-4e7e-932e-5e88dd6ef941"],
Cell[122932, 3528, 1573, 53, 145, "Input",ExpressionUUID->"a51fd80b-04a2-442b-b7f1-ace983aeccf5"],
Cell[CellGroupData[{
Cell[124530, 3585, 170, 3, 54, "Subsection",ExpressionUUID->"a7dd7750-6311-4867-aa10-43f054e66544"],
Cell[CellGroupData[{
Cell[124725, 3592, 359, 9, 47, "Subsubsection",ExpressionUUID->"d4aff862-219f-4679-b741-b7ccf931504a"],
Cell[CellGroupData[{
Cell[125109, 3605, 625, 13, 30, "Input",ExpressionUUID->"d7c04ebb-e8e0-41b4-9c0c-15a079769885"],
Cell[125737, 3620, 269, 6, 52, "Output",ExpressionUUID->"d3a7341d-68b8-403e-852a-4ecfba2aba37"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[126055, 3632, 407, 9, 49, "Subsubsection",ExpressionUUID->"04dc4e53-ce15-4fcb-a5ea-b8d1df948faa"],
Cell[CellGroupData[{
Cell[126487, 3645, 596, 13, 72, "Input",ExpressionUUID->"ac485218-b86a-4a7d-ac46-33dec92d9a85"],
Cell[127086, 3660, 298, 7, 114, "Output",ExpressionUUID->"92e9242b-81c4-4f81-b082-6759728ad411"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[127433, 3673, 407, 9, 39, "Subsubsection",ExpressionUUID->"0f43ff8a-b8f1-41a4-8688-d34b088bf9d6"],
Cell[CellGroupData[{
Cell[127865, 3686, 598, 13, 72, "Input",ExpressionUUID->"43247143-cbab-4080-924e-3256caeb8377"],
Cell[128466, 3701, 303, 8, 114, "Output",ExpressionUUID->"ffd770ef-ec68-4d5c-97d0-3ab887c73a86"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[128830, 3716, 170, 3, 54, "Subsection",ExpressionUUID->"faa20aa3-2989-42c6-948f-9abd25dde0c8"],
Cell[CellGroupData[{
Cell[129025, 3723, 359, 9, 47, "Subsubsection",ExpressionUUID->"6ddf2390-af86-4640-952d-4236c622af62"],
Cell[CellGroupData[{
Cell[129409, 3736, 625, 13, 30, "Input",ExpressionUUID->"05a6e1d5-76c8-42b4-b700-cbfae45abded"],
Cell[130037, 3751, 269, 6, 52, "Output",ExpressionUUID->"89dd1d84-9032-4734-8699-b3b4b7532e87"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[130355, 3763, 407, 9, 49, "Subsubsection",ExpressionUUID->"0ba20fee-fdb1-4f69-acf5-3e6dc6f09aaa"],
Cell[CellGroupData[{
Cell[130787, 3776, 596, 13, 72, "Input",ExpressionUUID->"c54a3e73-227c-45e5-b6cb-1390423eed77"],
Cell[131386, 3791, 298, 7, 114, "Output",ExpressionUUID->"98a0183f-76ad-49c4-b6f4-945e030368d1"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[131733, 3804, 407, 9, 39, "Subsubsection",ExpressionUUID->"e56431a9-23ae-4fbe-8f1b-b1d03d0bafb2"],
Cell[CellGroupData[{
Cell[132165, 3817, 598, 13, 72, "Input",ExpressionUUID->"a7a1a5c7-4a52-41c2-870c-9c15d6421cc6"],
Cell[132766, 3832, 303, 8, 114, "Output",ExpressionUUID->"79952b7e-1fdf-4ab7-a5c9-cc0d85f0fdae"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[133130, 3847, 174, 3, 54, "Subsection",ExpressionUUID->"e6bd844e-c2da-4c77-90a4-59afa85e78fe"],
Cell[CellGroupData[{
Cell[133329, 3854, 639, 18, 56, "Subsubsection",ExpressionUUID->"7f2ebf36-8005-4bdc-bb5b-ccfa82b06144"],
Cell[CellGroupData[{
Cell[133993, 3876, 740, 16, 72, "Input",ExpressionUUID->"ebb96ae4-9649-4999-89ff-07fd679549b4"],
Cell[134736, 3894, 198, 3, 72, "Output",ExpressionUUID->"c61a8c8e-832f-4f7f-a381-cfb2652b92ee"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[134983, 3903, 688, 19, 52, "Subsubsection",ExpressionUUID->"32e24dbc-e354-4a9c-bea2-7949af6f78d9"],
Cell[CellGroupData[{
Cell[135696, 3926, 762, 16, 72, "Input",ExpressionUUID->"54e9db65-fc9f-48de-a255-e957b233c703"],
Cell[136461, 3944, 245, 4, 72, "Output",ExpressionUUID->"ffee83bb-6c86-44c7-b3fd-b0d58fcbe9ea"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[136755, 3954, 737, 20, 48, "Subsubsection",ExpressionUUID->"fe50e87a-fd7d-4f18-a8bd-e6a3b114b251"],
Cell[CellGroupData[{
Cell[137517, 3978, 763, 16, 72, "Input",ExpressionUUID->"25453c10-156f-47bb-ae77-6dd40f416df4"],
Cell[138283, 3996, 278, 5, 72, "Output",ExpressionUUID->"5cae6058-1a98-4481-a6d0-0e05558665c7"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[138610, 4007, 173, 3, 37, "Subsubsection",ExpressionUUID->"3f2363de-dd7b-49c0-8f9d-29ced3091828"],
Cell[CellGroupData[{
Cell[138808, 4014, 518, 13, 72, "Input",ExpressionUUID->"1820b38f-b957-4e52-b23a-945fc1730c98"],
Cell[139329, 4029, 165, 3, 72, "Output",ExpressionUUID->"bd27d9cb-3f50-4441-a67d-541c05c7fc0d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139531, 4037, 519, 13, 72, "Input",ExpressionUUID->"61da3e77-16b4-404e-af45-0fc7a4c528a8"],
Cell[140053, 4052, 138, 3, 72, "Output",ExpressionUUID->"13856003-7e25-436a-8606-a2d9c2a40956"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140228, 4060, 869, 22, 123, "Input",ExpressionUUID->"e15a947f-1289-4ee7-ad31-828c2b9ef5f4"],
Cell[141100, 4084, 265, 5, 72, "Output",ExpressionUUID->"6890346e-8c22-4827-8e13-9529c440f550"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141402, 4094, 918, 23, 123, "Input",ExpressionUUID->"097960cc-0ea1-4cee-9182-21f03109ba28"],
Cell[142323, 4119, 225, 4, 72, "Output",ExpressionUUID->"48e5d98e-5d2c-4a8f-a66b-13c0ed0ca855"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142585, 4128, 867, 22, 123, "Input",ExpressionUUID->"c0afd812-3ce9-4769-87c7-ab1f7f8948f7"],
Cell[143455, 4152, 196, 3, 72, "Output",ExpressionUUID->"3bfd8368-973f-43d6-a22b-52d8a6ef54cb"]
}, Open  ]],
Cell[143666, 4158, 331, 10, 12, "Text",ExpressionUUID->"84e586ed-e346-4f8f-9883-edbc1b1a312a"],
Cell[CellGroupData[{
Cell[144022, 4172, 517, 13, 72, "Input",ExpressionUUID->"346823d9-d549-4e23-97d6-492e63dcfb46"],
Cell[144542, 4187, 163, 3, 72, "Output",ExpressionUUID->"c612bca4-9ae8-46d7-a55b-4771333e1ec9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144742, 4195, 568, 14, 72, "Input",ExpressionUUID->"baa8d92b-f96a-469d-9d15-44a5803fe89f"],
Cell[145313, 4211, 185, 3, 72, "Output",ExpressionUUID->"371501eb-9f0d-482d-9ec3-a783da90216a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145535, 4219, 960, 24, 123, "Input",ExpressionUUID->"f1539ce2-6f52-4172-a2c4-08904bd4532c"],
Cell[146498, 4245, 223, 4, 72, "Output",ExpressionUUID->"c118f5c4-2f4d-4d9b-a2f4-384077fffbf9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146758, 4254, 911, 23, 123, "Input",ExpressionUUID->"0e363baf-2bc1-452c-be02-f3992dea3cbd"],
Cell[147672, 4279, 213, 3, 72, "Output",ExpressionUUID->"edfa4572-d3b6-4215-9f66-3e2110cb79f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147922, 4287, 865, 22, 123, "Input",ExpressionUUID->"6e13592f-7b89-40a6-944c-827d0823882a"],
Cell[148790, 4311, 198, 3, 72, "Output",ExpressionUUID->"4070a950-b689-4a1d-a14b-b904a768b7c8"]
}, Open  ]],
Cell[149003, 4317, 331, 10, 12, "Text",ExpressionUUID->"9fdd1c5b-c183-4254-bdf1-dd0077a6d1c9"],
Cell[CellGroupData[{
Cell[149359, 4331, 517, 13, 72, "Input",ExpressionUUID->"b821f865-cfd1-4ae6-a326-1b77daea45fb"],
Cell[149879, 4346, 163, 3, 72, "Output",ExpressionUUID->"967c3c76-dfae-4830-b708-276298d854f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150079, 4354, 516, 13, 72, "Input",ExpressionUUID->"7d6c1450-db09-426f-ba59-46105c5b90f1"],
Cell[150598, 4369, 165, 3, 72, "Output",ExpressionUUID->"7569e2b9-b6f5-475a-844e-941b1f08136f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150800, 4377, 913, 23, 123, "Input",ExpressionUUID->"2c97fd1c-24e6-424f-af91-fa88261e9d97"],
Cell[151716, 4402, 172, 3, 72, "Output",ExpressionUUID->"f1f50b0c-a04f-414d-a8fc-11c3c79ada9a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151925, 4410, 913, 23, 123, "Input",ExpressionUUID->"4c395bc7-aa86-4c06-9cf9-ce65ae17ff8f"],
Cell[152841, 4435, 168, 2, 72, "Output",ExpressionUUID->"3ba4040f-e2fa-4da1-8936-5d6298333d6b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153046, 4442, 909, 23, 123, "Input",ExpressionUUID->"121b2d66-9153-4a47-b850-dee20152f44d"],
Cell[153958, 4467, 212, 3, 72, "Output",ExpressionUUID->"1569a04f-03c6-4e0e-8a0b-79887e874fee"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[154255, 4479, 183, 3, 69, "Chapter",ExpressionUUID->"758459e7-ef4f-49dc-882e-bb6956ca3e88"],
Cell[CellGroupData[{
Cell[154463, 4486, 174, 3, 67, "Section",ExpressionUUID->"80812cd6-b1bb-449f-886b-21fc76e7e084"],
Cell[CellGroupData[{
Cell[154662, 4493, 170, 3, 54, "Subsection",ExpressionUUID->"1bcf7195-f09f-4887-bfbb-b621f6b5a139"],
Cell[154835, 4498, 448, 12, 97, "Input",ExpressionUUID->"293d8cfc-eb2a-48ab-bf96-252eb9b9f6a5"],
Cell[155286, 4512, 2534, 73, 324, "Input",ExpressionUUID->"eaa32d20-00aa-49a9-b23a-9848f6dff607"],
Cell[157823, 4587, 1099, 25, 141, "Input",ExpressionUUID->"0072e5dc-e422-4590-81fb-279ce4ab917f"],
Cell[CellGroupData[{
Cell[158947, 4616, 285, 6, 30, "Input",ExpressionUUID->"14cb2a2c-4afd-4553-b69e-8b150e9b939c"],
Cell[159235, 4624, 1739, 38, 44, "Output",ExpressionUUID->"68e97e53-2187-48da-8878-3b6a7dfba0bf"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[161035, 4669, 1151, 39, 71, "Section",ExpressionUUID->"71df5d96-f5a9-4ffe-9519-46d556f98fe6"],
Cell[CellGroupData[{
Cell[162211, 4712, 757, 25, 61, "Subsection",ExpressionUUID->"f29e61f8-efa7-4034-8c60-0dfcb50811e8"],
Cell[162971, 4739, 1573, 28, 47, "Input",ExpressionUUID->"3f090a8b-d3a9-43c5-bd63-48b9f79b95dd"]
}, Closed]],
Cell[CellGroupData[{
Cell[164581, 4772, 611, 19, 38, "Subsection",ExpressionUUID->"0b862b60-4ea9-4549-aba8-2e8a1f253fa3"],
Cell[165195, 4793, 1365, 24, 30, "Input",ExpressionUUID->"edb61ec0-adcb-4fc1-a042-daf0dcd0c26e"]
}, Closed]],
Cell[CellGroupData[{
Cell[166597, 4822, 929, 30, 47, "Subsection",ExpressionUUID->"e1e712fa-5e27-4002-a746-cd3cb4e4b2ec"],
Cell[167529, 4854, 1619, 50, 49, "Input",ExpressionUUID->"71c6f74c-c9c3-4bdc-bbbe-9bda21a966b0"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[169197, 4910, 1952, 64, 83, "Section",ExpressionUUID->"561ed868-d16a-4d18-90b8-e77a1b0b776b"],
Cell[171152, 4976, 1359, 40, 56, "Input",ExpressionUUID->"4aa8480d-077c-4767-9edf-99b149a12936"],
Cell[172514, 5018, 1081, 32, 75, "Input",ExpressionUUID->"98b89b1a-5b50-439c-afd9-3dbe3b7c1ce0"],
Cell[173598, 5052, 311, 7, 35, "Text",ExpressionUUID->"1d7de1d0-64a7-4719-9696-82d1e6f8f268"]
}, Closed]],
Cell[CellGroupData[{
Cell[173946, 5064, 180, 3, 53, "Section",ExpressionUUID->"2396f8a0-dd60-420e-8cce-072d7c0547aa"],
Cell[CellGroupData[{
Cell[174151, 5071, 1590, 42, 185, "Input",ExpressionUUID->"ee17ac49-a45f-4c6a-8f4d-d3cace439586"],
Cell[175744, 5115, 3103, 74, 216, "Output",ExpressionUUID->"884f9faf-a682-49a8-9936-cdd13d17a58c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178884, 5194, 1618, 43, 185, "Input",ExpressionUUID->"ce39e57f-e0a8-4873-a360-41e0d1b16eb3"],
Cell[180505, 5239, 3152, 76, 216, "Output",ExpressionUUID->"024ad78a-23b0-409a-8e32-b6743b523445"]
}, Open  ]],
Cell[CellGroupData[{
Cell[183694, 5320, 1544, 41, 185, "Input",ExpressionUUID->"81edb96c-ba96-4bcf-bc8c-0e3a0e38c00d"],
Cell[185241, 5363, 2984, 69, 216, "Output",ExpressionUUID->"1856c70f-8637-44b0-b4ce-d728d2af5310"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[188274, 5438, 172, 3, 53, "Section",ExpressionUUID->"2f02d2bd-0e0e-4eb3-87f0-04e73133a678"],
Cell[CellGroupData[{
Cell[188471, 5445, 166, 3, 54, "Subsection",ExpressionUUID->"2dcb3fed-ca30-4079-8597-fe5e0ff5479d"],
Cell[CellGroupData[{
Cell[188662, 5452, 1156, 22, 30, "Input",ExpressionUUID->"79fd22c5-0677-46b9-9dfc-fe242b778343"],
Cell[189821, 5476, 2047, 33, 174, "Output",ExpressionUUID->"c6a74596-d201-49f5-9d03-033649021e74"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191905, 5514, 1050, 21, 30, "Input",ExpressionUUID->"9445b612-1932-49cd-a2dc-1844aebe34ea"],
Cell[192958, 5537, 1862, 31, 174, "Output",ExpressionUUID->"885e7f6c-1296-4c85-b889-121661bd58eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194857, 5573, 1057, 21, 30, "Input",ExpressionUUID->"edf23143-6597-46bb-8eda-cab6c7ac2639"],
Cell[195917, 5596, 1880, 32, 174, "Output",ExpressionUUID->"082f1f32-0d65-4725-ba1b-1c13a3b7fb96"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[197846, 5634, 237, 4, 38, "Subsection",ExpressionUUID->"abb39c8d-b5de-4d28-8cca-f5a4ceb6d036"],
Cell[CellGroupData[{
Cell[198108, 5642, 1141, 25, 53, "Input",ExpressionUUID->"8fb1568d-3add-4f45-a525-1c922a2bf45e"],
Cell[199252, 5669, 1687, 27, 120, "Output",ExpressionUUID->"0f6a3fdf-b259-449b-9bf2-d998be5d1da8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[200976, 5701, 1076, 24, 53, "Input",ExpressionUUID->"3daebc25-f3b2-4fdf-8b4a-f8620b9632ca"],
Cell[202055, 5727, 750, 14, 120, "Output",ExpressionUUID->"bd0c98e0-83d8-4a33-b1dd-b31bed70e9c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202842, 5746, 704, 19, 53, "Input",ExpressionUUID->"d114960d-0fc1-442f-8e42-9975784493c8"],
Cell[203549, 5767, 749, 14, 120, "Output",ExpressionUUID->"66b37e94-8538-4f4c-8da8-84c603aa4edc"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[204347, 5787, 185, 3, 38, "Subsection",ExpressionUUID->"9c9c765a-c221-4236-9c32-b690e2a42e24"],
Cell[CellGroupData[{
Cell[204557, 5794, 704, 19, 53, "Input",ExpressionUUID->"744086df-8cb8-4036-bbbe-92dea9a44f85"],
Cell[205264, 5815, 764, 14, 120, "Output",ExpressionUUID->"4ebc0444-c9fa-446a-b256-a99e3262e87d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206065, 5834, 704, 19, 53, "Input",ExpressionUUID->"e2458c0d-2418-4656-a3d0-6dd0e5a02da5"],
Cell[206772, 5855, 843, 15, 138, "Output",ExpressionUUID->"88941e37-0600-4503-b192-0d6f76f69476"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207652, 5875, 704, 19, 53, "Input",ExpressionUUID->"ca3c4e90-55b5-412a-ba6c-c8c1bb821186"],
Cell[208359, 5896, 765, 14, 120, "Output",ExpressionUUID->"2e52c13e-0bb0-4127-b2c0-9b534a85a1c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209161, 5915, 704, 19, 53, "Input",ExpressionUUID->"2f885001-4c92-4b18-96b5-ac6c7d6913e7"],
Cell[209868, 5936, 848, 16, 138, "Output",ExpressionUUID->"8e8a3b50-54c1-4468-8813-8da1f2ca5a37"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210753, 5957, 704, 19, 53, "Input",ExpressionUUID->"4c404825-052f-4a77-b71d-29e1e43b3840"],
Cell[211460, 5978, 858, 16, 138, "Output",ExpressionUUID->"f430233d-6b26-4ba9-9f6f-ef3c642ef6ea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212355, 5999, 704, 19, 53, "Input",ExpressionUUID->"2901b736-69f9-4f0c-934c-823e47423150"],
Cell[213062, 6020, 853, 15, 138, "Output",ExpressionUUID->"56b656a2-79d6-4b65-9ef8-bd0e7f4cb418"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[213976, 6042, 175, 3, 67, "Section",ExpressionUUID->"047aa2f6-b27c-4f3e-b5b0-37bb43990839"],
Cell[CellGroupData[{
Cell[214176, 6049, 169, 3, 54, "Subsection",ExpressionUUID->"c33de142-c5fe-4952-85c9-acc18d1efc0c"],
Cell[CellGroupData[{
Cell[214370, 6056, 385, 9, 30, "Input",ExpressionUUID->"194e88a0-6c82-4e75-8688-c8e7ec9ae10a"],
Cell[214758, 6067, 2042, 50, 60, "Output",ExpressionUUID->"047e7cc0-7a84-4b5c-b872-e0cfb4e93fe0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216837, 6122, 585, 14, 30, "Input",ExpressionUUID->"d1d9d50f-cc42-4e5a-9223-21a3ceb6388e"],
Cell[217425, 6138, 330, 7, 66, "Output",ExpressionUUID->"d4e36dd5-f178-4a14-b8fb-88322731aff2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217792, 6150, 212, 5, 30, "Input",ExpressionUUID->"fef6e744-d8ee-4796-95fa-5f4a2415a3e9"],
Cell[218007, 6157, 1465, 42, 59, "Output",ExpressionUUID->"44078560-d20a-4a05-9779-8e2bcadf291f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219509, 6204, 585, 14, 30, "Input",ExpressionUUID->"1b4cd2d3-9915-4293-8527-dd7e4addac93"],
Cell[220097, 6220, 332, 7, 66, "Output",ExpressionUUID->"8ac9fe2d-ff1a-4488-82ff-f548709e8075"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220466, 6232, 212, 5, 30, "Input",ExpressionUUID->"49aa4302-5dac-4ad3-8d44-d64c3ad0c7e4"],
Cell[220681, 6239, 1440, 41, 59, "Output",ExpressionUUID->"17d33e19-a22d-48f3-9673-aa87726ea5fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222158, 6285, 585, 14, 30, "Input",ExpressionUUID->"f1755b89-03dd-4ba0-b81e-50bdfda97df2"],
Cell[222746, 6301, 311, 7, 66, "Output",ExpressionUUID->"88a34cc3-9ee9-4722-addb-6fabc0277098"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[223106, 6314, 186, 3, 38, "Subsection",ExpressionUUID->"c1c54794-7876-4f07-86a4-c16a3b25c713"],
Cell[CellGroupData[{
Cell[223317, 6321, 718, 19, 53, "Input",ExpressionUUID->"6643024b-06ee-4b94-9e3c-a506dbe602e2"],
Cell[224038, 6342, 222, 5, 48, "Output",ExpressionUUID->"7f2710fa-eba4-4084-b1b5-df9e8bd0e075"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224297, 6352, 718, 19, 53, "Input",ExpressionUUID->"27d9e5f9-0efd-4419-bc7b-ccf5decee5b3"],
Cell[225018, 6373, 222, 5, 48, "Output",ExpressionUUID->"ec6820f6-f322-4f22-896f-860335cededc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225277, 6383, 718, 19, 53, "Input",ExpressionUUID->"b8f30609-920e-483c-881a-6a5ee0816950"],
Cell[225998, 6404, 222, 5, 48, "Output",ExpressionUUID->"9b0e21a2-ee64-49b8-9458-9e7284fb648b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[226269, 6415, 186, 3, 38, "Subsection",ExpressionUUID->"c15ae1f0-d8d7-4437-8ff6-4861cddc5991"],
Cell[CellGroupData[{
Cell[226480, 6422, 718, 19, 53, "Input",ExpressionUUID->"2fee91e9-9fb7-4b56-81ac-e599d3bdddc0"],
Cell[227201, 6443, 244, 6, 48, "Output",ExpressionUUID->"27f0722a-5f93-4306-a3a6-23a817669a05"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227482, 6454, 718, 19, 53, "Input",ExpressionUUID->"85eed928-eb68-4283-8ee5-fdb84daba9c5"],
Cell[228203, 6475, 245, 6, 48, "Output",ExpressionUUID->"bb1fab76-80fd-438a-a454-90e4bc20e59f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[228485, 6486, 1666, 41, 75, "Input",ExpressionUUID->"c5310808-7a86-4aca-86f1-2dc8b03a5a71"],
Cell[230154, 6529, 310, 7, 66, "Output",ExpressionUUID->"7dbe93dc-2281-4ddd-b8be-e01c189814c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230501, 6541, 718, 19, 53, "Input",ExpressionUUID->"54478118-094d-4150-a7a0-fd0ba26d26ee"],
Cell[231222, 6562, 250, 6, 48, "Output",ExpressionUUID->"8b8d4dc8-63bf-43f8-bced-b53644c87b8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[231509, 6573, 718, 19, 53, "Input",ExpressionUUID->"f21aa3ee-56b4-4544-8332-e60833e1073f"],
Cell[232230, 6594, 247, 6, 48, "Output",ExpressionUUID->"9e7bad4d-e012-46e0-9d48-48d4d8776594"]
}, Open  ]],
Cell[CellGroupData[{
Cell[232514, 6605, 1666, 41, 75, "Input",ExpressionUUID->"fe961710-f123-46dd-a4a7-2b32ecb51a64"],
Cell[234183, 6648, 308, 7, 66, "Output",ExpressionUUID->"f08596f2-0be0-4098-9fd9-03fb2f5ab5f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234528, 6660, 718, 19, 53, "Input",ExpressionUUID->"026b227b-06d5-4b86-b817-fbe30d84c9a3"],
Cell[235249, 6681, 246, 6, 48, "Output",ExpressionUUID->"8fc9139b-4fa1-4342-a364-52951259d3b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235532, 6692, 718, 19, 53, "Input",ExpressionUUID->"75072a16-1b23-449c-80bf-180ba8bf557b"],
Cell[236253, 6713, 248, 6, 48, "Output",ExpressionUUID->"6047f7a9-8fb2-487b-8309-47b85abe798a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[236538, 6724, 1666, 41, 75, "Input",ExpressionUUID->"59732993-10a7-408f-b7a2-63ae9d8de1e7"],
Cell[238207, 6767, 313, 7, 66, "Output",ExpressionUUID->"837849d5-41d2-4622-b1be-b37a716549eb"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[238581, 6781, 248, 4, 67, "Section",ExpressionUUID->"20d7a4b4-184d-4755-9e53-90540003931c"],
Cell[CellGroupData[{
Cell[238854, 6789, 165, 3, 54, "Subsection",ExpressionUUID->"cd211fbc-351b-496a-89c0-ca785cd0d290"],
Cell[CellGroupData[{
Cell[239044, 6796, 543, 11, 30, "Input",ExpressionUUID->"3d4abe0b-62c2-417f-a6bc-897ee613e099"],
Cell[239590, 6809, 1543, 41, 62, "Output",ExpressionUUID->"b1350e0e-3199-49b2-a841-f386405ff653"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241170, 6855, 578, 15, 30, "Input",ExpressionUUID->"4dc2ce33-c844-4320-9d53-78f637ddf159"],
Cell[241751, 6872, 515, 10, 66, "Output",ExpressionUUID->"89f67057-e0e0-4068-908b-f46d1d931091"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242303, 6887, 445, 10, 30, "Input",ExpressionUUID->"da2fccd4-774d-43d1-8e7d-42f6ca04c3d1"],
Cell[242751, 6899, 1401, 39, 62, "Output",ExpressionUUID->"5b611af6-edef-4406-96e2-820e207ae755"]
}, Open  ]],
Cell[CellGroupData[{
Cell[244189, 6943, 552, 15, 30, "Input",ExpressionUUID->"80484777-95b7-423a-a47d-d9fa714402fb"],
Cell[244744, 6960, 485, 9, 66, "Output",ExpressionUUID->"fed9c463-e084-4556-b60f-90d547aa5222"]
}, Open  ]],
Cell[CellGroupData[{
Cell[245266, 6974, 419, 10, 30, "Input",ExpressionUUID->"d6535aa0-3bd2-41d9-9a32-2323c290e62c"],
Cell[245688, 6986, 1286, 36, 62, "Output",ExpressionUUID->"7257df2d-159f-4617-bf9b-589b8c420d64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247011, 7027, 553, 15, 30, "Input",ExpressionUUID->"efc77100-988a-4d29-a9e1-870be39f9172"],
Cell[247567, 7044, 485, 9, 66, "Output",ExpressionUUID->"3f2c061a-4ec0-491d-9ad5-268370540a4f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[248101, 7059, 189, 3, 38, "Subsection",ExpressionUUID->"a7edf84f-cb69-42b0-baa0-4bb19a2d8660"],
Cell[CellGroupData[{
Cell[248315, 7066, 529, 16, 30, "Input",ExpressionUUID->"1c4043d6-6bec-4b21-98a3-2c707dce71b2"],
Cell[248847, 7084, 387, 8, 66, "Output",ExpressionUUID->"e21af621-c416-4801-95c1-b0a4a7ee47bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[249271, 7097, 529, 16, 30, "Input",ExpressionUUID->"16490150-e32e-4caa-afd9-fb531933eaf6"],
Cell[249803, 7115, 371, 8, 66, "Output",ExpressionUUID->"7e2bbf59-c1a0-4f01-8d5b-db7f433cb920"]
}, Open  ]],
Cell[CellGroupData[{
Cell[250211, 7128, 529, 16, 30, "Input",ExpressionUUID->"fa1acfb3-c08d-4e6f-8c97-c34b80385126"],
Cell[250743, 7146, 354, 8, 66, "Output",ExpressionUUID->"a8dde704-0677-4a18-a302-9ad54c201124"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[251146, 7160, 186, 3, 38, "Subsection",ExpressionUUID->"cf5f258c-db07-4f24-91f6-e7340f7f17bd"],
Cell[CellGroupData[{
Cell[251357, 7167, 529, 16, 30, "Input",ExpressionUUID->"4da72b83-b70b-400f-8c72-03863e37d17b"],
Cell[251889, 7185, 434, 9, 84, "Output",ExpressionUUID->"14b30260-97ea-46f9-9fa8-2f5d71c27090"]
}, Open  ]],
Cell[CellGroupData[{
Cell[252360, 7199, 529, 16, 30, "Input",ExpressionUUID->"f31c41cb-cd5f-421a-81f9-19aaae87ef6a"],
Cell[252892, 7217, 401, 8, 84, "Output",ExpressionUUID->"75f13465-c166-4636-ac9b-c963dbe0d85c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[253330, 7230, 529, 16, 30, "Input",ExpressionUUID->"59dfb573-81ba-4e50-87b7-fb84f134d6df"],
Cell[253862, 7248, 437, 9, 84, "Output",ExpressionUUID->"5f4e8ffe-9423-411b-b1d1-e1a031c95541"]
}, Open  ]],
Cell[CellGroupData[{
Cell[254336, 7262, 529, 16, 30, "Input",ExpressionUUID->"5db78344-106e-406c-9345-fe7172a62cad"],
Cell[254868, 7280, 400, 9, 84, "Output",ExpressionUUID->"904cc4c3-9ea0-4182-91fd-5089907ce223"]
}, Open  ]],
Cell[CellGroupData[{
Cell[255305, 7294, 529, 16, 30, "Input",ExpressionUUID->"67e6d9bd-91c1-4060-bb00-a6cc113adff2"],
Cell[255837, 7312, 439, 9, 84, "Output",ExpressionUUID->"a67c4e24-cb5b-48f3-b923-2f71a45651de"]
}, Open  ]],
Cell[CellGroupData[{
Cell[256313, 7326, 529, 16, 30, "Input",ExpressionUUID->"b25ed57b-4d62-4949-8c67-89a3dbbf4956"],
Cell[256845, 7344, 445, 9, 84, "Output",ExpressionUUID->"18d31623-a116-47fa-a00a-e20438305dc0"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[257351, 7360, 1092, 34, 82, "Section",ExpressionUUID->"663533f7-cd90-4ac3-abb4-07c6984ab1ca"],
Cell[CellGroupData[{
Cell[258468, 7398, 168, 3, 54, "Subsection",ExpressionUUID->"fcfaabf0-3cb1-4b23-8012-7b126e55e0bf"],
Cell[CellGroupData[{
Cell[258661, 7405, 902, 27, 50, "Input",ExpressionUUID->"2dba5e94-21f3-4fe6-b07e-6ff6affab9fa"],
Cell[259566, 7434, 1650, 50, 109, "Output",ExpressionUUID->"3031d4aa-9c72-4f4d-ade6-eca7787fbf08"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[261265, 7490, 187, 3, 38, "Subsection",ExpressionUUID->"0cf55a52-f41e-4a3b-a912-3b57e376b561"],
Cell[CellGroupData[{
Cell[261477, 7497, 1378, 38, 74, "Input",ExpressionUUID->"d829af12-81ad-40e6-9ce5-d90035b5baae"],
Cell[262858, 7537, 447, 9, 34, "Output",ExpressionUUID->"4085d93e-e97c-49dd-8299-a9afff28681d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[263342, 7551, 1354, 37, 74, "Input",ExpressionUUID->"90de07be-d2e4-4c42-b6d7-aca865e0ead2"],
Cell[264699, 7590, 459, 9, 34, "Output",ExpressionUUID->"8a317554-90eb-4ac4-bf34-3b65e14b5d22"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265195, 7604, 1352, 37, 74, "Input",ExpressionUUID->"ee8d5562-8c5a-4001-a560-b165fcad7b90"],
Cell[266550, 7643, 462, 9, 34, "Output",ExpressionUUID->"37f4a706-1f6b-44f1-bbc3-4caf99adfecd"]
}, Open  ]]
}, Closed]],
Cell[267039, 7656, 186, 3, 38, "Subsection",ExpressionUUID->"cc749f2d-2d4d-47b0-95d9-7902fdb83b40"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[267274, 7665, 241, 4, 69, "Chapter",ExpressionUUID->"57fe9b2c-f2e9-4b89-ad1a-6412a8f822db"],
Cell[CellGroupData[{
Cell[267540, 7673, 151, 3, 67, "Section",ExpressionUUID->"dc59816c-8373-43c5-8e2b-deb0ea4b1a41"],
Cell[267694, 7678, 780, 24, 207, "Input",ExpressionUUID->"4d8b45d8-a08c-4768-8bac-bbbbd06f9aaf"],
Cell[CellGroupData[{
Cell[268499, 7706, 173, 2, 30, "Input",ExpressionUUID->"f05c1242-7293-4893-a1fa-a93b32b7d0d0"],
Cell[268675, 7710, 153, 2, 34, "Output",ExpressionUUID->"717cb67b-9ead-44bd-b589-b4ec56a97ca1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[268865, 7717, 369, 8, 48, "Input",ExpressionUUID->"6c189421-8b5a-42d0-8a39-5039ab3d3326"],
Cell[269237, 7727, 381, 8, 36, "Output",ExpressionUUID->"f92d6b43-2fa6-46ac-8032-a4ddd5cc0b65"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

