(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    140724,       3880]
NotebookOptionsPosition[    121054,       3532]
NotebookOutlinePosition[    121469,       3549]
CellTagsIndexPosition[    121426,       3546]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Examples of adding Kernels to MOOSE (magnetism):", "Title",
 CellChangeTimes->{{3.859452107102721*^9, 
  3.8594521188465643`*^9}},ExpressionUUID->"b1d4c808-667c-4a76-be0e-\
3eee3380e1cf"],

Cell["\<\
I use the following dummy variables \[CapitalSigma]exch, \
\[CapitalSigma]aniso, \[CapitalSigma]int for effective fields due to \
exchange, anisotropy, and demag field

On-diagonal jacobians are ordered xx, yy,zz whereis off-diagonal jacobians \
are ordered xy,xz,yx,yz,zx,zy\
\>", "Text",
 CellChangeTimes->{{3.8594521339824333`*^9, 3.859452165701663*^9}, {
  3.8595238123314*^9, 
  3.859523857593895*^9}},ExpressionUUID->"110f759c-6548-4f15-a00a-\
63ae774c6c75"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",ExpressionUUID->"ef8787c2-4a7e-49a9-a94e-6e3991f1fe2e"],

Cell[CellGroupData[{

Cell["Units", "Section",
 CellChangeTimes->{{3.85952406921416*^9, 
  3.8595240696694517`*^9}},ExpressionUUID->"11689daf-6785-46d4-89b4-\
665b43f142d5"],

Cell[CellGroupData[{

Cell["\<\
Permalloy (micrometers, microseconds, microcoulombs unit system):\
\>", "Subsection",
 CellChangeTimes->{{3.8595253921955976`*^9, 
  3.859525411795492*^9}},ExpressionUUID->"4dc54554-7017-4242-bcce-\
9158a4fbb020"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "A", "]"}]], "Input",
 CellLabel->
  "In[1512]:=",ExpressionUUID->"5de1d9ef-9d2a-4102-89bb-b72ffda9273e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"func", "[", 
   RowBox[{"value_", ",", "inputUnits_", ",", "outputUnits_"}], "]"}], ":=", 
  RowBox[{"UnitConvert", "[", 
   RowBox[{
    RowBox[{"Quantity", "[", 
     RowBox[{"value", ",", "inputUnits"}], "]"}], ",", "outputUnits"}], 
   "]"}]}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"e5631bb1-a1c2-4477-a92d-85b34321fb4c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MassScale", "=", "\"\<Picograms\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeScale", "=", "\"\<Microseconds\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LengthScale", "=", "\"\<Nanometers\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ChargeScale", "=", "\"\<Picocoulombs\>\""}], ";"}]}], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"8e1dfe9e-7b11-4f73-8bae-64e1e022391f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"func", "[", 
   RowBox[{
    RowBox[{"1.30", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "11"}]]}], ",", 
    FractionBox[
     RowBox[{"\"\<Kilograms\>\"", 
      SuperscriptBox["\"\<Meters\>\"", "2"]}], 
     RowBox[{
      SuperscriptBox["\"\<Seconds\>\"", "2"], "\"\<Meters\>\""}]], ",", 
    FractionBox[
     RowBox[{"MassScale", " ", 
      SuperscriptBox["LengthScale", "2"]}], 
     RowBox[{
      SuperscriptBox["TimeScale", "2"], "LengthScale"}]]}], "]"}]}]], "Input",\

 CellLabel->"In[69]:=",ExpressionUUID->"b299619a-8a97-476f-a6a0-c614119e080d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"func", "[", 
   RowBox[{"120000.0", ",", 
    FractionBox["\"\<Coulombs\>\"", 
     RowBox[{"\"\<Seconds\>\"", "\"\<Meters\>\""}]], ",", 
    FractionBox["ChargeScale", 
     RowBox[{"TimeScale", " ", "LengthScale"}]]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872585885312257*^9, 3.872585886843939*^9}, 
   3.872586186480461*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"6df5ebc5-b8ab-4e50-a5d2-74b8863c4366"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]H", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"func", "[", 
   RowBox[{
    RowBox[{"2.2101", "\[Times]", 
     SuperscriptBox["10", "5"]}], ",", 
    FractionBox[
     RowBox[{"\"\<Meters\>\"", " ", "\"\<Seconds\>\""}], 
     RowBox[{"\"\<Coulombs\>\"", "\"\<Seconds\>\""}]], ",", 
    FractionBox[
     RowBox[{"LengthScale", " ", "TimeScale"}], 
     RowBox[{"ChargeScale", " ", "TimeScale"}]]}], "]"}]}]], "Input",
 CellLabel->"In[71]:=",ExpressionUUID->"f01a9b85-a01f-4e48-93fd-2444c0e6e3e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]0", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"func", "[", 
   RowBox[{
    RowBox[{"1.2566370614", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}], ",", 
    FractionBox[
     RowBox[{"\"\<Kilograms\>\"", "\"\<Meters\>\"", 
      SuperscriptBox["\"\<Seconds\>\"", "2"]}], 
     RowBox[{
      SuperscriptBox["\"\<Seconds\>\"", "2"], 
      SuperscriptBox["\"\<Coulombs\>\"", "2"]}]], ",", 
    FractionBox[
     RowBox[{"MassScale", " ", "LengthScale", " ", 
      SuperscriptBox["TimeScale", "2"]}], 
     RowBox[{
      SuperscriptBox["TimeScale", "2"], 
      SuperscriptBox["ChargeScale", "2"]}]]}], "]"}]}]], "Input",
 CellLabel->"In[72]:=",ExpressionUUID->"5fe40bfb-2fef-4339-ac73-7866f294f5e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ka", "[", 
   RowBox[{
   "MassScale_", ",", "LengthScale_", ",", "ChargeScale_", ",", 
    "TimeScale_"}], "]"}], ":=", 
  RowBox[{"func", "[", 
   RowBox[{
    RowBox[{"5", "*", 
     SuperscriptBox["10", "2"]}], ",", 
    RowBox[{"\"\<Joules\>\"", "/", 
     RowBox[{"(", 
      SuperscriptBox["\"\<Meters\>\"", "3"], ")"}]}], ",", 
    FractionBox[
     RowBox[{"MassScale", " ", 
      SuperscriptBox["LengthScale", "2"], " "}], 
     RowBox[{
      SuperscriptBox["TimeScale", "2"], 
      SuperscriptBox["LengthScale", "3"]}]]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.859527494734542*^9, 3.859527581908792*^9}, {
  3.859528139284034*^9, 3.8595281537950783`*^9}, {3.859529032393882*^9, 
  3.859529038145464*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"7283f081-9806-4ab5-ac51-26feeb16dfaa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"A", "[", 
  RowBox[{
  "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Gamma]H", "[", 
  RowBox[{
  "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"M", "[", 
  RowBox[{
  "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Mu]0", "[", 
  RowBox[{
  "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Ka", "[", 
  RowBox[{
  "MassScale", ",", "LengthScale", ",", "ChargeScale", ",", "TimeScale"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.859524201123226*^9, 3.8595242390672817`*^9}, {
  3.859524269546701*^9, 3.859524271642188*^9}, {3.859527525734902*^9, 
  3.859527527910754*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"bf3ca1a3-3a60-4bf5-9ecc-18bca928e532"],

Cell[BoxData[
 TemplateBox[{"13.`", 
   RowBox[{
    "\"pg\"", "\[ThinSpace]", "\"nm\"", "\[InvisibleSpace]", "\"/\"", 
     "\[InvisibleSpace]", 
     SuperscriptBox["\"\[Mu]s\"", "2"]}], 
   "picogram nanometers per microsecond squared", 
   FractionBox[
    RowBox[{"\"Nanometers\"", " ", "\"Picograms\""}], 
    SuperscriptBox["\"Microseconds\"", "2"]]},
  "Quantity"]], "Output",
 CellLabel->"Out[74]=",ExpressionUUID->"fd82359e-a794-4646-b0ce-57a73f7e3b32"],

Cell[BoxData[
 TemplateBox[{"221.01000000000005`", 
   RowBox[{
    "\"nm\"", "\[InvisibleSpace]", "\"/\"", "\[InvisibleSpace]", "\"pC\""}], 
   "nanometers per picocoulomb", 
   FractionBox["\"Nanometers\"", "\"Picocoulombs\""]},
  "Quantity"]], "Output",
 CellLabel->"Out[75]=",ExpressionUUID->"eabe6480-ca1e-4e37-9a9a-83c829d13f07"],

Cell[BoxData[
 TemplateBox[{"120.`", 
   RowBox[{
    "\"pC\"", "\[InvisibleSpace]", "\"/(\"", "\[InvisibleSpace]", "\"nm\"", 
     "\[ThinSpace]", "\"\[Mu]s\"", "\[InvisibleSpace]", "\")\""}], 
   "picocoulombs per nanometer microsecond", 
   FractionBox["\"Picocoulombs\"", 
    RowBox[{"\"Microseconds\"", " ", "\"Nanometers\""}]]},
  "Quantity"]], "Output",
 CellLabel->"Out[76]=",ExpressionUUID->"ac931b9b-f704-4bbe-829e-8f302e68447e"],

Cell[BoxData[
 TemplateBox[{"1.2566370614`*^-6", 
   RowBox[{
    "\"pg\"", "\[ThinSpace]", "\"nm\"", "\[InvisibleSpace]", "\"/\"", 
     "\[InvisibleSpace]", 
     SuperscriptBox["\"pC\"", "2"]}], 
   "picogram nanometers per picocoulomb squared", 
   FractionBox[
    RowBox[{"\"Nanometers\"", " ", "\"Picograms\""}], 
    SuperscriptBox["\"Picocoulombs\"", "2"]]},
  "Quantity"]], "Output",
 CellLabel->"Out[77]=",ExpressionUUID->"5e6e0fbc-235e-4d28-8a05-bcf45e4b4c77"],

Cell[BoxData[
 TemplateBox[{
   FractionBox["1", "2000"], 
   RowBox[{
    "\"pg\"", "\[InvisibleSpace]", "\"/(\"", "\[InvisibleSpace]", "\"nm\"", 
     "\[ThinSpace]", 
     SuperscriptBox["\"\[Mu]s\"", "2"], "\[InvisibleSpace]", "\")\""}], 
   "picograms per nanometer microsecond squared", 
   FractionBox["\"Picograms\"", 
    RowBox[{
      SuperscriptBox["\"Microseconds\"", "2"], " ", "\"Nanometers\""}]]},
  "Quantity"]], "Output",
 CellLabel->"Out[78]=",ExpressionUUID->"1cc9dd65-3dc9-4164-8904-9d40f4669ab0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"2.2101", "\[Times]", 
  SuperscriptBox["10", "5"]}]], "Input",ExpressionUUID->"9f61f668-0147-4a01-\
af07-8924240f6b35"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2.2101", "*", 
  RowBox[{
   SuperscriptBox["10", "8"], "/", 
   RowBox[{"(", 
    RowBox[{"2", "\[Pi]"}], ")"}]}]}]], "Input",
 CellLabel->
  "In[1523]:=",ExpressionUUID->"1b502d9e-b0e0-4073-a45a-3668c05bde66"],

Cell[BoxData["3.517483397273979`*^7"], "Output",
 CellLabel->
  "Out[1523]=",ExpressionUUID->"bf82e5b9-70ae-495c-a981-0bd076f80df9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"221010.0", "*", 
  SuperscriptBox["10", 
   RowBox[{"-", "7"}]]}]], "Input",
 CellLabel->
  "In[1526]:=",ExpressionUUID->"a1b5d7d9-6032-4f53-b72c-21c999612009"],

Cell[BoxData["0.022101`"], "Output",
 CellLabel->
  "Out[1526]=",ExpressionUUID->"fd2a2428-226f-45e4-8d5b-eb5eab7ea18b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"34989.1", "?", 
  RowBox[{"(", "why", ")"}]}]], "Input",ExpressionUUID->"424ee684-ab17-447a-\
8d91-5938f49c4cb9"],

Cell[TextData[{
 "Note 1: In the code we scale \[Gamma] by \[Gamma]/\[Mu]0 because we work \
with H formalism (all H expressions should have an overall 1/\[Mu]0 on them). \
\n\nNote 2: In the code we use ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["K", "1"], "*", 
    SubscriptBox[
     SuperscriptBox["M", "2"], "s"]}], TraditionalForm]],ExpressionUUID->
  "5baed1b2-9842-4c3b-a4bb-a14eba68135e"],
 " ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      StyleBox["m",
       FontWeight->"Bold"], "\[CenterDot]", 
      StyleBox["n",
       FontWeight->"Bold"]}], ")"}], "2"], TraditionalForm]],ExpressionUUID->
  "2f41bedc-3f5d-4212-99a0-d5f332705fcc"],
 " for the magnetic energy due to anisotropy. I believe in, for example the \
standard problem #1, the anisotropy is given for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["K", "1"], "*", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       StyleBox["m",
        FontWeight->"Bold"], "\[CenterDot]", 
       StyleBox["n",
        FontWeight->"Bold"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"2af986a5-8323-4ad8-8162-3bd402d69fbf"],
 ". Therefore there is a factor of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["M", "s"], "2"], TraditionalForm]],ExpressionUUID->
  "0a8d4603-3024-481e-a675-01e74274b795"],
 " one needs to worry about...\n\nIn these units, H fields  = \
d\[CapitalPhi]dx are given in A/m, so units of B in (Teslas) are \[Mu]0*H = "
}], "Text",
 CellChangeTimes->{{3.859527784732552*^9, 3.859527803138422*^9}, {
  3.859527984973765*^9, 3.859527988861437*^9}, {3.859529073008295*^9, 
  3.8595291938786917`*^9}, {3.859543133358527*^9, 
  3.85954316998944*^9}},ExpressionUUID->"f4b42951-5b7a-47c4-a3a9-\
866c6d9a7dd0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"func", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1.2566370614", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ")"}], "*", "1.0"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"\"\<Kilograms\>\"", "\"\<Meters\>\"", 
      SuperscriptBox["\"\<Seconds\>\"", "2"]}], 
     RowBox[{
      SuperscriptBox["\"\<Seconds\>\"", "2"], 
      SuperscriptBox["\"\<Coulombs\>\"", "2"]}]], 
    FractionBox["\"\<Coulombs\>\"", 
     RowBox[{"\"\<Seconds\>\"", "\"\<Meters\>\""}]]}], ",", 
   FractionBox[
    RowBox[{"MassScale", "  "}], 
    RowBox[{"TimeScale", " ", "ChargeScale"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.859526932977097*^9, 3.859526956944908*^9}, {
  3.859527656227728*^9, 3.859527669167425*^9}, {3.8595277630758142`*^9, 
  3.859527771723147*^9}, {3.859527953498109*^9, 3.859528006942102*^9}},
 CellLabel->
  "In[1568]:=",ExpressionUUID->"83b02485-a9e4-4397-aaca-28b861c93319"],

Cell[BoxData[
 TemplateBox[{"1.2566370614`*^-9", 
   RowBox[{
    "\"pg\"", "\[InvisibleSpace]", "\"/(\"", "\[InvisibleSpace]", 
     "\"\[Mu]s\"", "\[ThinSpace]", "\"pC\"", "\[InvisibleSpace]", "\")\""}], 
   "picograms per microsecond picocoulomb", 
   FractionBox["\"Picograms\"", 
    RowBox[{"\"Microseconds\"", " ", "\"Picocoulombs\""}]]},
  "Quantity"]], "Output",
 CellLabel->
  "Out[1568]=",ExpressionUUID->"6194acd1-2dd2-4276-8e25-338265cee040"]
}, Open  ]],

Cell[TextData[{
 "Example: if dPhi/dx = 1 in the output of Ferret, this is around 1.2 ",
 Cell[BoxData[
  FormBox[
   RowBox[{"*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "cc8f9ff6-0626-4327-91d9-9f6587800dc4"],
 " mT"
}], "Text",ExpressionUUID->"a1cd8488-fbc4-4878-b308-ee9be3954731"],

Cell[TextData[{
 "      and postprocessor energies are given in funky ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    RowBox[{"picograms", "*", 
     RowBox[{
      SuperscriptBox["micrometers", "2"], "/", 
      SuperscriptBox["microseconds", "2"]}]}]}], TraditionalForm]],
  ExpressionUUID->"b27e9104-d86d-4536-8a90-6de681e365da"],
 "]"
}], "Text",
 CellChangeTimes->{{3.8595267001819887`*^9, 3.859526719733162*^9}, {
   3.859527161117269*^9, 3.859527161252822*^9}, 3.8595277793734627`*^9, {
   3.8595278095608883`*^9, 3.859527813057535*^9}, {3.85952867180195*^9, 
   3.8595286759209423`*^9}, {3.8595292202698793`*^9, 
   3.859529240653542*^9}},ExpressionUUID->"cd1a1f84-b278-48ac-99cc-\
95e0d56d8a3a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"func", "[", 
  RowBox[{"1.0", ",", 
   FractionBox[
    RowBox[{"MassScale", " ", "*", 
     SuperscriptBox["LengthScale", "2"], " "}], 
    SuperscriptBox["TimeScale", "2"]], ",", "\"\<Electronvolts\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.859527167577784*^9, 3.8595272232041397`*^9}, {
  3.859527865748602*^9, 3.859527913322856*^9}, {3.859528059919937*^9, 
  3.859528105459155*^9}, {3.859528280878805*^9, 3.859528339295238*^9}, {
  3.859528698583617*^9, 3.859528714672778*^9}, {3.859528814021637*^9, 
  3.859528845182626*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"f2913074-e4a8-41e5-833f-227d2201c680"],

Cell[BoxData[
 TemplateBox[{
  "6241.509074460763`", "\"eV\"", "electronvolts", "\"Electronvolts\""},
  "Quantity"]], "Output",
 CellChangeTimes->{{3.8595271862497253`*^9, 3.8595272236399384`*^9}, {
   3.859527881628418*^9, 3.859527914166346*^9}, 3.859528105975564*^9, {
   3.859528292727371*^9, 3.859528339502737*^9}, 3.859528634648547*^9, {
   3.859528709693219*^9, 3.859528715022161*^9}, {3.8595288147489758`*^9, 
   3.8595288457237453`*^9}, {3.8725848160153933`*^9, 3.872584845963808*^9}},
 CellLabel->
  "Out[118]=",ExpressionUUID->"080fb5fb-7c49-4a5c-8275-65ce19fbc5ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"func", "[", 
  RowBox[{
   RowBox[{"1.2566370614", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "9"}]]}], ",", 
   FractionBox["\"\<Picograms\>\"", 
    RowBox[{"\"\<Microseconds\>\"", "\"\<Picocoulombs\>\""}]], ",", 
   "\"\<Milliteslas\>\""}], "]"}]], "Input",
 CellLabel->
  "In[1570]:=",ExpressionUUID->"c1ad1b48-5cf6-4d61-bf8b-5b0622817f86"],

Cell[BoxData[
 TemplateBox[{
  "0.0012566370614000002`", "\"mT\"", "milliteslas", "\"Milliteslas\""},
  "Quantity"]], "Output",
 CellLabel->
  "Out[1570]=",ExpressionUUID->"c7b3efa8-3667-40eb-b24b-052db7aa5b14"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"221010.0", "/", "1256.62"}]], "Input",
 CellChangeTimes->{{3.8595431838184023`*^9, 3.859543188460527*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"56edd4be-64ab-4958-856e-5f57341bddce"],

Cell[BoxData["175.87655775015517`"], "Output",
 CellChangeTimes->{
  3.8595431888023*^9, {3.872584816029364*^9, 3.872584845985434*^9}},
 CellLabel->
  "Out[119]=",ExpressionUUID->"8446a9ca-cf45-4848-b82a-97800013c68b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Effective fields:\n\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["H",
      FontWeight->"Bold"], "k"], "="}], TraditionalForm]],ExpressionUUID->
  "e7e4b70f-b458-457d-b616-d5c6e0cf558c"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", 
      RowBox[{
       SubscriptBox["\[Mu]", "0"], 
       SubscriptBox["M", "s"]}]]}], 
    FractionBox[
     SubscriptBox["\[Delta]F", "k"], 
     StyleBox[
      RowBox[{"\[Delta]", 
       StyleBox["m",
        FontWeight->"Bold"]}]]]}], TraditionalForm]],ExpressionUUID->
  "51b89f8b-7c85-4085-8a02-3b1660b6c76a"],
 "      use ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Gamma]", "h"], "!"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bc68cfbe-2003-4c0d-83f4-4ba50930214c"],
 "\n\t\n\t\n\t\n\t\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["H",
      FontWeight->"Bold"], "exch"], " ", "=", 
    RowBox[{
     FractionBox[
      RowBox[{"2", 
       SubscriptBox["A", "e"]}], 
      RowBox[{"\[Mu]0", " ", 
       SubscriptBox["M", "s"]}]], 
     RowBox[{
      SuperscriptBox["\[Del]", "2"], 
      StyleBox["m",
       FontWeight->"Bold"]}]}]}], TraditionalForm]],ExpressionUUID->
  "3e047a25-a6a5-4de8-bfae-103ff4f7a877"],
 "\n\n\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["H",
      FontWeight->"Bold"], "int"], "=", " ", 
    RowBox[{"-", 
     RowBox[{"\[Del]", 
      SubscriptBox["\[CapitalPhi]", "H"], " "}]}]}], TraditionalForm]],
  ExpressionUUID->"f6cbdf34-5980-4417-bcfe-98f1ebdeefbc"],
 "\n\t\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Note", " ", "that", " ", 
     SubscriptBox["\[CapitalPhi]", "H"], "is", " ", "generated", " ", "from", 
     " ", 
     RowBox[{
      SuperscriptBox["\[Del]", "2"], 
      SubscriptBox["\[CapitalPhi]", "H"]}]}], " ", "=", " ", 
    RowBox[{"\[Del]", "\[CenterDot]", 
     StyleBox["M",
      FontWeight->"Bold"]}]}], TraditionalForm]], "Subsection",ExpressionUUID->
  "e846d123-48a5-4807-8f23-d656f15e990d"],
 "   (no factor of \[Mu]0)\n\t\t\t\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["H",
      FontWeight->"Bold"], "aniso"], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"2", 
       SubscriptBox["K", "1"]}], 
      RowBox[{"\[Mu]0", " ", 
       SubscriptBox["M", "s"]}]], 
     RowBox[{
      StyleBox["n",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"(", 
       RowBox[{
        StyleBox["m",
         FontWeight->"Bold"], "\[CenterDot]", 
        StyleBox["n",
         FontWeight->"Bold"]}], ")"}], " "}]}]}], TraditionalForm]],
  ExpressionUUID->"1201b525-1206-4a4b-ac61-1aa326e910ce"],
 "\n"
}], "Section",ExpressionUUID->"d355d6c2-72ae-4ea8-8b0f-e60c31ec1a31"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hexc", "=", 
   RowBox[{"\[CapitalSigma]exch", " ", 
    FractionBox[
     RowBox[{"2", "Ae"}], 
     RowBox[{"mu0", " ", "Ms"}]], " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d2mxdx2", "+", "d2mxdy2", "+", "d2mxdz2"}], ",", 
      RowBox[{"d2mydx2", "+", "d2mydy2", "+", "d2mydz2"}], ",", 
      RowBox[{"d2mzdx2", "+", "d2mzdy2", "+", "d2mzdz2"}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellLabel->"In[66]:=",ExpressionUUID->"17e2b380-56f4-4a19-ae4d-2e67a6ea0b31"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EnergyAnisotropy", "=", 
    RowBox[{
     RowBox[{"-", "K1"}], 
     RowBox[{"(", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"mx", " ", "nx"}], "+", 
         RowBox[{"my", " ", "ny"}], "+", 
         RowBox[{"mz", " ", "nz"}]}], ")"}], "2"], ")"}]}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{
  3.859452212564906*^9, {3.859452785675156*^9, 3.859452787898863*^9}, {
   3.859522663184299*^9, 3.859522664888175*^9}, {3.872584797313446*^9, 
   3.872584800219139*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"f2a69dac-c470-4b36-9787-b94de262e29f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hanis", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[CapitalSigma]anis", 
      RowBox[{"mu0", " ", "Ms"}]]}], 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"EnergyAnisotropy", ",", "mx"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"EnergyAnisotropy", ",", "my"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"EnergyAnisotropy", ",", "mz"}], "]"}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellLabel->"In[67]:=",ExpressionUUID->"31a3b1bb-41dd-4158-9d10-3eab5ad72657"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hint", "=", 
   RowBox[{
    RowBox[{"-", "\[CapitalSigma]int"}], 
    RowBox[{"{", " ", 
     RowBox[{
     "d\[CapitalPhi]dx", ",", "d\[CapitalPhi]dy", ",", "d\[CapitalPhi]dz"}], 
     "}"}]}]}], ";"}]], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"64f91974-b2f9-4fb6-b8ac-9decc47a1d74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"effectiveFieldSubstitute", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Hx", "\[Rule]", 
      RowBox[{
       RowBox[{"Hexc", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", 
       RowBox[{"Hint", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", 
       RowBox[{"Hanis", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Hy", "\[Rule]", 
      RowBox[{
       RowBox[{"Hexc", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", 
       RowBox[{"Hint", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", 
       RowBox[{"Hanis", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Hz", "\[Rule]", 
      RowBox[{
       RowBox[{"Hexc", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "+", 
       RowBox[{"Hint", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "+", 
       RowBox[{"Hanis", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.859452397641766*^9, 3.859452427545837*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"40f02382-9ef1-4b23-9f09-e5e95b1d6624"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Governing equation:\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["M", "s"], 
         StyleBox["m",
          FontWeight->"Bold"]}], 
        StyleBox[")",
         FontWeight->"Bold"]}]}], 
      RowBox[{"\[PartialD]", "t"}]], "=", " ", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"-", "\[Gamma]", " "}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[Alpha]", "2"]}], ")"}]], "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["M", "s"], 
          StyleBox["m",
           FontWeight->"Bold"]}], 
         StyleBox[")",
          FontWeight->"Bold"]}], 
        StyleBox[" ",
         FontWeight->"Bold"], "\[Times]", " ", 
        StyleBox["H",
         FontWeight->"Bold"]}], "]"}], 
      FormBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[Gamma]", " ", "\[Alpha]", " "}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["\[Alpha]", "2"]}], ")"}], 
            SubscriptBox["M", "s"]}]]}], 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["M", "s"], 
             StyleBox["m",
              FontWeight->"Bold"]}], 
            StyleBox[")",
             FontWeight->"Bold"]}], "\[Times]", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["M", "s"], 
               StyleBox["m",
                FontWeight->"Bold"]}], 
              StyleBox[")",
               FontWeight->"Bold"]}], "\[Times]", 
             StyleBox["H",
              FontWeight->"Bold"]}], "]"}]}], "}"}]}], "+", " ", 
        RowBox[{
         SubscriptBox[
          StyleBox["\[Kappa]",
           FontWeight->"Bold"], "LLB"], "(", 
         StyleBox["m",
          FontWeight->"Bold"], ")"}]}],
       TraditionalForm]}]}]}], TraditionalForm]],ExpressionUUID->
  "709f12c6-1cff-428e-8d51-54c4da49c729"],
 " \n\t\t\t\t\t\n\t\t\t\t\t",
 StyleBox["This form is from the original MuMax paper (excluding ", 
  "Subsection"],
 StyleBox[Cell[BoxData[
  FormBox[
   SubscriptBox["\[Kappa]", "LLB"], TraditionalForm]], "Subsection",
  ExpressionUUID->"a579847f-0f4f-47c5-b786-294d45fd4e07"], "Subsection"],
 StyleBox["). Note that all factors of ", "Subsection"],
 StyleBox[Cell[BoxData[
  FormBox[
   SubscriptBox["M", "s"], TraditionalForm]], "Subsection",ExpressionUUID->
  "b2ca2e14-e8a7-4f04-a783-1630208976cd"], "Subsection"],
 StyleBox[" cancel and we have", "Subsection"],
 "\n\t\t\t\t\t\n",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", " ", 
       RowBox[{"(", 
        StyleBox["m",
         FontWeight->"Bold"], 
        StyleBox[")",
         FontWeight->"Bold"]}]}], 
      RowBox[{"\[PartialD]", "t"}]], "=", " ", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"-", "\[Gamma]", " "}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[Alpha]", "2"]}], ")"}]], "[", 
       RowBox[{
        StyleBox["m",
         FontWeight->"Bold"], 
        StyleBox[" ",
         FontWeight->"Bold"], "\[Times]", " ", 
        StyleBox["H",
         FontWeight->"Bold"]}], "]"}], 
      FormBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[Gamma]", " ", "\[Alpha]", " "}], 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["\[Alpha]", "2"]}], ")"}]]}], 
         RowBox[{"{", 
          RowBox[{
           StyleBox["m",
            FontWeight->"Bold"], "\[Times]", 
           StyleBox["m",
            FontWeight->"Bold"], "\[Times]", 
           StyleBox["H",
            FontWeight->"Bold"]}], "}"}]}], "+", " ", 
        RowBox[{
         SubscriptBox[
          StyleBox["\[Kappa]",
           FontWeight->"Bold"], "LLB"], "(", 
         StyleBox["m",
          FontWeight->"Bold"], ")"}]}],
       TraditionalForm]}]}]}], TraditionalForm]],ExpressionUUID->
  "6848e5d2-4b1a-452e-80e1-42d0cf9b3851"],
 " "
}], "Section",
 CellChangeTimes->{{3.859452235244835*^9, 3.859452236932413*^9}, {
   3.8594530021265306`*^9, 3.859453021248796*^9}, {3.8594578801199636`*^9, 
   3.859457888495762*^9}, {3.859458070476211*^9, 3.859458070611624*^9}, 
   3.859465803936233*^9, {3.859521646054761*^9, 3.859521647052575*^9}, {
   3.859521839504163*^9, 3.859521868975164*^9}, {3.859529501921941*^9, 
   3.859529557273211*^9}, {3.8595313153068132`*^9, 3.8595313388857107`*^9}, 
   3.859531770058832*^9},ExpressionUUID->"0a438f6a-5d79-4b74-9cf3-\
285a7cfd43a9"],

Cell[TextData[{
 "First just consider the LLG part (note we cancel factors of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "s"], TraditionalForm]],ExpressionUUID->
  "af6ecf78-ac56-4d4b-bdbe-3e8f885427d0"],
 "):"
}], "Text",
 CellChangeTimes->{{3.859453028470133*^9, 
  3.8594530468858023`*^9}},ExpressionUUID->"7b211a04-fbc0-44ca-8a3b-\
67d4a22c0cd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HRHS1", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"-", "\[Gamma]"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[Alpha]", "2"]}], ")"}]], " ", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mx", ",", "my", ",", "mz"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Hx", ",", "Hy", ",", "Hz"}], "}"}]}], "]"}]}], "-", " ", 
      RowBox[{
       FractionBox[
        RowBox[{"\[Alpha]", " ", "\[Gamma]", " "}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[Alpha]", "2"]}], ")"}]], 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mx", ",", "my", ",", "mz"}], "}"}], ",", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"mx", ",", "my", ",", "mz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Hx", ",", "Hy", ",", "Hz"}], "}"}]}], "]"}]}], "]"}]}]}],
      ")"}], "//", "Expand"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.859452375802127*^9, {3.8594524890726347`*^9, 3.859452505440633*^9}, 
   3.8595216502753143`*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"280cb465-dbe6-4bfd-bab9-c1e9407745b1"],

Cell["\<\
Multiply RHS by test function and substitute the effective fields:\
\>", "Text",
 CellChangeTimes->{{3.859452451482626*^9, 
  3.859452474464099*^9}},ExpressionUUID->"c8d8b607-7e7e-45a1-8803-\
1dc857a452b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RHSmx", "=", 
   RowBox[{
    RowBox[{"\[Psi]h", " ", 
     RowBox[{"HRHS1", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "/.", "effectiveFieldSubstitute"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmy", "=", " ", 
   RowBox[{
    RowBox[{"\[Psi]h", " ", 
     RowBox[{"HRHS1", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "/.", "effectiveFieldSubstitute"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmz", "=", " ", 
   RowBox[{
    RowBox[{"\[Psi]h", " ", 
     RowBox[{"HRHS1", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "/.", "effectiveFieldSubstitute"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.859452465896306*^9, 3.8594524776004677`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"f3672422-c990-4aeb-88cf-4803ae76acbc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Anisotropy Kernel (MasterAnisotropyCartLLG.C):", "Section",
 CellChangeTimes->{{3.859453054541492*^9, 3.859453061749461*^9}, 
   3.859453768056436*^9, {3.859453798400353*^9, 3.859453799616691*^9}, {
   3.859454088099094*^9, 3.859454091258428*^9}, 3.859454332894187*^9, {
   3.859457293785248*^9, 
   3.8594572958726683`*^9}},ExpressionUUID->"4e17a656-4869-4b0b-b420-\
423d1550e587"],

Cell[CellGroupData[{

Cell["Residuals:", "Subsection",
 CellChangeTimes->{{3.85945386101502*^9, 
  3.859453862071063*^9}},ExpressionUUID->"de15b82c-d17a-4b6d-9e68-\
f5e208dee1ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RHSmxAnis", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"RHSmx", ",", "\[CapitalSigma]anis"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmyAnis", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"RHSmy", ",", "\[CapitalSigma]anis"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmzAnis", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"RHSmz", ",", "\[CapitalSigma]anis"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.859453782120544*^9, 3.859453786976418*^9}, {
  3.859453826376852*^9, 3.859453839817072*^9}},
 CellLabel->
  "In[598]:=",ExpressionUUID->"a935048d-438e-418a-9e38-7b5bf80b52f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RHSmxAnis", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{3.859453815591568*^9},
 CellLabel->
  "In[601]:=",ExpressionUUID->"ee2884a2-5174-4d04-971d-0d57f6f4ea61"],

Cell["\<\
(-2*g0*K1*(mx*nx + my*ny + mz*nz)*(-(alpha*Power(mz,2)*nx) + \
my*(-(alpha*my*nx) + alpha*mx*ny + nz) + mz*(-ny + alpha*mx*nz))*test)/((1 + \
Power(alpha,2))*Ms)\
\>", "Output",
 CellLabel->
  "Out[601]//CForm=",ExpressionUUID->"8603e4a3-0635-4e73-92c0-1212086fd5be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RHSmyAnis", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{{3.8594538442871857`*^9, 3.859453844671258*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"3e2d5ecc-1b84-4c67-97ce-69ed701c7283"],

Cell["\<\
(2*g0*K1*(mx*nx + my*ny + mz*nz)*(alpha*Power(mz,2)*ny + mx*(-(alpha*my*nx) + \
alpha*mx*ny + nz) - mz*(nx + alpha*my*nz))*test)/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.8594538448462067`*^9, 3.859521656676113*^9, 3.859522688419738*^9, {
   3.872584816365899*^9, 3.872584846065346*^9}},
 CellLabel->
  "Out[133]//CForm=",ExpressionUUID->"d75ea569-f17e-4a08-838c-d084ae62b928"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RHSmzAnis", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{{3.859453848743071*^9, 3.859453849079576*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"94b1b503-3fbf-445e-8eb0-2005220eceae"],

Cell["\<\
(2*g0*K1*(mx*nx + my*ny + mz*nz)*(my*(nx - alpha*mz*ny) + \
alpha*Power(my,2)*nz + mx*(-(alpha*mz*nx) - ny + alpha*mx*nz))*test)/((1 + \
Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859453849367979*^9, 3.859521656695958*^9, 3.859522688447693*^9, {
   3.8725848163870783`*^9, 3.8725848460861187`*^9}},
 CellLabel->
  "Out[134]//CForm=",ExpressionUUID->"3b8d4905-32e9-49ef-94ce-63128f8ca1a1"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["On-diagonal jacobians:", "Subsection",
 CellChangeTimes->{{3.8594538661989717`*^9, 
  3.8594538703426857`*^9}},ExpressionUUID->"8d5e5a70-b701-45a9-82b3-\
5d68156ff092"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmxAnis", ",", "mx"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.859453882254901*^9, 3.859453883574506*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"42a7355f-9ea2-433a-b909-3d8fd3541728"],

Cell["\<\
(-2*g0*K1*(-(mz*nx*ny) + my*nx*nz + alpha*(Power(my,2)*(-Power(nx,2) + \
Power(ny,2)) + 2*my*ny*(mx*nx + mz*nz) + mz*(-(mz*Power(nx,2)) + 2*mx*nx*nz + \
mz*Power(nz,2))))*phi*test)/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859453884415134*^9, 3.859521656743277*^9, 3.859522688510441*^9, {
   3.872584816451248*^9, 3.872584846130464*^9}},
 CellLabel->
  "Out[135]//CForm=",ExpressionUUID->"38700df3-40db-4067-8fac-21e5611b0569"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmyAnis", ",", "my"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.859453889638427*^9, 3.859453890702456*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"e8dc736d-3b67-44d6-bcc2-9579e92887d4"],

Cell["\<\
(-2*g0*K1*(ny*(mz*nx - mx*nz) + alpha*(Power(mx,2)*(Power(nx,2) - \
Power(ny,2)) + 2*mx*nx*(my*ny + mz*nz) + mz*(-(mz*Power(ny,2)) + 2*my*ny*nz + \
mz*Power(nz,2))))*phi*test)/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859453891339954*^9, 3.859521656768877*^9, 3.85952268855787*^9, {
   3.872584816480983*^9, 3.872584846155963*^9}},
 CellLabel->
  "Out[136]//CForm=",ExpressionUUID->"17c0e263-c276-4d18-bfce-2be90bc2c0c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmzAnis", ",", "mz"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.859453893790399*^9, 3.859453896326433*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"276fc0c4-8a21-4bc1-b77c-b295a5b9ceb6"],

Cell["\<\
(-2*g0*K1*(-(my*nx*nz) + mx*ny*nz + alpha*(2*mx*nx*(my*ny + mz*nz) + \
Power(mx,2)*(Power(nx,2) - Power(nz,2)) + my*(my*Power(ny,2) + 2*mz*ny*nz - \
my*Power(nz,2))))*phi*test)/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.85945389688008*^9, 3.8595216567884197`*^9, 3.859522688608424*^9, {
   3.87258481650979*^9, 3.87258484618377*^9}},
 CellLabel->
  "Out[137]//CForm=",ExpressionUUID->"ef9833ed-1592-4da0-985d-9d97fa86d505"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Off-diagonal jacobians:", "Subsection",
 CellChangeTimes->{{3.859454023524027*^9, 
  3.859454026379978*^9}},ExpressionUUID->"40e59f93-19cb-4fd1-9e28-\
c0dde996cfd4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmxAnis", ",", "my"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.8594540452117434`*^9, 3.859454046509088*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"134f4c61-b532-493a-a17d-a3549ddf9d1f"],

Cell["\<\
(-2*g0*K1*(-(mz*Power(ny,2)) + mx*nx*nz + 2*my*ny*nz + mz*Power(nz,2) + \
alpha*(Power(mx,2)*nx*ny - nx*(3*Power(my,2)*ny + Power(mz,2)*ny + \
2*my*mz*nz) + mx*(-2*my*Power(nx,2) + 2*my*Power(ny,2) + \
2*mz*ny*nz)))*phi*test)/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859454046914833*^9, 3.859521656821732*^9, 3.8595226886497173`*^9, {
   3.8725848165357237`*^9, 3.872584846206408*^9}},
 CellLabel->
  "Out[138]//CForm=",ExpressionUUID->"0b1478b5-2cc4-439b-9c4b-a5bf010b90d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmxAnis", ",", "mz"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{3.859454053620811*^9},
 CellLabel->
  "In[139]:=",ExpressionUUID->"0c9c2095-1058-48f1-9577-c8fdae7dfb79"],

Cell["\<\
(2*g0*K1*(mx*nx*ny + my*Power(ny,2) + 2*mz*ny*nz - my*Power(nz,2) + \
alpha*(-(Power(mx,2)*nx*nz) + nx*(2*my*mz*ny + Power(my,2)*nz + \
3*Power(mz,2)*nz) - 2*mx*(my*ny*nz + mz*(-Power(nx,2) + \
Power(nz,2)))))*phi*test)/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859454054287208*^9, 3.85952165685404*^9, 3.859522688721183*^9, {
   3.872584816577158*^9, 3.872584846231196*^9}},
 CellLabel->
  "Out[139]//CForm=",ExpressionUUID->"8af22149-b13f-41f0-996b-aa45815b3112"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmyAnis", ",", "mx"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.859454057383954*^9, 3.859454060091227*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"ee2567c1-1ba4-475f-84da-a275d13bb93a"],

Cell["\<\
(2*g0*K1*((-(alpha*my*nx) + 2*alpha*mx*ny + nz)*(mx*nx + my*ny + mz*nz) + \
nx*(alpha*Power(mz,2)*ny + mx*(-(alpha*my*nx) + alpha*mx*ny + nz) - mz*(nx + \
alpha*my*nz)))*phi*test)/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859454060684642*^9, 3.859521656886294*^9, 3.85952268877005*^9, {
   3.872584816614704*^9, 3.872584846258409*^9}},
 CellLabel->
  "Out[140]//CForm=",ExpressionUUID->"496c0a1c-8d4d-42fd-9556-3c3622ec700f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmyAnis", ",", "mz"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.859454063227454*^9, 3.8594540652673388`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"4eadc4ca-75c1-4296-be25-67ef9fe9587a"],

Cell["\<\
(2*g0*K1*(-((nx - 2*alpha*mz*ny + alpha*my*nz)*(mx*nx + my*ny + mz*nz)) + \
nz*(alpha*Power(mz,2)*ny + mx*(-(alpha*my*nx) + alpha*mx*ny + nz) - mz*(nx + \
alpha*my*nz)))*phi*test)/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.8594540658232*^9, 3.859521656921487*^9, 3.859522688820034*^9, {
   3.872584816652576*^9, 3.872584846293397*^9}},
 CellLabel->
  "Out[141]//CForm=",ExpressionUUID->"e926918e-6317-4427-bbea-887457bf0677"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmzAnis", ",", "mx"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.8594540688133173`*^9, 3.8594540704994907`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"175eae89-3ced-4830-9540-260789df7356"],

Cell["\<\
(-2*g0*K1*(-(alpha*Power(my,2)*nx*nz) + ny*(2*mx*nx + mz*nz) + \
my*(-Power(nx,2) + 2*alpha*mz*nx*ny + ny*(ny - 2*alpha*mx*nz)) + \
alpha*(-3*Power(mx,2)*nx*nz + Power(mz,2)*nx*nz + 2*mx*mz*(Power(nx,2) - \
Power(nz,2))))*phi*test)/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859454071052767*^9, 3.859521656957003*^9, 3.859522688882338*^9, {
   3.872584816691394*^9, 3.8725848463236523`*^9}},
 CellLabel->
  "Out[142]//CForm=",ExpressionUUID->"061fa181-e40c-4bbc-8f08-002ffc14d8c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmzAnis", ",", "my"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{3.8594540740447607`*^9},
 CellLabel->
  "In[143]:=",ExpressionUUID->"1c1153b7-8dc7-465a-8cec-e6d16526e42c"],

Cell["\<\
(2*g0*K1*(alpha*Power(mx,2)*ny*nz + 3*alpha*Power(my,2)*ny*nz + mz*(nx - \
alpha*mz*ny)*nz + mx*(Power(nx,2) - 2*alpha*mz*nx*ny - Power(ny,2) + \
2*alpha*my*nx*nz) + 2*my*(nx*ny + alpha*mz*(-Power(ny,2) + \
Power(nz,2))))*phi*test)/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859454076573386*^9, 3.859521656980543*^9, 3.859522688903466*^9, {
   3.8725848167190866`*^9, 3.8725848463471317`*^9}},
 CellLabel->
  "Out[143]//CForm=",ExpressionUUID->"f81eeedb-81a7-45e6-ad65-e6a872e21ef8"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Demag ",
 StyleBox["H",
  FontWeight->"Bold"],
 "\[CenterDot]",
 StyleBox["m",
  FontWeight->"Bold"],
 " Kernel (MasterInteractionCartLLG.C):"
}], "Section",
 CellChangeTimes->{{3.859454097162725*^9, 3.8594541205702057`*^9}, 
   3.8594543320155287`*^9, {3.8594562832195*^9, 3.859456283699354*^9}, {
   3.859457585939172*^9, 
   3.8594575922114077`*^9}},ExpressionUUID->"1eb70cb9-3f6b-478b-8701-\
8e5b2f9099d7"],

Cell[CellGroupData[{

Cell["Residuals:", "Subsection",
 CellChangeTimes->{{3.859454196737364*^9, 
  3.859454198170306*^9}},ExpressionUUID->"f97e0d79-c179-4b75-9faa-\
2f019990f666"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RHSmxInt", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"RHSmx", ",", "\[CapitalSigma]int"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmyInt", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"RHSmy", ",", "\[CapitalSigma]int"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmzInt", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"RHSmz", ",", "\[CapitalSigma]int"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.859454126338169*^9, 3.8594541383034077`*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"e8540ff3-45b4-4e6a-a5ef-845c75c12e3b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RHSmxInt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
     RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
     RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{{3.859454145153645*^9, 3.8594541671294823`*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"2b8cd4b0-ae56-47e2-ab49-704fe410f31c"],

Cell["\<\
(g0*(alpha*dPotdy*mx*my - dPotdy*mz + dPotdz*(my + alpha*mx*mz) - \
alpha*dPotdx*(Power(my,2) + Power(mz,2)))*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{{3.8594541466254873`*^9, 3.859454167797728*^9}, 
   3.859521658846627*^9, {3.872584816916359*^9, 3.872584846373106*^9}},
 CellLabel->
  "Out[147]//CForm=",ExpressionUUID->"13c37e15-d5e2-4812-a83d-957a619ba97f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RHSmyInt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
     RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
     RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{3.85945417252925*^9},
 CellLabel->
  "In[148]:=",ExpressionUUID->"90115758-e8fe-46c7-a507-7592ce0ffefc"],

Cell["\<\
(g0*(dPotdx*(alpha*mx*my + mz) + dPotdz*(-mx + alpha*my*mz) - \
alpha*dPotdy*(Power(mx,2) + Power(mz,2)))*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.85945417363416*^9, 3.859521658875853*^9, {3.8725848169625187`*^9, 
   3.8725848463901663`*^9}},
 CellLabel->
  "Out[148]//CForm=",ExpressionUUID->"6f50c14b-1f9f-405d-a957-9e3c6a0e5769"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RHSmzInt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
     RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
     RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{3.8594541760651073`*^9},
 CellLabel->
  "In[149]:=",ExpressionUUID->"42642eeb-9930-4004-bda7-15f955b12d43"],

Cell["\<\
(g0*(-(dPotdx*my) - alpha*dPotdz*(Power(mx,2) + Power(my,2)) + \
alpha*dPotdx*mx*mz + dPotdy*(mx + alpha*my*mz))*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859454176913342*^9, 3.859521658897143*^9, {3.87258481697528*^9, 
   3.872584846410522*^9}},
 CellLabel->
  "Out[149]//CForm=",ExpressionUUID->"a37d4bda-0507-4d19-94b5-5238b5da4831"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["On-diagonal jacobians:", "Subsection",
 CellChangeTimes->{{3.859454202218996*^9, 
  3.8594542045447407`*^9}},ExpressionUUID->"da3f382b-10b3-46d8-a2d6-\
57f533c78806"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", " ", 
    RowBox[{"D", "[", 
     RowBox[{"RHSmxInt", ",", "mx"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
     RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
     RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{{3.8594542226670237`*^9, 3.859454226272147*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"acbd141b-9cc8-4338-8205-85bc1f2a0f79"],

Cell["\<\
(g0*(alpha*dPotdy*my + alpha*dPotdz*mz)*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859454227309667*^9, 3.85952165891805*^9, {3.872584816993429*^9, 
   3.872584846431013*^9}},
 CellLabel->
  "Out[150]//CForm=",ExpressionUUID->"ed0e39c9-47bf-4d17-956a-df987a4cdca0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", " ", 
    RowBox[{"D", "[", 
     RowBox[{"RHSmyInt", ",", "my"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
     RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
     RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{{3.8594542327421703`*^9, 3.8594542342160873`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"774280cb-8c36-4f4b-b1a4-35088361336b"],

Cell["\<\
(g0*(alpha*dPotdx*mx + alpha*dPotdz*mz)*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859454234768477*^9, 3.859521658951789*^9, {3.8725848170109367`*^9, 
   3.872584846452416*^9}},
 CellLabel->
  "Out[151]//CForm=",ExpressionUUID->"5e906ffc-7185-4114-acb9-78e0db94cbc8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", " ", 
    RowBox[{"D", "[", 
     RowBox[{"RHSmzInt", ",", "mz"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
     RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
     RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{{3.8594542374641447`*^9, 3.859454239168212*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"b86db1df-f884-4c4a-b783-4c15d93143ac"],

Cell["\<\
(g0*(alpha*dPotdx*mx + alpha*dPotdy*my)*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859454239640512*^9, 3.8595216589861593`*^9, {3.8725848170294027`*^9, 
   3.872584846473781*^9}},
 CellLabel->
  "Out[152]//CForm=",ExpressionUUID->"a5d83837-6288-4b9a-897d-605c5c761828"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Off-diagonal jacobians (note we need ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["dR", 
     SubscriptBox["m", "j"]], "/", "d\[CapitalPhi]"}], TraditionalForm]],
  ExpressionUUID->"33dacc77-fbb8-4598-9ae3-0d5bf8d4a86a"],
 " as well as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["dR", 
     SubscriptBox["m", "j"]], "/", 
    SubscriptBox["dm", "k"]}], TraditionalForm]],ExpressionUUID->
  "154c6ae6-2dfb-466b-b174-7df6a389d7b6"],
 " for j \[NotEqual] k):"
}], "Subsection",
 CellChangeTimes->{{3.859454244712083*^9, 3.8594542496283703`*^9}, {
  3.859462481091673*^9, 3.85946252287106*^9}, {3.859465043701427*^9, 
  3.859465044581237*^9}},ExpressionUUID->"1de30c6a-fe45-4c95-b5fb-\
e17b4ce58d41"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", " ", 
    RowBox[{"D", "[", 
     RowBox[{"RHSmxInt", ",", "my"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
     RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
     RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{3.859454254423929*^9},
 CellLabel->
  "In[153]:=",ExpressionUUID->"2018619b-2952-4035-92d0-0556eb8b2477"],

Cell["\<\
(g0*(dPotdz + alpha*dPotdy*mx - 2*alpha*dPotdx*my)*phi*test)/(1 + \
Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859454254691798*^9, 3.859521659011818*^9, {3.872584817045298*^9, 
   3.872584846496202*^9}},
 CellLabel->
  "Out[153]//CForm=",ExpressionUUID->"65cce769-73ab-4369-a0ae-b258aa8ee574"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", " ", 
    RowBox[{"D", "[", 
     RowBox[{"RHSmxInt", ",", "mz"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
     RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
     RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{3.859454257735832*^9},
 CellLabel->
  "In[154]:=",ExpressionUUID->"f4f9f2d9-953f-4ad0-a407-f41277f0b002"],

Cell["\<\
(g0*(-dPotdy + alpha*dPotdz*mx - 2*alpha*dPotdx*mz)*phi*test)/(1 + \
Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.8594542579036303`*^9, 3.8595216590371304`*^9, {3.872584817063941*^9, 
   3.872584846517983*^9}},
 CellLabel->
  "Out[154]//CForm=",ExpressionUUID->"c939176c-2f8d-47c6-bd35-22ad0dfceb10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"RHSmxInt", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d\[CapitalPhi]dx", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dx", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dy", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dy", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dz", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dz", "[", "\[CapitalPhi]0", "]"}]}]}], 
        "}"}]}], ",", "\[CapitalPhi]0"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dx", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidx"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dy", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidy"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dz", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidz"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.859462113883047*^9, 3.8594621710902367`*^9}, {
  3.859462227001292*^9, 3.859462249227367*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"36311f35-d897-4fbc-a58a-f8f681a47a41"],

Cell["\<\
(g0*(alpha*dphidy*mx*my - dphidy*mz + dphidz*(my + alpha*mx*mz) - \
alpha*dphidx*(Power(my,2) + Power(mz,2)))*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{{3.85946211070222*^9, 3.859462148839085*^9}, {
   3.859462230759698*^9, 3.859462249878443*^9}, 3.8595216590720577`*^9, {
   3.872584817092162*^9, 3.8725848465442743`*^9}},
 CellLabel->
  "Out[155]//CForm=",ExpressionUUID->"f52ae2eb-c8d9-4da4-96c8-28ae60fb7540"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", " ", 
    RowBox[{"D", "[", 
     RowBox[{"RHSmyInt", ",", "mx"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
     RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
     RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{3.8594542609438543`*^9},
 CellLabel->
  "In[156]:=",ExpressionUUID->"3f2b81b0-5ead-4300-9d91-e20b4c0a19fe"],

Cell["\<\
(g0*(-dPotdz - 2*alpha*dPotdy*mx + alpha*dPotdx*my)*phi*test)/(1 + \
Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.8594542614105988`*^9, 3.859521659088153*^9, {3.87258481710882*^9, 
   3.872584846562173*^9}},
 CellLabel->
  "Out[156]//CForm=",ExpressionUUID->"0e13cb4b-1fa5-4599-98d9-accb91d6c916"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", " ", 
    RowBox[{"D", "[", 
     RowBox[{"RHSmyInt", ",", "mz"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
     RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
     RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{{3.8594542643596992`*^9, 3.859454266879714*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"65398c36-3309-44d8-934c-ef1dcda712e0"],

Cell["\<\
(g0*(dPotdx + alpha*dPotdz*my - 2*alpha*dPotdy*mz)*phi*test)/(1 + \
Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859454267480404*^9, 3.8595216591108103`*^9, {3.872584817127651*^9, 
   3.872584846583548*^9}},
 CellLabel->
  "Out[157]//CForm=",ExpressionUUID->"47902ad6-ad7c-4593-9716-8f07ab963f8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"RHSmyInt", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d\[CapitalPhi]dx", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dx", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dy", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dy", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dz", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dz", "[", "\[CapitalPhi]0", "]"}]}]}], 
        "}"}]}], ",", "\[CapitalPhi]0"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dx", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidx"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dy", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidy"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dz", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidz"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{3.8594624698103027`*^9},
 CellLabel->
  "In[158]:=",ExpressionUUID->"9e6f6d89-7164-435e-a8d2-5ce9d6242ae7"],

Cell["\<\
(g0*(dphidx*(alpha*mx*my + mz) + dphidz*(-mx + alpha*my*mz) - \
alpha*dphidy*(Power(mx,2) + Power(mz,2)))*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859462470431826*^9, 3.85952165915624*^9, {3.872584817154666*^9, 
   3.872584846609975*^9}},
 CellLabel->
  "Out[158]//CForm=",ExpressionUUID->"4dddf281-79bd-45c4-8e28-768e166bbd12"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", " ", 
    RowBox[{"D", "[", 
     RowBox[{"RHSmzInt", ",", "mx"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
     RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
     RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{3.859454269985178*^9},
 CellLabel->
  "In[159]:=",ExpressionUUID->"92cfe179-45fc-4437-a487-f4a76d560462"],

Cell["\<\
(g0*(dPotdy - 2*alpha*dPotdz*mx + alpha*dPotdx*mz)*phi*test)/(1 + \
Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859454270586734*^9, 3.859521659171302*^9, {3.872584817170186*^9, 
   3.872584846628195*^9}},
 CellLabel->
  "Out[159]//CForm=",ExpressionUUID->"6e92c097-ef73-42f1-9ffd-0c4e59cae8f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", " ", 
    RowBox[{"D", "[", 
     RowBox[{"RHSmzInt", ",", "my"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{"d\[CapitalPhi]dx", "\[Rule]", "dPotdx"}], ",", 
     RowBox[{"d\[CapitalPhi]dy", "\[Rule]", "dPotdy"}], ",", 
     RowBox[{"d\[CapitalPhi]dz", "\[Rule]", "dPotdz"}]}], "}"}]}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{{3.859454272873619*^9, 3.8594542742556543`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"611e02f7-1696-46c6-9154-d1759367971b"],

Cell["\<\
(g0*(-dPotdx - 2*alpha*dPotdz*my + alpha*dPotdy*mz)*phi*test)/(1 + \
Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859454274820739*^9, 3.8595216591927156`*^9, {3.872584817187331*^9, 
   3.872584846649168*^9}},
 CellLabel->
  "Out[160]//CForm=",ExpressionUUID->"3e03fae0-65eb-4c7b-8a34-a76e57887ad5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"RHSmzInt", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d\[CapitalPhi]dx", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dx", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dy", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dy", "[", "\[CapitalPhi]0", "]"}]}], ",", 
         RowBox[{"d\[CapitalPhi]dz", "\[Rule]", 
          RowBox[{"d\[CapitalPhi]dz", "[", "\[CapitalPhi]0", "]"}]}]}], 
        "}"}]}], ",", "\[CapitalPhi]0"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dx", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidx"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dy", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidy"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d\[CapitalPhi]dz", "\[Prime]",
         MultilineFunction->None], "[", "\[CapitalPhi]0", "]"}], "\[Rule]", 
       "dphidz"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{3.8594624736843977`*^9},
 CellLabel->
  "In[161]:=",ExpressionUUID->"f79afbde-2e96-493f-bddd-49b8a63bcdfa"],

Cell["\<\
(g0*(-(dphidx*my) - alpha*dphidz*(Power(mx,2) + Power(my,2)) + \
alpha*dphidx*mx*mz + dphidy*(mx + alpha*my*mz))*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859462474268375*^9, 3.8595216592280293`*^9, {3.872584817214671*^9, 
   3.8725848466750383`*^9}},
 CellLabel->
  "Out[161]//CForm=",ExpressionUUID->"41fdabc7-6b3e-4809-8f36-42d70b5c48cf"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exchange stiffness Kernel (MasterExchangeCartLLG.C):", "Section",
 CellChangeTimes->{{3.859454324950474*^9, 3.859454330838356*^9}, {
  3.85945689746408*^9, 3.859456899071911*^9}, {3.859465998075507*^9, 
  3.8594660008040667`*^9}, {3.8595216632349167`*^9, 
  3.859521663530814*^9}},ExpressionUUID->"a32694f9-c5b7-4efd-b78f-\
ae77328d579d"],

Cell[CellGroupData[{

Cell[TextData[{
 "Algebra to get rid of second derivatives of ",
 StyleBox["m",
  FontWeight->"Bold"]
}], "Subsection",
 CellChangeTimes->{{3.85945460060161*^9, 
  3.859454608881446*^9}},ExpressionUUID->"dfa0a66d-7dd6-4e7d-a0c4-\
974a6d44e042"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"varvec", "=", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "y", ",", "z", ",", "x", ",", "y", ",", "z", ",", "x", ",", "y",
      ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intByParts1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d2mxdx2", "\[Rule]", 
      RowBox[{"-", "dmxdx"}]}], ",", 
     RowBox[{"d2mxdy2", "\[Rule]", 
      RowBox[{"-", "dmxdy"}]}], ",", 
     RowBox[{"d2mxdz2", "\[Rule]", 
      RowBox[{"-", "dmxdz"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"d2mydx2", "\[Rule]", 
      RowBox[{"-", "dmydx"}]}], ",", 
     RowBox[{"d2mydy2", "\[Rule]", 
      RowBox[{"-", "dmydy"}]}], ",", 
     RowBox[{"d2mydz2", "\[Rule]", 
      RowBox[{"-", "dmydz"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"d2mzdx2", "\[Rule]", 
      RowBox[{"-", "dmzdx"}]}], ",", 
     RowBox[{"d2mzdy2", "\[Rule]", 
      RowBox[{"-", "dmzdy"}]}], ",", 
     RowBox[{"d2mzdz2", "\[Rule]", 
      RowBox[{"-", "dmzdz"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"mx", "\[Rule]", 
      RowBox[{"mx", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
     RowBox[{"my", "\[Rule]", 
      RowBox[{"my", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
     RowBox[{"mz", "\[Rule]", 
      RowBox[{"mz", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
     RowBox[{"\[Psi]h", "\[Rule]", 
      RowBox[{"\[Psi]h", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intByParts2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdx"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydx"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdx"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdy"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydy"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdy"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmxdz"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["my", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmydz"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dmzdz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mx", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "mx"}], ",", 
     RowBox[{
      RowBox[{"my", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "my"}], ",", 
     RowBox[{
      RowBox[{"mz", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "mz"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Psi]h", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "d\[Psi]hdx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Psi]h", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "d\[Psi]hdy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Psi]h", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "d\[Psi]hdz"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Psi]h", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "\[Psi]h"}]}], 
    "}"}]}], ";"}]}], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"cbbd652b-9f8a-44fb-9ee6-afcf9fbe27ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"algFEM1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mx", "\[Rule]", 
      RowBox[{"mx", "[", "m0x", "]"}]}], ",", 
     RowBox[{"my", "\[Rule]", 
      RowBox[{"my", "[", "m0y", "]"}]}], ",", 
     RowBox[{"mz", "\[Rule]", 
      RowBox[{"mz", "[", "m0z", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"dmxdx", "\[Rule]", 
      RowBox[{"dmxdx", "[", "m0x", "]"}]}], ",", 
     RowBox[{"dmxdy", "\[Rule]", 
      RowBox[{"dmxdy", "[", "m0x", "]"}]}], ",", 
     RowBox[{"dmxdz", "\[Rule]", 
      RowBox[{"dmxdz", "[", "m0x", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"dmydx", "\[Rule]", 
      RowBox[{"dmydx", "[", "m0y", "]"}]}], ",", 
     RowBox[{"dmydy", "\[Rule]", 
      RowBox[{"dmydy", "[", "m0y", "]"}]}], ",", 
     RowBox[{"dmydz", "\[Rule]", 
      RowBox[{"dmydz", "[", "m0y", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"dmzdx", "\[Rule]", 
      RowBox[{"dmzdx", "[", "m0z", "]"}]}], ",", 
     RowBox[{"dmzdy", "\[Rule]", 
      RowBox[{"dmzdy", "[", "m0z", "]"}]}], ",", 
     RowBox[{"dmzdz", "\[Rule]", 
      RowBox[{"dmzdz", "[", "m0z", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"algFEM2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["dmxdx", "\[Prime]",
        MultilineFunction->None], "[", "m0x", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmxdy", "\[Prime]",
        MultilineFunction->None], "[", "m0x", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmxdz", "\[Prime]",
        MultilineFunction->None], "[", "m0x", "]"}], "\[Rule]", "dphidz"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmydx", "\[Prime]",
        MultilineFunction->None], "[", "m0y", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmydy", "\[Prime]",
        MultilineFunction->None], "[", "m0y", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmydz", "\[Prime]",
        MultilineFunction->None], "[", "m0y", "]"}], "\[Rule]", "dphidz"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmzdx", "\[Prime]",
        MultilineFunction->None], "[", "m0z", "]"}], "\[Rule]", "dphidx"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmzdy", "\[Prime]",
        MultilineFunction->None], "[", "m0z", "]"}], "\[Rule]", "dphidy"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dmzdz", "\[Prime]",
        MultilineFunction->None], "[", "m0z", "]"}], "\[Rule]", "dphidz"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mx", "[", "m0x", "]"}], "\[Rule]", "mx"}], ",", 
     RowBox[{
      RowBox[{"my", "[", "m0y", "]"}], "\[Rule]", "my"}], ",", 
     RowBox[{
      RowBox[{"mz", "[", "m0z", "]"}], "\[Rule]", "mz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dmxdx", "[", "m0x", "]"}], "->", "dmxdx"}], ",", 
     RowBox[{
      RowBox[{"dmxdy", "[", "m0x", "]"}], "\[Rule]", "dmxdy"}], ",", 
     RowBox[{
      RowBox[{"dmxdz", "[", "m0x", "]"}], "\[Rule]", "dmxdz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dmydx", "[", "m0y", "]"}], "->", "dmydx"}], ",", 
     RowBox[{
      RowBox[{"dmydy", "[", "m0y", "]"}], "\[Rule]", "dmydy"}], ",", 
     RowBox[{
      RowBox[{"dmydz", "[", "m0y", "]"}], "\[Rule]", "dmydz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dmzdx", "[", "m0z", "]"}], "->", "dmzdx"}], ",", 
     RowBox[{
      RowBox[{"dmzdy", "[", "m0z", "]"}], "\[Rule]", "dmzdy"}], ",", 
     RowBox[{
      RowBox[{"dmzdz", "[", "m0z", "]"}], "\[Rule]", "dmzdz"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mx", "\[Prime]",
        MultilineFunction->None], "[", "m0x", "]"}], "\[Rule]", "phi"}], ",", 
     
     RowBox[{
      RowBox[{
       SuperscriptBox["my", "\[Prime]",
        MultilineFunction->None], "[", "m0y", "]"}], "\[Rule]", "phi"}], ",", 
     
     RowBox[{
      RowBox[{
       SuperscriptBox["mz", "\[Prime]",
        MultilineFunction->None], "[", "m0z", "]"}], "\[Rule]", "phi"}]}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.859455933714295*^9, 3.8594559639536943`*^9}, {
  3.859456067007552*^9, 3.859456092119125*^9}, {3.859456135366631*^9, 
  3.859456141830583*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"4ea5bfa2-6ad1-4035-b345-d99b7f067e86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expandRHSmx", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"RHSmx", ",", "\[CapitalSigma]exch"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
       "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
       "d2mzdz2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numTermsRHSmx", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"RHSmx", ",", "\[CapitalSigma]exch"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
        "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
        "d2mzdz2"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmxEXCH", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"expandRHSmx", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "/.", "intByParts1"}], ",", 
         RowBox[{"varvec", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "numTermsRHSmx"}], "}"}]}], "]"}], "/.", 
     "intByParts2"}], "//", "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8594546950001383`*^9, 3.859454737583868*^9}, 
   3.859455853155562*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"bd920eb9-2b7c-4bd4-8e70-979539a05f83"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expandRHSmy", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"RHSmy", ",", "\[CapitalSigma]exch"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
       "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
       "d2mzdz2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numTermsRHSmy", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"RHSmy", ",", "\[CapitalSigma]exch"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
        "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
        "d2mzdz2"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmyEXCH", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"expandRHSmy", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "/.", "intByParts1"}], ",", 
         RowBox[{"varvec", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "numTermsRHSmy"}], "}"}]}], "]"}], "/.", 
     "intByParts2"}], "//", "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8594547644468946`*^9, 3.8594547771507397`*^9}, 
   3.859455851996077*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"832d129f-b215-49a7-9cf0-52b60d739b3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expandRHSmz", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"RHSmz", ",", "\[CapitalSigma]exch"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
       "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
       "d2mzdz2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numTermsRHSmz", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"RHSmz", ",", "\[CapitalSigma]exch"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "d2mxdx2", ",", "d2mxdy2", ",", "d2mxdz2", ",", "d2mydx2", ",", 
        "d2mydy2", ",", "d2mydz2", ",", "d2mzdx2", ",", "d2mzdy2", ",", 
        "d2mzdz2"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmzEXCH", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"expandRHSmz", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "/.", "intByParts1"}], ",", 
         RowBox[{"varvec", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "numTermsRHSmz"}], "}"}]}], "]"}], "/.", 
     "intByParts2"}], "//", "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.859455810611973*^9, 3.859455850900584*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"8bee1671-e851-4bfe-8aae-76b6746a07d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Residuals:", "Subsection",
 CellChangeTimes->{{3.859455886386323*^9, 
  3.859455887762217*^9}},ExpressionUUID->"986a0533-0a41-4a5b-ad62-\
94b97b8be7d4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmxEXCH", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.859455862747568*^9, 3.859455874897398*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"b6697560-6ccb-4395-bd06-94e7b931137d"],

Cell["\<\
(2*Ae*g0*(dmzdx*dtestdx*my + dmzdy*dtestdy*my + dmzdz*dtestdz*my + \
alpha*dmydx*dtestdx*mx*my + alpha*dmydy*dtestdy*mx*my + \
alpha*dmydz*dtestdz*mx*my - alpha*dmxdx*dtestdx*Power(my,2) - 
       alpha*dmxdy*dtestdy*Power(my,2) - alpha*dmxdz*dtestdz*Power(my,2) - \
dmydx*dtestdx*mz - dmydy*dtestdy*mz - dmydz*dtestdz*mz + \
alpha*dmzdx*dtestdx*mx*mz + alpha*dmzdy*dtestdy*mx*mz + 
       alpha*dmzdz*dtestdz*mx*mz - alpha*dmxdx*dtestdx*Power(mz,2) - \
alpha*dmxdy*dtestdy*Power(mz,2) - alpha*dmxdz*dtestdz*Power(mz,2) + 
       alpha*(Power(dmydx,2)*mx + Power(dmydy,2)*mx + Power(dmydz,2)*mx + \
Power(dmzdx,2)*mx + Power(dmzdy,2)*mx + Power(dmzdz,2)*mx - dmxdx*dmydx*my - \
dmxdy*dmydy*my - dmxdz*dmydz*my - 
          (dmxdx*dmzdx + dmxdy*dmzdy + dmxdz*dmzdz)*mz)*test))/((1 + \
Power(alpha,2))*Ms)\
\>", "Output",
 CellLabel->
  "Out[58]//CForm=",ExpressionUUID->"c1f0cb20-7a1d-4fca-bb54-9825547cf85f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmyEXCH", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.859455877850737*^9, 3.8594558783628483`*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"6583db58-0939-4282-82fb-033cb5d69a40"],

Cell["\<\
(4*Ae*g0*(-(dmzdx*dtestdx*mx) - dmzdy*dtestdy*mx - dmzdz*dtestdz*mx - \
alpha*dmydx*dtestdx*Power(mx,2) - alpha*dmydy*dtestdy*Power(mx,2) - \
alpha*dmydz*dtestdz*Power(mx,2) + alpha*dmxdx*dtestdx*mx*my + \
alpha*dmxdy*dtestdy*mx*my + alpha*dmxdz*dtestdz*mx*my + 
       dmxdx*dtestdx*mz + dmxdy*dtestdy*mz + dmxdz*dtestdz*mz + \
alpha*dmzdx*dtestdx*my*mz + alpha*dmzdy*dtestdy*my*mz + \
alpha*dmzdz*dtestdz*my*mz - alpha*dmydx*dtestdx*Power(mz,2) - \
alpha*dmydy*dtestdy*Power(mz,2) - alpha*dmydz*dtestdz*Power(mz,2) + 
       alpha*(-(dmxdx*dmydx*mx) - dmxdy*dmydy*mx - dmxdz*dmydz*mx + \
Power(dmxdx,2)*my + Power(dmxdy,2)*my + Power(dmxdz,2)*my + Power(dmzdx,2)*my \
+ Power(dmzdy,2)*my + Power(dmzdz,2)*my - (dmydx*dmzdx + dmydy*dmzdy + \
dmydz*dmzdz)*mz)*test))/
   ((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.8594558788942432`*^9, 3.8594658735872183`*^9, 3.859521671606842*^9, 
   3.859521767580714*^9, 3.859522774690559*^9, {3.872584819375107*^9, 
   3.872584847429483*^9}},
 CellLabel->
  "Out[177]//CForm=",ExpressionUUID->"4f2fc5ae-0481-4f52-96c9-acfd60189b4f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmzEXCH", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellLabel->
  "In[178]:=",ExpressionUUID->"f1732d53-ef7c-4167-8b9b-272a718276d1"],

Cell["\<\
(4*Ae*g0*(dmydx*dtestdx*mx + dmydy*dtestdy*mx + dmydz*dtestdz*mx - \
alpha*dmzdx*dtestdx*Power(mx,2) - alpha*dmzdy*dtestdy*Power(mx,2) - \
alpha*dmzdz*dtestdz*Power(mx,2) - dmxdx*dtestdx*my - dmxdy*dtestdy*my - \
dmxdz*dtestdz*my - 
       alpha*dmzdx*dtestdx*Power(my,2) - alpha*dmzdy*dtestdy*Power(my,2) - \
alpha*dmzdz*dtestdz*Power(my,2) + alpha*dmxdx*dtestdx*mx*mz + \
alpha*dmxdy*dtestdy*mx*mz + alpha*dmxdz*dtestdz*mx*mz + \
alpha*dmydx*dtestdx*my*mz + alpha*dmydy*dtestdy*my*mz + 
       alpha*dmydz*dtestdz*my*mz + alpha*(-(dmxdx*dmzdx*mx) - dmxdy*dmzdy*mx \
- dmxdz*dmzdz*mx - dmydx*dmzdx*my - dmydy*dmzdy*my - dmydz*dmzdz*my + \
(Power(dmxdx,2) + Power(dmxdy,2) + Power(dmxdz,2) + Power(dmydx,2) + \
Power(dmydy,2) + Power(dmydz,2))*mz)*test
       ))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859455880357052*^9, 3.859465875640324*^9, 3.859521671891507*^9, 
   3.859521767852254*^9, 3.859522774737979*^9, {3.8725848197602673`*^9, 
   3.872584847765704*^9}},
 CellLabel->
  "Out[178]//CForm=",ExpressionUUID->"a6bbf3a2-0364-4d18-876c-a9d76938e5a6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["On-diagonal jacobians:", "Subsection",
 CellChangeTimes->{{3.859455893090055*^9, 
  3.859455896659401*^9}},ExpressionUUID->"1090829e-b661-410c-8e30-\
702a670b5b46"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxEXCH", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.85945590832185*^9, 3.859455911522373*^9}, {
  3.859456119967637*^9, 3.859456147573812*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"f10697c5-db2e-44f7-b4eb-d98388ece053"],

Cell["\<\
(4*Ae*alpha*g0*(-(dphidz*dtestdz*Power(my,2)) - dphidz*dtestdz*Power(mz,2) + \
dmydx*dtestdx*my*phi + dmydy*dtestdy*my*phi + dmydz*dtestdz*my*phi + \
dmzdx*dtestdx*mz*phi + dmzdy*dtestdy*mz*phi + dmzdz*dtestdz*mz*phi - \
dphidz*(dmydz*my + dmzdz*mz)*test + 
       (Power(dmydx,2) + Power(dmydy,2) + Power(dmydz,2) + Power(dmzdx,2) + \
Power(dmzdy,2) + Power(dmzdz,2))*phi*test - dphidy*(dtestdy*Power(my,2) + \
dtestdy*Power(mz,2) + dmydy*my*test + dmzdy*mz*test) - 
       dphidx*(dtestdx*(Power(my,2) + Power(mz,2)) + (dmydx*my + \
dmzdx*mz)*test)))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{{3.859456098153928*^9, 3.859456147893773*^9}, 
   3.859465955040092*^9, 3.859521671929638*^9, 3.8595217680384073`*^9, 
   3.859522774819702*^9, {3.872584820185502*^9, 3.8725848480298347`*^9}},
 CellLabel->
  "Out[179]//CForm=",ExpressionUUID->"ff91e447-6ad7-4da2-9e2b-905e3ee3391a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyEXCH", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.8594561538055887`*^9, 3.859456156429606*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"0d371c4c-47e0-461f-a15c-e8577d08a6af"],

Cell["\<\
(4*Ae*alpha*g0*(-(dphidz*dtestdz*Power(mx,2)) - dphidz*dtestdz*Power(mz,2) + \
dmxdx*dtestdx*mx*phi + dmxdy*dtestdy*mx*phi + dmxdz*dtestdz*mx*phi + \
dmzdx*dtestdx*mz*phi + dmzdy*dtestdy*mz*phi + dmzdz*dtestdz*mz*phi - \
dphidz*(dmxdz*mx + dmzdz*mz)*test + 
       (Power(dmxdx,2) + Power(dmxdy,2) + Power(dmxdz,2) + Power(dmzdx,2) + \
Power(dmzdy,2) + Power(dmzdz,2))*phi*test - dphidy*(dtestdy*Power(mx,2) + \
dtestdy*Power(mz,2) + dmxdy*mx*test + dmzdy*mz*test) - 
       dphidx*(dtestdx*(Power(mx,2) + Power(mz,2)) + (dmxdx*mx + \
dmzdx*mz)*test)))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.8594561576636343`*^9, 3.859465957857915*^9, 3.8595216720087967`*^9, 
   3.859521768196735*^9, 3.859522774843498*^9, {3.8725848205767603`*^9, 
   3.872584848270042*^9}},
 CellLabel->
  "Out[180]//CForm=",ExpressionUUID->"dabd2338-305d-4fd0-a209-aebea39edbe2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzEXCH", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.859456160997315*^9, 3.859456164245591*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"b1c4710d-a3f9-4d88-8ff6-5961faff1e43"],

Cell["\<\
(4*Ae*alpha*g0*(-(dphidz*dtestdz*Power(mx,2)) - dphidz*dtestdz*Power(my,2) + \
dmxdx*dtestdx*mx*phi + dmxdy*dtestdy*mx*phi + dmxdz*dtestdz*mx*phi + \
dmydx*dtestdx*my*phi + dmydy*dtestdy*my*phi + dmydz*dtestdz*my*phi - \
dphidz*(dmxdz*mx + dmydz*my)*test + 
       (Power(dmxdx,2) + Power(dmxdy,2) + Power(dmxdz,2) + Power(dmydx,2) + \
Power(dmydy,2) + Power(dmydz,2))*phi*test - dphidy*(dtestdy*Power(mx,2) + \
dtestdy*Power(my,2) + dmxdy*mx*test + dmydy*my*test) - 
       dphidx*(dtestdx*(Power(mx,2) + Power(my,2)) + (dmxdx*mx + \
dmydx*my)*test)))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859456165421711*^9, 3.8594659708436937`*^9, 3.859521672134996*^9, 
   3.859521768339664*^9, 3.8595227748915577`*^9, {3.872584821033392*^9, 
   3.87258484845675*^9}},
 CellLabel->
  "Out[181]//CForm=",ExpressionUUID->"292467f4-7d42-4f7a-ba5f-4a9592e298c4"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Off-diagonal jacobians:", "Subsection",
 CellChangeTimes->{{3.859456168909107*^9, 
  3.859456171389287*^9}},ExpressionUUID->"26928bba-00cb-4fa5-a625-\
8a6cef5c3f7e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxEXCH", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.859456189372953*^9, 3.859456192932907*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"17b2bbd8-af26-45c5-96df-da6b14380108"],

Cell["\<\
(4*Ae*g0*(-((dphidx*dtestdx + dphidy*dtestdy + dphidz*dtestdz)*mz) + \
(dmzdx*dtestdx + dmzdy*dtestdy + dmzdz*dtestdz)*phi + 
       alpha*(dphidx*dtestdx*mx*my + dphidy*dtestdy*mx*my + \
dphidz*dtestdz*mx*my + dmydx*dtestdx*mx*phi + dmydy*dtestdy*mx*phi + \
dmydz*dtestdz*mx*phi - 2*dmxdx*dtestdx*my*phi - 2*dmxdy*dtestdy*my*phi - \
2*dmxdz*dtestdz*my*phi + 
          (2*dmydx*dphidx*mx + 2*dmydy*dphidy*mx + 2*dmydz*dphidz*mx - \
dmxdx*dphidx*my - dmxdy*dphidy*my - dmxdz*dphidz*my - (dmxdx*dmydx + \
dmxdy*dmydy + dmxdz*dmydz)*phi)*test)))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859456194534576*^9, 3.859465976931435*^9, 3.8595216724649076`*^9, 
   3.859521768532598*^9, 3.859522774995534*^9, {3.872584821538953*^9, 
   3.8725848487537317`*^9}},
 CellLabel->
  "Out[182]//CForm=",ExpressionUUID->"9b243ce4-38fa-4cf0-aae0-94bf72876c43"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmxEXCH", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{3.859456201901112*^9},
 CellLabel->
  "In[183]:=",ExpressionUUID->"85d727c5-1390-4c5c-84e3-3e3e64b4d63f"],

Cell["\<\
(4*Ae*g0*(dphidx*dtestdx*my + dphidy*dtestdy*my + dphidz*dtestdz*my + \
alpha*dphidx*dtestdx*mx*mz + alpha*dphidy*dtestdy*mx*mz + \
alpha*dphidz*dtestdz*mx*mz - dmydx*dtestdx*phi - dmydy*dtestdy*phi - \
dmydz*dtestdz*phi + alpha*dmzdx*dtestdx*mx*phi + 
       alpha*dmzdy*dtestdy*mx*phi + alpha*dmzdz*dtestdz*mx*phi - \
2*alpha*dmxdx*dtestdx*mz*phi - 2*alpha*dmxdy*dtestdy*mz*phi - \
2*alpha*dmxdz*dtestdz*mz*phi + 
       alpha*(2*dmzdx*dphidx*mx + 2*dmzdy*dphidy*mx + 2*dmzdz*dphidz*mx - \
(dmxdx*dphidx + dmxdy*dphidy + dmxdz*dphidz)*mz - (dmxdx*dmzdx + dmxdy*dmzdy \
+ dmxdz*dmzdz)*phi)*test))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859456203251176*^9, 3.8594659779648113`*^9, 3.859521672816935*^9, 
   3.859521768702044*^9, 3.859522775013929*^9, {3.8725848219800777`*^9, 
   3.872584849123867*^9}},
 CellLabel->
  "Out[183]//CForm=",ExpressionUUID->"d6ec4455-6fe4-4ceb-9ac8-d36389a0ac53"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyEXCH", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.859456244924058*^9, 3.859456246724444*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"df639213-dbb9-44c9-8e3e-38d1302ecb25"],

Cell["\<\
(4*Ae*g0*((dphidx*dtestdx + dphidy*dtestdy + dphidz*dtestdz)*mz - \
(dmzdx*dtestdx + dmzdy*dtestdy + dmzdz*dtestdz)*phi + 
       alpha*(dphidx*dtestdx*mx*my + dphidy*dtestdy*mx*my + \
dphidz*dtestdz*mx*my - 2*dmydx*dtestdx*mx*phi - 2*dmydy*dtestdy*mx*phi - \
2*dmydz*dtestdz*mx*phi + dmxdx*dtestdx*my*phi + dmxdy*dtestdy*my*phi + \
dmxdz*dtestdz*my*phi - 
          (dmydx*dphidx*mx + dmydy*dphidy*mx + dmydz*dphidz*mx - \
2*dmxdx*dphidx*my - 2*dmxdy*dphidy*my - 2*dmxdz*dphidz*my + dmxdx*dmydx*phi + \
dmxdy*dmydy*phi + dmxdz*dmydz*phi)*test)))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859456247977394*^9, 3.859465979550769*^9, 3.8595216730508957`*^9, 
   3.859521768955464*^9, 3.8595227750617313`*^9, {3.8725848223804197`*^9, 
   3.8725848493893023`*^9}},
 CellLabel->
  "Out[184]//CForm=",ExpressionUUID->"603c5527-b331-43ce-a921-ab818aea8896"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmyEXCH", "/.", "algFEM1"}], ",", "m0z"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{3.8594562502119417`*^9},
 CellLabel->
  "In[185]:=",ExpressionUUID->"fb659ac5-49c0-4cb3-b9f1-7048591d054c"],

Cell["\<\
(4*Ae*g0*(-(dphidx*dtestdx*mx) - dphidy*dtestdy*mx - dphidz*dtestdz*mx + \
alpha*dphidx*dtestdx*my*mz + alpha*dphidy*dtestdy*my*mz + \
alpha*dphidz*dtestdz*my*mz + dmxdx*dtestdx*phi + dmxdy*dtestdy*phi + \
dmxdz*dtestdz*phi + alpha*dmzdx*dtestdx*my*phi + 
       alpha*dmzdy*dtestdy*my*phi + alpha*dmzdz*dtestdz*my*phi - \
2*alpha*dmydx*dtestdx*mz*phi - 2*alpha*dmydy*dtestdy*mz*phi - \
2*alpha*dmydz*dtestdz*mz*phi + 
       alpha*(2*dmzdx*dphidx*my + 2*dmzdy*dphidy*my + 2*dmzdz*dphidz*my - \
(dmydx*dphidx + dmydy*dphidy + dmydz*dphidz)*mz - (dmydx*dmzdx + dmydy*dmzdy \
+ dmydz*dmzdz)*phi)*test))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.8594562526453238`*^9, 3.859465980598298*^9, 3.8595216733629713`*^9, 
   3.8595217691511307`*^9, 3.8595227751080503`*^9, {3.872584822821579*^9, 
   3.872584849746729*^9}},
 CellLabel->
  "Out[185]//CForm=",ExpressionUUID->"849ed472-ed34-4e64-bd34-6313493315cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzEXCH", "/.", "algFEM1"}], ",", "m0x"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.859456255172226*^9, 3.859456257747904*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"0dc53e7a-34e4-462a-917f-65a1a342654a"],

Cell["\<\
(4*Ae*g0*(-(dphidx*dtestdx*my) - dphidy*dtestdy*my - dphidz*dtestdz*my + \
alpha*dphidx*dtestdx*mx*mz + alpha*dphidy*dtestdy*mx*mz + \
alpha*dphidz*dtestdz*mx*mz + dmydx*dtestdx*phi + dmydy*dtestdy*phi + \
dmydz*dtestdz*phi - 2*alpha*dmzdx*dtestdx*mx*phi - 
       2*alpha*dmzdy*dtestdy*mx*phi - 2*alpha*dmzdz*dtestdz*mx*phi + \
alpha*dmxdx*dtestdx*mz*phi + alpha*dmxdy*dtestdy*mz*phi + \
alpha*dmxdz*dtestdz*mz*phi - 
       alpha*(dmzdx*dphidx*mx + dmzdy*dphidy*mx + dmzdz*dphidz*mx - \
2*dmxdx*dphidx*mz - 2*dmxdy*dphidy*mz - 2*dmxdz*dphidz*mz + dmxdx*dmzdx*phi + \
dmxdy*dmzdy*phi + dmxdz*dmzdz*phi)*test))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.8594562585137463`*^9, 3.859465981498514*^9, 3.859521673653747*^9, 
   3.8595217693265142`*^9, 3.859522775134984*^9, {3.872584823157052*^9, 
   3.872584850034787*^9}},
 CellLabel->
  "Out[186]//CForm=",ExpressionUUID->"027b1608-cb5c-4120-93f5-fa9e80119a26"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"RHSmzEXCH", "/.", "algFEM1"}], ",", "m0y"}], "]"}], "/.", 
     "algFEM2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"d\[Psi]hdx", "\[Rule]", "dtestdx"}], ",", 
      RowBox[{"d\[Psi]hdy", "\[Rule]", "dtestdy"}], ",", 
      RowBox[{"d\[Psi]hdz", "\[Rule]", "dtestdz"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "CForm"}]], "Input",
 CellChangeTimes->{{3.8594562611717167`*^9, 3.8594562641797*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"1b77f486-d679-4c60-a45b-c21f3568e3bd"],

Cell["\<\
(4*Ae*g0*(dphidx*dtestdx*mx + dphidy*dtestdy*mx + dphidz*dtestdz*mx + \
alpha*dphidx*dtestdx*my*mz + alpha*dphidy*dtestdy*my*mz + \
alpha*dphidz*dtestdz*my*mz - dmxdx*dtestdx*phi - dmxdy*dtestdy*phi - \
dmxdz*dtestdz*phi - 2*alpha*dmzdx*dtestdx*my*phi - 
       2*alpha*dmzdy*dtestdy*my*phi - 2*alpha*dmzdz*dtestdz*my*phi + \
alpha*dmydx*dtestdx*mz*phi + alpha*dmydy*dtestdy*mz*phi + \
alpha*dmydz*dtestdz*mz*phi - 
       alpha*(dmzdx*dphidx*my + dmzdy*dphidy*my + dmzdz*dphidz*my - \
2*dmydx*dphidx*mz - 2*dmydy*dphidy*mz - 2*dmydz*dphidz*mz + dmydx*dmzdx*phi + \
dmydy*dmzdy*phi + dmydz*dmzdz*phi)*test))/((1 + Power(alpha,2))*Ms)\
\>", "Output",
 CellChangeTimes->{
  3.859456265196096*^9, 3.859465982882558*^9, 3.859521673911874*^9, 
   3.859521769475926*^9, 3.859522775170735*^9, {3.8725848235432463`*^9, 
   3.8725848503276587`*^9}},
 CellLabel->
  "Out[187]//CForm=",ExpressionUUID->"d9812a0a-92ea-48b2-a357-607902596061"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "LLB restoring force Kernel (MasterLongitudinalLLB.C):\n\n          ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["\[Kappa]",
      FontWeight->"Bold"], "LLB"], "(", 
    StyleBox["m",
     FontWeight->"Bold"], ")"}], TraditionalForm]],ExpressionUUID->
  "51901bcf-bc3d-4b79-ad03-f7c6de899d23"],
 " = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"+", 
     FractionBox[
      RowBox[{"\[Gamma]", " ", 
       SubscriptBox["\[Alpha]", "||"]}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Alpha]", "2"]}], ")"}]]}], 
    RowBox[{
     SuperscriptBox["m", "2"], "(", 
     RowBox[{
      SuperscriptBox["m", "2"], "-", 
      SubscriptBox["f", "D"]}], ")"}], 
    StyleBox["m",
     FontWeight->"Bold"]}], TraditionalForm]],ExpressionUUID->
  "f26fcdd6-3fe3-4283-b078-f5fe32269fca"],
 "\n\t\t\t",
 StyleBox["note that at T = 0 K, ", "Subsection"],
 StyleBox[Cell[BoxData[
  FormBox[
   SubscriptBox["f", "D"], TraditionalForm]], "Subsection",ExpressionUUID->
  "a93e19a1-2295-48e9-8883-d9ac936fdb31"], "Subsection"],
 StyleBox[" \[Congruent] 1  and can be modified to change the magnitude of ", 
  "Subsection"],
 StyleBox["m ", "Subsection",
  FontWeight->"Bold"],
 StyleBox["as a function of input temperature.", "Subsection"]
}], "Section",
 CellChangeTimes->{{3.859457843566513*^9, 3.859457898429648*^9}, {
  3.859458029619331*^9, 3.859458067884183*^9}, {3.859458796493598*^9, 
  3.8594587973180523`*^9}, {3.859459654782596*^9, 3.859459713713361*^9}, {
  3.859459990264295*^9, 3.8594600079043694`*^9}, {3.859531382488587*^9, 
  3.859531392289166*^9}},ExpressionUUID->"9f77809f-e1df-4754-8cd6-\
194cbc49760c"],

Cell[CellGroupData[{

Cell["Residuals:", "Subsection",
 CellChangeTimes->{{3.859458474746984*^9, 
  3.859458475731093*^9}},ExpressionUUID->"51ffd352-12ff-4714-a46c-\
f27c7cb89911"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RHSmxLLB", "=", 
   RowBox[{"\[Psi]h", 
    FractionBox[
     RowBox[{"\[Gamma]", " ", "\[Alpha]L"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[Alpha]", "2"]}], ")"}]], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["mx", "2"], "+", 
      SuperscriptBox["my", "2"], "+", 
      SuperscriptBox["mz", "2"]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["mx", "2"], "+", 
        SuperscriptBox["my", "2"], "+", 
        SuperscriptBox["mz", "2"]}], ")"}], "-", "fD"}], ")"}], "mx"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmyLLB", "=", 
   RowBox[{"\[Psi]h", 
    FractionBox[
     RowBox[{"\[Gamma]", " ", "\[Alpha]L"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[Alpha]", "2"]}], ")"}]], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["mx", "2"], "+", 
      SuperscriptBox["my", "2"], "+", 
      SuperscriptBox["mz", "2"]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["mx", "2"], "+", 
        SuperscriptBox["my", "2"], "+", 
        SuperscriptBox["mz", "2"]}], ")"}], "-", "fD"}], ")"}], "my"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHSmzLLB", "=", 
   RowBox[{"\[Psi]h", 
    FractionBox[
     RowBox[{"\[Gamma]", " ", "\[Alpha]L"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[Alpha]", "2"]}], ")"}]], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["mx", "2"], "+", 
      SuperscriptBox["my", "2"], "+", 
      SuperscriptBox["mz", "2"]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["mx", "2"], "+", 
        SuperscriptBox["my", "2"], "+", 
        SuperscriptBox["mz", "2"]}], ")"}], "-", "fD"}], ")"}], "mz"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.859458497645678*^9, 3.8594585490338163`*^9}, {
  3.8594585826976137`*^9, 3.859458584105126*^9}, {3.859458669855936*^9, 
  3.859458712903475*^9}, {3.8594593262526693`*^9, 3.859459331092339*^9}, {
  3.859459693998187*^9, 3.859459722029771*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"fe5b5e11-56b4-4299-ac48-3b4a69b7355b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmxLLB", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Alpha]L", "\[Rule]", "alphaL"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.8594585709393682`*^9, 3.8594585770494347`*^9}, {
  3.859458692040448*^9, 3.8594586956472197`*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"9d32bed6-b971-4a8d-a091-cc57b18a176d"],

Cell["\<\
(alphaL*g0*mx*(Power(mx,2) + Power(my,2) + Power(mz,2))*(-fD + Power(mx,2) + \
Power(my,2) + Power(mz,2))*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{{3.8594585776159897`*^9, 3.859458585639083*^9}, {
   3.859458689317111*^9, 3.8594586959200983`*^9}, 3.859459332958479*^9, 
   3.85945972767754*^9, 3.859521673967071*^9, {3.872584823592023*^9, 
   3.872584850376007*^9}},
 CellLabel->
  "Out[191]//CForm=",ExpressionUUID->"b981019f-5134-4350-9366-c073a7599bea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmyLLB", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Alpha]L", "\[Rule]", "alphaL"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{3.859458805346627*^9},
 CellLabel->
  "In[192]:=",ExpressionUUID->"d933a493-4a5c-4725-9c60-83872918aa32"],

Cell["\<\
(alphaL*g0*my*(Power(mx,2) + Power(my,2) + Power(mz,2))*(-fD + Power(mx,2) + \
Power(my,2) + Power(mz,2))*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859458805555029*^9, 3.859459334360219*^9, 3.859459728313964*^9, 
   3.8595216739859467`*^9, {3.872584823623404*^9, 3.872584850394552*^9}},
 CellLabel->
  "Out[192]//CForm=",ExpressionUUID->"fffa54ad-e0bb-44a3-ab18-43f960485d10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RHSmzLLB", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Alpha]L", "\[Rule]", "alphaL"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{3.859458808885853*^9},
 CellLabel->
  "In[193]:=",ExpressionUUID->"294ce66d-9767-4f68-bdd2-0810746a4cd4"],

Cell["\<\
(alphaL*g0*mz*(Power(mx,2) + Power(my,2) + Power(mz,2))*(-fD + Power(mx,2) + \
Power(my,2) + Power(mz,2))*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.8594588093499403`*^9, 3.859459335157364*^9, 3.85945972948986*^9, 
   3.859521674027063*^9, {3.872584823643887*^9, 3.87258485041404*^9}},
 CellLabel->
  "Out[193]//CForm=",ExpressionUUID->"99a11f05-5e98-498a-aee8-0fe051ba8558"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["On-diagonal jacobians", "Subsection",
 CellChangeTimes->{{3.859459002569632*^9, 
  3.8594590065053253`*^9}},ExpressionUUID->"fc89db7b-7991-4675-8271-\
d1a43b075e22"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmxLLB", ",", "mx"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Alpha]L", "\[Rule]", "alphaL"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.859459298149221*^9, 3.8594593133123417`*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"2e87fabd-65e9-4f2b-92d7-d56be6c89e35"],

Cell["\<\
(alphaL*g0*(5*Power(mx,4) + 6*Power(mx,2)*(Power(my,2) + Power(mz,2)) + \
Power(Power(my,2) + Power(mz,2),2) - fD*(3*Power(mx,2) + Power(my,2) + \
Power(mz,2)))*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{{3.859459297012107*^9, 3.859459313911437*^9}, 
   3.859459344931419*^9, 3.859459730864286*^9, 3.859521674109819*^9, {
   3.872584823675473*^9, 3.8725848504403353`*^9}},
 CellLabel->
  "Out[194]//CForm=",ExpressionUUID->"d3b89a94-47bc-41c4-9f96-4123bc85c7b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmyLLB", ",", "my"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Alpha]L", "\[Rule]", "alphaL"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.859459650430243*^9, 3.8594596521206293`*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"0a310f08-4091-4d68-a5f3-9b182cb10b78"],

Cell["\<\
(alphaL*g0*(Power(mx,4) + 5*Power(my,4) + 6*Power(my,2)*Power(mz,2) + \
Power(mz,4) + 2*Power(mx,2)*(3*Power(my,2) + Power(mz,2)) - fD*(Power(mx,2) + \
3*Power(my,2) + Power(mz,2)))*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859459652735564*^9, 3.859459731692215*^9, 3.85952167412064*^9, {
   3.8725848236949587`*^9, 3.872584850473963*^9}},
 CellLabel->
  "Out[195]//CForm=",ExpressionUUID->"c473c0e0-6699-44b4-9e85-fc7e7a96edda"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmzLLB", ",", "mz"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Alpha]L", "\[Rule]", "alphaL"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.8594597400847387`*^9, 3.859459741676443*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"3eff5563-cb2c-44cf-b3de-9f023befeed4"],

Cell["\<\
(alphaL*g0*(Power(mx,4) + Power(my,4) + 6*Power(my,2)*Power(mz,2) + \
5*Power(mz,4) + 2*Power(mx,2)*(Power(my,2) + 3*Power(mz,2)) - fD*(Power(mx,2) \
+ Power(my,2) + 3*Power(mz,2)))*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859459742266468*^9, 3.8595216741669493`*^9, {3.872584823714334*^9, 
   3.872584850495018*^9}},
 CellLabel->
  "Out[196]//CForm=",ExpressionUUID->"9bf9d5e3-4d6e-4abe-b9d6-4165e8ec352f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Off-diagonal jacobians:", "Subsection",
 CellChangeTimes->{{3.859459940489506*^9, 
  3.859459942617195*^9}},ExpressionUUID->"8580b13e-2b95-4d51-ad12-\
11c49649dc40"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmxLLB", ",", "my"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Alpha]L", "\[Rule]", "alphaL"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{3.859459948953384*^9},
 CellLabel->
  "In[197]:=",ExpressionUUID->"58d0c153-d859-4903-accd-4ec051746ec6"],

Cell["\<\
(2*alphaL*g0*mx*my*(-fD + 2*(Power(mx,2) + Power(my,2) + \
Power(mz,2)))*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859459949128191*^9, 3.859521674208013*^9, {3.872584823732889*^9, 
   3.872584850515287*^9}},
 CellLabel->
  "Out[197]//CForm=",ExpressionUUID->"a111bf73-8057-42c3-8039-caed237eb162"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmxLLB", ",", "mz"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Alpha]L", "\[Rule]", "alphaL"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{3.859459953725856*^9},
 CellLabel->
  "In[198]:=",ExpressionUUID->"13d4261b-227f-4c74-bd1b-616629baae11"],

Cell["\<\
(2*alphaL*g0*mx*mz*(-fD + 2*(Power(mx,2) + Power(my,2) + \
Power(mz,2)))*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.8594599539455976`*^9, 3.859521674245929*^9, {3.872584823751*^9, 
   3.8725848505357723`*^9}},
 CellLabel->
  "Out[198]//CForm=",ExpressionUUID->"4e73a08a-fd0b-4411-a297-4af965ff740e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmyLLB", ",", "mx"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Alpha]L", "\[Rule]", "alphaL"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.859459957937682*^9, 3.8594599599364443`*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"4cb33dc1-ebc3-4a80-97a7-477e6d5570e3"],

Cell["\<\
(2*alphaL*g0*mx*my*(-fD + 2*(Power(mx,2) + Power(my,2) + \
Power(mz,2)))*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.8594599601750183`*^9, 3.859521674298973*^9, {3.872584823768858*^9, 
   3.8725848505561438`*^9}},
 CellLabel->
  "Out[199]//CForm=",ExpressionUUID->"868f5e24-a981-4dc5-9304-9883ceaf7e1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmyLLB", ",", "mz"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Alpha]L", "\[Rule]", "alphaL"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.859459965177228*^9, 3.859459966872431*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"385c3122-965c-435d-9249-d4976df4a3bd"],

Cell["\<\
(2*alphaL*g0*my*mz*(-fD + 2*(Power(mx,2) + Power(my,2) + \
Power(mz,2)))*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859459967396194*^9, 3.859521674351244*^9, {3.872584823787879*^9, 
   3.8725848505765257`*^9}},
 CellLabel->
  "Out[200]//CForm=",ExpressionUUID->"4a1f1915-d197-4016-8780-f5ca43ad1d0a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmzLLB", ",", "mx"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Alpha]L", "\[Rule]", "alphaL"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.859459969992536*^9, 3.859459972120645*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"a5cb0eb2-3f0e-4d54-a510-ff066cf63d8e"],

Cell["\<\
(2*alphaL*g0*mx*mz*(-fD + 2*(Power(mx,2) + Power(my,2) + \
Power(mz,2)))*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859459972671113*^9, 3.859521674390359*^9, {3.8725848238055153`*^9, 
   3.872584850597473*^9}},
 CellLabel->
  "Out[201]//CForm=",ExpressionUUID->"96dac7e5-d0e6-4b3a-934b-4ce7999cb75c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"D", "[", 
      RowBox[{"RHSmzLLB", ",", "my"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
      RowBox[{"\[Alpha]L", "\[Rule]", "alphaL"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "g0"}], ",", 
      RowBox[{"\[Psi]h", "\[Rule]", "test"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}]}], "}"}]}], "//", "Simplify"}], "//",
   "CForm"}]], "Input",
 CellChangeTimes->{{3.859459975216525*^9, 3.859459977040339*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"292dd7e6-d297-4935-9dd9-3d8fdcf708b4"],

Cell["\<\
(2*alphaL*g0*my*mz*(-fD + 2*(Power(mx,2) + Power(my,2) + \
Power(mz,2)))*phi*test)/(1 + Power(alpha,2))\
\>", "Output",
 CellChangeTimes->{
  3.859459977255478*^9, 3.859521674422526*^9, {3.872584823823627*^9, 
   3.8725848506180143`*^9}},
 CellLabel->
  "Out[202]//CForm=",ExpressionUUID->"1550cde0-f2a2-45da-bf65-9d6470d40ed3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1853, 1025},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.05,
FrontEndVersion->"12.2 for Linux x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"85de1294-fbef-4ec8-9d21-a3fe631e3a49"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 193, 3, 103, "Title",ExpressionUUID->"b1d4c808-667c-4a76-be0e-3eee3380e1cf"],
Cell[776, 27, 474, 11, 82, "Text",ExpressionUUID->"110f759c-6548-4f15-a00a-63ae774c6c75"],
Cell[1253, 40, 131, 1, 30, "Input",ExpressionUUID->"ef8787c2-4a7e-49a9-a94e-6e3991f1fe2e"],
Cell[CellGroupData[{
Cell[1409, 45, 151, 3, 69, "Section",ExpressionUUID->"11689daf-6785-46d4-89b4-665b43f142d5"],
Cell[CellGroupData[{
Cell[1585, 52, 223, 5, 56, "Subsection",ExpressionUUID->"4dc54554-7017-4242-bcce-9158a4fbb020"],
Cell[1811, 59, 145, 3, 30, "Input",ExpressionUUID->"5de1d9ef-9d2a-4102-89bb-b72ffda9273e"],
Cell[1959, 64, 372, 9, 30, "Input",ExpressionUUID->"e5631bb1-a1c2-4477-a92d-85b34321fb4c"],
Cell[2334, 75, 468, 12, 97, "Input",ExpressionUUID->"8e1dfe9e-7b11-4f73-8bae-64e1e022391f"],
Cell[2805, 89, 735, 22, 54, "Input",ExpressionUUID->"b299619a-8a97-476f-a6a0-c614119e080d"],
Cell[3543, 113, 577, 14, 50, "Input",ExpressionUUID->"6df5ebc5-b8ab-4e50-a5d2-74b8863c4366"],
Cell[4123, 129, 625, 16, 50, "Input",ExpressionUUID->"f01a9b85-a01f-4e48-93fd-2444c0e6e3e1"],
Cell[4751, 147, 840, 23, 54, "Input",ExpressionUUID->"5fe40bfb-2fef-4339-ac73-7866f294f5e8"],
Cell[5594, 172, 835, 22, 54, "Input",ExpressionUUID->"7283f081-9806-4ab5-ac51-26feeb16dfaa"],
Cell[CellGroupData[{
Cell[6454, 198, 960, 24, 119, "Input",ExpressionUUID->"bf3ca1a3-3a60-4bf5-9ecc-18bca928e532"],
Cell[7417, 224, 463, 11, 43, "Output",ExpressionUUID->"fd82359e-a794-4646-b0ce-57a73f7e3b32"],
Cell[7883, 237, 335, 7, 39, "Output",ExpressionUUID->"eabe6480-ca1e-4e37-9a9a-83c829d13f07"],
Cell[8221, 246, 440, 9, 39, "Output",ExpressionUUID->"ac931b9b-f704-4bbe-829e-8f302e68447e"],
Cell[8664, 257, 472, 11, 43, "Output",ExpressionUUID->"5e6e0fbc-235e-4d28-8a05-bcf45e4b4c77"],
Cell[9139, 270, 518, 12, 59, "Output",ExpressionUUID->"1cc9dd65-3dc9-4164-8904-9d40f4669ab0"]
}, Open  ]],
Cell[9672, 285, 143, 3, 30, "Input",ExpressionUUID->"9f61f668-0147-4a01-af07-8924240f6b35"],
Cell[CellGroupData[{
Cell[9840, 292, 235, 7, 32, "Input",ExpressionUUID->"1b502d9e-b0e0-4073-a45a-3668c05bde66"],
Cell[10078, 301, 132, 2, 35, "Output",ExpressionUUID->"bf82e5b9-70ae-495c-a981-0bd076f80df9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10247, 308, 184, 5, 30, "Input",ExpressionUUID->"a1b5d7d9-6032-4f53-b72c-21c999612009"],
Cell[10434, 315, 120, 2, 35, "Output",ExpressionUUID->"fd2a2428-226f-45e4-8d5b-eb5eab7ea18b"]
}, Open  ]],
Cell[10569, 320, 137, 3, 30, "Input",ExpressionUUID->"424ee684-ab17-447a-8d91-5938f49c4cb9"],
Cell[10709, 325, 1790, 49, 128, "Text",ExpressionUUID->"f4b42951-5b7a-47c4-a3a9-866c6d9a7dd0"],
Cell[CellGroupData[{
Cell[12524, 378, 951, 24, 52, "Input",ExpressionUUID->"83b02485-a9e4-4397-aaca-28b861c93319"],
Cell[13478, 404, 455, 10, 43, "Output",ExpressionUUID->"6194acd1-2dd2-4276-8e25-338265cee040"]
}, Open  ]],
Cell[13948, 417, 368, 10, 35, "Text",ExpressionUUID->"a1cd8488-fbc4-4878-b308-ee9be3954731"],
Cell[14319, 429, 706, 17, 37, "Text",ExpressionUUID->"cd1a1f84-b278-48ac-99cc-95e0d56d8a3a"],
Cell[CellGroupData[{
Cell[15050, 450, 644, 14, 52, "Input",ExpressionUUID->"f2913074-e4a8-41e5-833f-227d2201c680"],
Cell[15697, 466, 576, 10, 37, "Output",ExpressionUUID->"080fb5fb-7c49-4a5c-8275-65ce19fbc5ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16310, 481, 375, 10, 48, "Input",ExpressionUUID->"c1ad1b48-5cf6-4d61-bf8b-5b0622817f86"],
Cell[16688, 493, 211, 5, 37, "Output",ExpressionUUID->"c7b3efa8-3667-40eb-b24b-052db7aa5b14"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16936, 503, 213, 4, 30, "Input",ExpressionUUID->"56edd4be-64ab-4958-856e-5f57341bddce"],
Cell[17152, 509, 218, 4, 35, "Output",ExpressionUUID->"8446a9ca-cf45-4848-b82a-97800013c68b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17431, 520, 2820, 98, 647, "Section",ExpressionUUID->"d355d6c2-72ae-4ea8-8b0f-e60c31ec1a31"],
Cell[20254, 620, 504, 13, 47, "Input",ExpressionUUID->"17e2b380-56f4-4a19-ae4d-2e67a6ea0b31"],
Cell[20761, 635, 633, 18, 33, "Input",ExpressionUUID->"f2a69dac-c470-4b36-9787-b94de262e29f"],
Cell[21397, 655, 578, 16, 48, "Input",ExpressionUUID->"31a3b1bb-41dd-4158-9d10-3eab5ad72657"],
Cell[21978, 673, 328, 9, 30, "Input",ExpressionUUID->"64f91974-b2f9-4fb6-b8ac-9decc47a1d74"],
Cell[22309, 684, 1138, 30, 75, "Input",ExpressionUUID->"40f02382-9ef1-4b23-9f09-e5e95b1d6624"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23484, 719, 4817, 148, 332, "Section",ExpressionUUID->"0a438f6a-5d79-4b74-9cf3-285a7cfd43a9"],
Cell[28304, 869, 357, 10, 35, "Text",ExpressionUUID->"7b211a04-fbc0-44ca-8a3b-67d4a22c0cd5"],
Cell[28664, 881, 1319, 38, 56, "Input",ExpressionUUID->"280cb465-dbe6-4bfd-bab9-c1e9407745b1"],
Cell[29986, 921, 216, 5, 35, "Text",ExpressionUUID->"c8d8b607-7e7e-45a1-8803-1dc857a452b6"],
Cell[30205, 928, 806, 23, 75, "Input",ExpressionUUID->"f3672422-c990-4aeb-88cf-4803ae76acbc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31048, 956, 388, 6, 69, "Section",ExpressionUUID->"4e17a656-4869-4b0b-b420-423d1550e587"],
Cell[CellGroupData[{
Cell[31461, 966, 157, 3, 56, "Subsection",ExpressionUUID->"de15b82c-d17a-4b6d-9e68-f5e208dee1ef"],
Cell[31621, 971, 784, 22, 75, "Input",ExpressionUUID->"a935048d-438e-418a-9e38-7b5bf80b52f0"],
Cell[CellGroupData[{
Cell[32430, 997, 446, 12, 30, "Input",ExpressionUUID->"ee2884a2-5174-4d04-971d-0d57f6f4ea61"],
Cell[32879, 1011, 277, 6, 35, "Output",ExpressionUUID->"8603e4a3-0635-4e73-92c0-1212086fd5be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33193, 1022, 472, 12, 30, "Input",ExpressionUUID->"3e2d5ecc-1b84-4c67-97ce-69ed701c7283"],
Cell[33668, 1036, 411, 8, 35, "Output",ExpressionUUID->"d75ea569-f17e-4a08-838c-d084ae62b928"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34116, 1049, 470, 12, 30, "Input",ExpressionUUID->"94b1b503-3fbf-445e-8eb0-2005220eceae"],
Cell[34589, 1063, 415, 9, 35, "Output",ExpressionUUID->"3b8d4905-32e9-49ef-94ce-63128f8ca1a1"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[35053, 1078, 174, 3, 39, "Subsection",ExpressionUUID->"8d5e5a70-b701-45a9-82b3-5d68156ff092"],
Cell[CellGroupData[{
Cell[35252, 1085, 597, 16, 30, "Input",ExpressionUUID->"42a7355f-9ea2-433a-b909-3d8fd3541728"],
Cell[35852, 1103, 461, 9, 35, "Output",ExpressionUUID->"38700df3-40db-4067-8fac-21e5611b0569"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36350, 1117, 597, 16, 30, "Input",ExpressionUUID->"e8dc736d-3b67-44d6-bcc2-9579e92887d4"],
Cell[36950, 1135, 455, 9, 35, "Output",ExpressionUUID->"17c0e263-c276-4d18-bfce-2be90bc2c0c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37442, 1149, 597, 16, 30, "Input",ExpressionUUID->"276fc0c4-8a21-4bc1-b77c-b295a5b9ceb6"],
Cell[38042, 1167, 456, 9, 35, "Output",ExpressionUUID->"ef9833ed-1592-4da0-985d-9d97fa86d505"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[38547, 1182, 171, 3, 39, "Subsection",ExpressionUUID->"40e59f93-19cb-4fd1-9e28-c0dde996cfd4"],
Cell[CellGroupData[{
Cell[38743, 1189, 599, 16, 30, "Input",ExpressionUUID->"134f4c61-b532-493a-a17d-a3549ddf9d1f"],
Cell[39345, 1207, 510, 10, 35, "Output",ExpressionUUID->"0b1478b5-2cc4-439b-9c4b-a5bf010b90d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39892, 1222, 573, 16, 30, "Input",ExpressionUUID->"0c9c2095-1058-48f1-9577-c8fdae7dfb79"],
Cell[40468, 1240, 499, 10, 35, "Output",ExpressionUUID->"8af22149-b13f-41f0-996b-aa45815b3112"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41004, 1255, 597, 16, 30, "Input",ExpressionUUID->"ee2567c1-1ba4-475f-84da-a275d13bb93a"],
Cell[41604, 1273, 459, 9, 35, "Output",ExpressionUUID->"496c0a1c-8d4d-42fd-9556-3c3622ec700f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42100, 1287, 599, 16, 30, "Input",ExpressionUUID->"4eadc4ca-75c1-4296-be25-67ef9fe9587a"],
Cell[42702, 1305, 458, 9, 35, "Output",ExpressionUUID->"e926918e-6317-4427-bbea-887457bf0677"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43197, 1319, 601, 16, 30, "Input",ExpressionUUID->"175eae89-3ced-4830-9540-260789df7356"],
Cell[43801, 1337, 514, 10, 35, "Output",ExpressionUUID->"061fa181-e40c-4bbc-8f08-002ffc14d8c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44352, 1352, 575, 16, 30, "Input",ExpressionUUID->"1c1153b7-8dc7-465a-8cec-e6d16526e42c"],
Cell[44930, 1370, 516, 10, 35, "Output",ExpressionUUID->"f81eeedb-81a7-45e6-ad65-e6a872e21ef8"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45507, 1387, 428, 13, 69, "Section",ExpressionUUID->"1eb70cb9-3f6b-478b-8701-8e5b2f9099d7"],
Cell[CellGroupData[{
Cell[45960, 1404, 158, 3, 56, "Subsection",ExpressionUUID->"f97e0d79-c179-4b75-9faa-2f019990f666"],
Cell[46121, 1409, 731, 21, 75, "Input",ExpressionUUID->"e8540ff3-45b4-4e6a-a5ef-845c75c12e3b"],
Cell[CellGroupData[{
Cell[46877, 1434, 657, 15, 30, "Input",ExpressionUUID->"2b8cd4b0-ae56-47e2-ab49-704fe410f31c"],
Cell[47537, 1451, 392, 7, 35, "Output",ExpressionUUID->"13c37e15-d5e2-4812-a83d-957a619ba97f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47966, 1463, 630, 15, 30, "Input",ExpressionUUID->"90115758-e8fe-46c7-a507-7592ce0ffefc"],
Cell[48599, 1480, 368, 8, 35, "Output",ExpressionUUID->"6f50c14b-1f9f-405d-a957-9e3c6a0e5769"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49004, 1493, 633, 15, 30, "Input",ExpressionUUID->"42642eeb-9930-4004-bda7-15f955b12d43"],
Cell[49640, 1510, 371, 8, 35, "Output",ExpressionUUID->"a37d4bda-0507-4d19-94b5-5238b5da4831"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[50060, 1524, 172, 3, 39, "Subsection",ExpressionUUID->"da3f382b-10b3-46d8-a2d6-57f533c78806"],
Cell[CellGroupData[{
Cell[50257, 1531, 743, 18, 30, "Input",ExpressionUUID->"acbd141b-9cc8-4338-8205-85bc1f2a0f79"],
Cell[51003, 1551, 302, 7, 98, "Output",ExpressionUUID->"ed0e39c9-47bf-4d17-956a-df987a4cdca0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51342, 1563, 745, 18, 30, "Input",ExpressionUUID->"774280cb-8c36-4f4b-b1a4-35088361336b"],
Cell[52090, 1583, 305, 7, 98, "Output",ExpressionUUID->"5e906ffc-7185-4114-acb9-78e0db94cbc8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52432, 1595, 743, 18, 30, "Input",ExpressionUUID->"b86db1df-f884-4c4a-b783-4c15d93143ac"],
Cell[53178, 1615, 307, 7, 98, "Output",ExpressionUUID->"a5d83837-6288-4b9a-897d-605c5c761828"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[53534, 1628, 742, 21, 44, "Subsection",ExpressionUUID->"1de30c6a-fe45-4c95-b5fb-e17b4ce58d41"],
Cell[CellGroupData[{
Cell[54301, 1653, 717, 18, 30, "Input",ExpressionUUID->"2018619b-2952-4035-92d0-0556eb8b2477"],
Cell[55021, 1673, 316, 8, 98, "Output",ExpressionUUID->"65cce769-73ab-4369-a0ae-b258aa8ee574"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55374, 1686, 717, 18, 30, "Input",ExpressionUUID->"f4f9f2d9-953f-4ad0-a407-f41277f0b002"],
Cell[56094, 1706, 321, 8, 98, "Output",ExpressionUUID->"c939176c-2f8d-47c6-bd35-22ad0dfceb10"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56452, 1719, 1590, 40, 30, "Input",ExpressionUUID->"36311f35-d897-4fbc-a58a-f8f681a47a41"],
Cell[58045, 1761, 443, 8, 98, "Output",ExpressionUUID->"f52ae2eb-c8d9-4da4-96c8-28ae60fb7540"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58525, 1774, 719, 18, 30, "Input",ExpressionUUID->"3f2b81b0-5ead-4300-9d91-e20b4c0a19fe"],
Cell[59247, 1794, 318, 8, 98, "Output",ExpressionUUID->"0e13cb4b-1fa5-4599-98d9-accb91d6c916"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59602, 1807, 743, 18, 30, "Input",ExpressionUUID->"65398c36-3309-44d8-934c-ef1dcda712e0"],
Cell[60348, 1827, 318, 8, 98, "Output",ExpressionUUID->"47902ad6-ad7c-4593-9716-8f07ab963f8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60703, 1840, 1517, 39, 30, "Input",ExpressionUUID->"9e6f6d89-7164-435e-a8d2-5ce9d6242ae7"],
Cell[62223, 1881, 364, 8, 98, "Output",ExpressionUUID->"4dddf281-79bd-45c4-8e28-768e166bbd12"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62624, 1894, 717, 18, 30, "Input",ExpressionUUID->"92cfe179-45fc-4437-a487-f4a76d560462"],
Cell[63344, 1914, 316, 8, 98, "Output",ExpressionUUID->"6e92c097-ef73-42f1-9ffd-0c4e59cae8f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63697, 1927, 743, 18, 30, "Input",ExpressionUUID->"611e02f7-1696-46c6-9154-d1759367971b"],
Cell[64443, 1947, 319, 8, 98, "Output",ExpressionUUID->"3e03fae0-65eb-4c7b-8a34-a76e57887ad5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64799, 1960, 1517, 39, 30, "Input",ExpressionUUID->"f79afbde-2e96-493f-bddd-49b8a63bcdfa"],
Cell[66319, 2001, 376, 8, 98, "Output",ExpressionUUID->"41fdabc7-6b3e-4809-8f36-42d70b5c48cf"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66756, 2016, 344, 5, 69, "Section",ExpressionUUID->"a32694f9-c5b7-4efd-b78f-ae77328d579d"],
Cell[CellGroupData[{
Cell[67125, 2025, 244, 7, 56, "Subsection",ExpressionUUID->"dfa0a66d-7dd6-4e7d-a0c4-974a6d44e042"],
Cell[67372, 2034, 5763, 173, 210, "Input",ExpressionUUID->"cbbd652b-9f8a-44fb-9ee6-afcf9fbe27ad"],
Cell[73138, 2209, 4598, 125, 295, "Input",ExpressionUUID->"4ea5bfa2-6ad1-4035-b345-d99b7f067e86"],
Cell[77739, 2336, 1600, 42, 75, "Input",ExpressionUUID->"bd920eb9-2b7c-4bd4-8e70-979539a05f83"],
Cell[79342, 2380, 1602, 42, 75, "Input",ExpressionUUID->"832d129f-b215-49a7-9cf0-52b60d739b3e"],
Cell[80947, 2424, 1572, 41, 75, "Input",ExpressionUUID->"8bee1671-e851-4bfe-8aae-76b6746a07d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82556, 2470, 158, 3, 56, "Subsection",ExpressionUUID->"986a0533-0a41-4a5b-ad62-94b97b8be7d4"],
Cell[CellGroupData[{
Cell[82739, 2477, 633, 14, 30, "Input",ExpressionUUID->"b6697560-6ccb-4395-bd06-94e7b931137d"],
Cell[83375, 2493, 918, 16, 123, "Output",ExpressionUUID->"c1f0cb20-7a1d-4fca-bb54-9825547cf85f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84330, 2514, 639, 15, 30, "Input",ExpressionUUID->"6583db58-0939-4282-82fb-033cb5d69a40"],
Cell[84972, 2531, 1103, 20, 90, "Output",ExpressionUUID->"4f2fc5ae-0481-4f52-96c9-acfd60189b4f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86112, 2556, 571, 14, 30, "Input",ExpressionUUID->"f1732d53-ef7c-4167-8b9b-272a718276d1"],
Cell[86686, 2572, 1093, 20, 90, "Output",ExpressionUUID->"a6bbf3a2-0364-4d18-876c-a9d76938e5a6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87828, 2598, 170, 3, 56, "Subsection",ExpressionUUID->"1090829e-b661-410c-8e30-702a670b5b46"],
Cell[CellGroupData[{
Cell[88023, 2605, 818, 21, 30, "Input",ExpressionUUID->"f10697c5-db2e-44f7-b4eb-d98388ece053"],
Cell[88844, 2628, 906, 15, 98, "Output",ExpressionUUID->"ff91e447-6ad7-4da2-9e2b-905e3ee3391a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89787, 2648, 772, 20, 30, "Input",ExpressionUUID->"0d371c4c-47e0-461f-a15c-e8577d08a6af"],
Cell[90562, 2670, 887, 16, 98, "Output",ExpressionUUID->"dabd2338-305d-4fd0-a209-aebea39edbe2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91486, 2691, 770, 20, 30, "Input",ExpressionUUID->"b1c4710d-a3f9-4d88-8ff6-5961faff1e43"],
Cell[92259, 2713, 884, 16, 98, "Output",ExpressionUUID->"292467f4-7d42-4f7a-ba5f-4a9592e298c4"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[93192, 2735, 171, 3, 39, "Subsection",ExpressionUUID->"26928bba-00cb-4fa5-a625-8a6cef5c3f7e"],
Cell[CellGroupData[{
Cell[93388, 2742, 770, 20, 30, "Input",ExpressionUUID->"17b2bbd8-af26-45c5-96df-da6b14380108"],
Cell[94161, 2764, 876, 16, 98, "Output",ExpressionUUID->"9b243ce4-38fa-4cf0-aae0-94bf72876c43"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95074, 2785, 746, 20, 30, "Input",ExpressionUUID->"85d727c5-1390-4c5c-84e3-3e3e64b4d63f"],
Cell[95823, 2807, 930, 17, 98, "Output",ExpressionUUID->"d6ec4455-6fe4-4ceb-9ac8-d36389a0ac53"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96790, 2829, 770, 20, 30, "Input",ExpressionUUID->"df639213-dbb9-44c9-8e3e-38d1302ecb25"],
Cell[97563, 2851, 883, 16, 98, "Output",ExpressionUUID->"603c5527-b331-43ce-a921-ab818aea8896"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98483, 2872, 748, 20, 30, "Input",ExpressionUUID->"fb659ac5-49c0-4cb3-b9f1-7048591d054c"],
Cell[99234, 2894, 937, 17, 98, "Output",ExpressionUUID->"849ed472-ed34-4e64-bd34-6313493315cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100208, 2916, 770, 20, 30, "Input",ExpressionUUID->"0dc53e7a-34e4-462a-917f-65a1a342654a"],
Cell[100981, 2938, 943, 17, 98, "Output",ExpressionUUID->"027b1608-cb5c-4120-93f5-fa9e80119a26"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101961, 2960, 770, 20, 30, "Input",ExpressionUUID->"1b77f486-d679-4c60-a45b-c21f3568e3bd"],
Cell[102734, 2982, 940, 17, 98, "Output",ExpressionUUID->"d9812a0a-92ea-48b2-a357-607902596061"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[103735, 3006, 1690, 47, 200, "Section",ExpressionUUID->"9f77809f-e1df-4754-8cd6-194cbc49760c"],
Cell[CellGroupData[{
Cell[105450, 3057, 158, 3, 56, "Subsection",ExpressionUUID->"51ffd352-12ff-4714-a46c-f27c7cb89911"],
Cell[105611, 3062, 2239, 69, 156, "Input",ExpressionUUID->"fe5b5e11-56b4-4299-ac48-3b4a69b7355b"],
Cell[CellGroupData[{
Cell[107875, 3135, 618, 15, 30, "Input",ExpressionUUID->"9d32bed6-b971-4a8d-a091-cc57b18a176d"],
Cell[108496, 3152, 487, 9, 98, "Output",ExpressionUUID->"b981019f-5134-4350-9366-c073a7599bea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109020, 3166, 539, 14, 30, "Input",ExpressionUUID->"d933a493-4a5c-4725-9c60-83872918aa32"],
Cell[109562, 3182, 411, 8, 98, "Output",ExpressionUUID->"fffa54ad-e0bb-44a3-ab18-43f960485d10"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110010, 3195, 539, 14, 30, "Input",ExpressionUUID->"294ce66d-9767-4f68-bdd2-0810746a4cd4"],
Cell[110552, 3211, 409, 8, 98, "Output",ExpressionUUID->"99a11f05-5e98-498a-aee8-0fe051ba8558"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[111010, 3225, 171, 3, 39, "Subsection",ExpressionUUID->"fc89db7b-7991-4675-8271-d1a43b075e22"],
Cell[CellGroupData[{
Cell[111206, 3232, 654, 17, 30, "Input",ExpressionUUID->"2e87fabd-65e9-4f2b-92d7-d56be6c89e35"],
Cell[111863, 3251, 495, 9, 98, "Output",ExpressionUUID->"d3b89a94-47bc-41c4-9f96-4123bc85c7b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112395, 3265, 654, 17, 30, "Input",ExpressionUUID->"0a310f08-4091-4d68-a5f3-9b182cb10b78"],
Cell[113052, 3284, 468, 9, 98, "Output",ExpressionUUID->"c473c0e0-6699-44b4-9e85-fc7e7a96edda"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113557, 3298, 654, 17, 30, "Input",ExpressionUUID->"3eff5563-cb2c-44cf-b3de-9f023befeed4"],
Cell[114214, 3317, 447, 9, 98, "Output",ExpressionUUID->"9bf9d5e3-4d6e-4abe-b9d6-4165e8ec352f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[114710, 3332, 171, 3, 39, "Subsection",ExpressionUUID->"8580b13e-2b95-4d51-ad12-11c49649dc40"],
Cell[CellGroupData[{
Cell[114906, 3339, 628, 17, 30, "Input",ExpressionUUID->"58d0c153-d859-4903-accd-4ec051746ec6"],
Cell[115537, 3358, 336, 8, 35, "Output",ExpressionUUID->"a111bf73-8057-42c3-8039-caed237eb162"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115910, 3371, 628, 17, 30, "Input",ExpressionUUID->"13d4261b-227f-4c74-bd1b-616629baae11"],
Cell[116541, 3390, 337, 8, 35, "Output",ExpressionUUID->"4e73a08a-fd0b-4411-a297-4af965ff740e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116915, 3403, 654, 17, 30, "Input",ExpressionUUID->"4cb33dc1-ebc3-4a80-97a7-477e6d5570e3"],
Cell[117572, 3422, 340, 8, 35, "Output",ExpressionUUID->"868f5e24-a981-4dc5-9304-9883ceaf7e1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117949, 3435, 652, 17, 30, "Input",ExpressionUUID->"385c3122-965c-435d-9249-d4976df4a3bd"],
Cell[118604, 3454, 338, 8, 35, "Output",ExpressionUUID->"4a1f1915-d197-4016-8780-f5ca43ad1d0a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118979, 3467, 652, 17, 30, "Input",ExpressionUUID->"a5cb0eb2-3f0e-4d54-a510-ff066cf63d8e"],
Cell[119634, 3486, 338, 8, 35, "Output",ExpressionUUID->"96dac7e5-d0e6-4b3a-934b-4ce7999cb75c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120009, 3499, 652, 17, 30, "Input",ExpressionUUID->"292dd7e6-d297-4935-9dd9-3d8fdcf708b4"],
Cell[120664, 3518, 338, 8, 35, "Output",ExpressionUUID->"1550cde0-f2a2-45da-bf65-9d6470d40ed3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

