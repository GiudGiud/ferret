# RotostrictiveCouplingDistortDerivative

!syntax description /Kernels/RotostrictiveCouplingDistortDerivative

## Overview

Computes the residual and jacobian contributions corresponding microforces generated by variations of oxygen octahedral antiphase tilt $\mathbf{A}$ of the rotostrictive free energy density $f_\mathrm{rotostr}$. The governing time-dependent equation of relaxation of the structural order is given by,

\begin{equation}
 \begin{aligned}
   \frac{\partial \mathbf{A}}{\partial t} = - \Gamma_A \frac{\delta f}{\delta \mathbf{A}},
 \end{aligned}
\end{equation}

and we look for variational derivatives of

\begin{equation}
 \begin{aligned}
 f_\mathrm{rotostr} &= r_{11} \left(A_x^2 \varepsilon_{xx} + A_y^2 \varepsilon_{yy} + A_z^2 \varepsilon_{zz}\right) \\
 &+ r_{12} \left[ \left(A_x^2 + A_y^2\right) \varepsilon_{zz} + \left(A_y^2 + A_z^2\right) \varepsilon_{xx} + \left(A_x^2 + A_z^2\right) \varepsilon_{yy}\right] \\
 &+ r_{44} \left(A_x A_y \varepsilon_{yx} + A_x A_z \varepsilon_{xz} + A_y A_z \varepsilon_{yz}\right),
 \end{aligned}
\end{equation}

suitable for cubic parent phase ferroelectric materials (i.e. $\mathrm{PbTiO}_3$ and $\mathrm{BaTiO}_3$). The coefficients $r_{11}, r_{12}$, and $r_{44}$ are the rotostrictive tensor components (in Voight notation). We can write this index notation,

\begin{equation}
 \begin{aligned}
 f_\mathrm{rotostr} &= r_{ijkl} A_i A_j \varepsilon_{kl}
 \end{aligned}
\end{equation}

Note that for the variational derivative,

\begin{equation}
 \begin{aligned}
   \frac{\delta f_\mathrm{rotostr}}{\delta \mathbf{P}} = \frac{\partial f_\mathrm{rotostr}}{\partial \mathbf{P}} - \frac{\partial}{\partial \mathbf{r}} \cdot \frac{\partial f}{\left(\frac{\partial \mathbf{P}}{\partial \mathbf{r}}\right)}
 \end{aligned}
\end{equation}

only the first term is important because there are no explicit gradients in $\mathbf{P}$. Therefore, we have after multiplying the TDLGD equation by a test function $\psi_h$ and integrating on both sides, in index notation we have,

\begin{equation}
 \begin{aligned}
   \left(\psi_h,\frac{\delta f_\mathrm{rotostr}}{\delta A_\beta}\right) = \left(\psi_h,\frac{\partial \left(r_{ijkl} A_i A_j \varepsilon_{kl}\right)}{\partial A_\beta}\right) &= 0 \\
   = \left(\psi_h, 2 r_{ijkl} \delta_{i\beta} A_j \varepsilon_{kl}\right) &= 0\\
   = \left(\psi_h, 2 r_{\beta jkl} A_j \varepsilon_{kl}\right) &= 0
 \end{aligned}
\end{equation}

Note that we ignore the time derivative as it is handled by another `Kernel`. This is our residual contribution for $A_\beta$.

\begin{equation}
 \begin{aligned}
    \mathcal{R}_{A_\beta} = \left(\psi_h, 2 r_{\beta jkl} A_j \varepsilon_{kl}\right)
 \end{aligned}
\end{equation}

Next we need the on-diagonal jacobian contribution,

\begin{equation}
 \begin{aligned}
    \mathcal{J}_{A_\beta, A_\beta} &= \frac{\partial \mathcal{R}_{A_\beta}}{\partial A_\beta} \\
    &= \left(\psi_h, 2 \phi \, r_{\beta \beta kl} \varepsilon_{kl}\right)
 \end{aligned}
\end{equation}

where $\phi$ is a shape function of the finite element method. To compute the off-diagonal jacobian contributions, we have

\begin{equation}
 \begin{aligned}
    \mathcal{J}_{A_\beta, A_\gamma} &= \frac{\partial \mathcal{R}_{A_\beta}}{\partial A_\gamma} \\
    &= \left(\psi_h, 2 \phi \, r_{\beta \gamma kl} \varepsilon_{kl}\right).
 \end{aligned}
\end{equation}

Rewriting the strain in terms of the symmetric and antisymmetric derivatives of the elastic displacement, we have

\begin{equation}
 \begin{aligned}
    \mathcal{J}_{A_\beta, u_\gamma} = \frac{\partial \mathcal{R}_{A_\beta}}{\partial u_\gamma} &= \frac{\partial}{\partial u_\gamma }\left(\psi_h, r_{\beta jkl} A_j \left[\frac{\partial u_k}{\partial x_l} + \frac{\partial u_l}{\partial x_k}\right]\right)\\
    &= \left(\psi_h, A_j \left[ r_{\beta jkl} \delta_{k\gamma}\frac{\partial \phi}{\partial x_l} + r_{\beta jkl} \delta_{l\gamma} \frac{\partial \phi}{\partial x_k}\right]\right) \\
    &= \left(\psi_h, A_j \left[ r_{\beta j\gamma l} \frac{\partial \phi}{\partial x_l} + r_{\beta jk\gamma } \frac{\partial \phi}{\partial x_k}\right]\right)
 \end{aligned}
\end{equation}

with again using the fact that $\partial \frac{\partial u_i}{\partial x_l} / \partial u_j = \delta_{ij} \frac{\partial \phi}{\partial x_l}$ with $\delta_{ij}$ the Kronecker product. This `Kernel` is hard-coded currently).The residual vector components, in Voight notation for a cubic symmetry parent phase ferroelectric, are,

\begin{equation}
 \begin{aligned}
    \mathcal{R}_{A_x} &=\\
    \mathcal{R}_{A_y} &=\\
    \mathcal{R}_{A_z} &=
 \end{aligned}
\end{equation}

and

\begin{equation}
 \begin{aligned}
    \mathcal{J}_{A_x,A_x} &= \\
    \mathcal{J}_{A_x,A_y} &=\\
    \mathcal{J}_{A_x,A_z} &=\\
    \mathcal{J}_{A_y,A_x} &=\\
    \mathcal{J}_{A_y,A_y} &=\\
    \mathcal{J}_{A_y,A_z} &=\\
    \mathcal{J}_{A_z,A_x} &=\\
    \mathcal{J}_{A_z,A_y} &=\\
    \mathcal{J}_{A_z,A_z} &=
 \end{aligned}
\end{equation}

## Example Input File Syntax

!! Describe and include an example of how to use the RotostrictiveCouplingDistortDerivative object.

!syntax parameters /Kernels/RotostrictiveCouplingDistortDerivative

!syntax inputs /Kernels/RotostrictiveCouplingDistortDerivative

!syntax children /Kernels/RotostrictiveCouplingDistortDerivative
