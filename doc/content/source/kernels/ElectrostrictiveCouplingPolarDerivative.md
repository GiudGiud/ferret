# ElectrostrictiveCouplingPolarDerivative

!syntax description /Kernels/ElectrostrictiveCouplingPolarDerivative

## Overview

Computes the residual and jacobian contributions corresponding microforces generated by variations of polarization $\mathbf{P}$ of the electrostrictive free energy density $f_\mathrm{elecstr}$. The governing time-dependent Landau-Ginzburg-Devonshire (TDLGD) equation of relaxation of the ferroelectric order is given by,

\begin{equation}
 \begin{aligned}
   \frac{\partial \mathbf{P}}{\partial t} = - \Gamma_P \frac{\delta f}{\delta \mathbf{P}},
 \end{aligned}
\end{equation}

and we look for variational derivatives of

\begin{equation}
 \begin{aligned}
 f_\mathrm{elecstr} &= q_{11} \left(P_x^2 \varepsilon_{xx} + P_y^2 \varepsilon_{yy} + P_z^2 \varepsilon_{zz}\right) \\
 &+ q_{12} \left[ \left(P_x^2 + P_y^2\right) \varepsilon_{zz} + \left(P_y^2 + P_z^2\right) \varepsilon_{xx} + \left(P_x^2 + P_z^2\right) \varepsilon_{yy}\right] \\
 &+ q_{44} \left(P_x P_y \varepsilon_{yx} + P_x P_z \varepsilon_{xz} + P_y P_z \varepsilon_{yz}\right),
 \end{aligned}
\end{equation}

suitable for cubic parent phase ferroelectric materials (i.e. $\mathrm{PbTiO}_3$ and $\mathrm{BaTiO}_3$). The coefficients $q_{11}, q_{12}$, and $q_{44}$ are the electrostrictive tensor components (in Voight notation). We can write this index notation in general for any symmetry $q_{ijkl}$ tensor,

\begin{equation}
 \begin{aligned}
 f_\mathrm{elecstr} &= q_{ijkl} P_i P_j \varepsilon_{kl},
 \end{aligned}
\end{equation}

Note that for the variational derivative,

\begin{equation}
 \begin{aligned}
   \frac{\delta f_\mathrm{elecstr}}{\delta \mathbf{P}} = \frac{\partial f_\mathrm{elecstr}}{\partial \mathbf{P}} - \frac{\partial}{\partial \mathbf{r}} \cdot \frac{\partial f}{\left(\frac{\partial \mathbf{P}}{\partial \mathbf{r}}\right)}
 \end{aligned}
\end{equation}

only the first term is important because there are no explicit gradients in $\mathbf{P}$. Therefore, we have after multiplying the TDLGD equation by a test function $\psi_h$ and integrating on both sides, in index notation we have,

\begin{equation}
 \begin{aligned}
   \left(\psi_h,\frac{\delta f_\mathrm{elecstr}}{\delta P_\beta}\right) = \left(\psi_h,\frac{\partial \left(q_{ijkl} P_i P_j \varepsilon_{kl}\right)}{\partial P_\beta}\right) &= 0 \\
   = \left(\psi_h, 2 q_{ijkl} \delta_{i\beta} P_j \varepsilon_{kl}\right) &= 0\\
   = \left(\psi_h, 2 q_{\beta jkl} P_j \varepsilon_{kl}\right) &= 0
 \end{aligned}
\end{equation}

Note that we ignore the time derivative as it is handled by another `Kernel`. This is our residual contribution for $P_\beta$.

\begin{equation}
 \begin{aligned}
    \mathcal{R}_{P_\beta} = \left(\psi_h, 2 q_{\beta jkl} P_j \varepsilon_{kl}\right)
 \end{aligned}
\end{equation}

Next we need the on-diagonal jacobian contribution,

\begin{equation}
 \begin{aligned}
    \mathcal{J}_{P_\beta, P_\beta} &= \frac{\partial \mathcal{R}_{P_\beta}}{\partial P_\beta} \\
    &= \left(\psi_h, 2 \phi \, q_{\beta \beta kl} \varepsilon_{kl}\right)
 \end{aligned}
\end{equation}

where $\phi$ is a shape function of the finite element method. To compute the off-diagonal jacobian contributions, we have

\begin{equation}
 \begin{aligned}
    \mathcal{J}_{P_\beta, P_\gamma} &= \frac{\partial \mathcal{R}_{P_\beta}}{\partial P_\gamma} \\
    &= \left(\psi_h, 2 \phi \, q_{\beta \gamma kl} \varepsilon_{kl}\right).
 \end{aligned}
\end{equation}

Rewriting the strain in terms of the symmetric and antisymmetric derivatives of the elastic displacement, we have

\begin{equation}
 \begin{aligned}
    \mathcal{J}_{P_\beta, u_\gamma} = \frac{\partial \mathcal{R}_{P_\beta}}{\partial u_\gamma} &= \frac{\partial}{\partial u_\gamma }\left(\psi_h, q_{\beta jkl} P_j \left[\frac{\partial u_k}{\partial x_l} + \frac{\partial u_l}{\partial x_k}\right]\right)\\
    &= \left(\psi_h, P_j \left[ q_{\beta jkl} \delta_{k\gamma}\frac{\partial \phi}{\partial x_l} + q_{\beta jkl} \delta_{l\gamma} \frac{\partial \phi}{\partial x_k}\right]\right) \\
    &= \left(\psi_h, P_j \left[ q_{\beta j\gamma l} \frac{\partial \phi}{\partial x_l} + q_{\beta jk\gamma } \frac{\partial \phi}{\partial x_k}\right]\right)
 \end{aligned}
\end{equation}

with again using the fact that $\partial \frac{\partial u_i}{\partial x_l} / \partial u_j = \delta_{ij} \frac{\partial \phi}{\partial x_l}$ with $\delta_{ij}$ the Kronecker product. This `Kernel` is hard-coded currently).The residual vector components, in Voight notation for a cubic symmetry parent phase ferroelectric, are,

\begin{equation}
 \begin{aligned}
    \mathcal{R}_{P_x} &=\\
    \mathcal{R}_{P_y} &=\\
    \mathcal{R}_{P_z} &=
 \end{aligned}
\end{equation}

and

\begin{equation}
 \begin{aligned}
    \mathcal{J}_{P_x,P_x} &= \\
    \mathcal{J}_{P_x,P_y} &=\\
    \mathcal{J}_{P_x,P_z} &=\\
    \mathcal{J}_{P_y,P_x} &=\\
    \mathcal{J}_{P_y,P_y} &=\\
    \mathcal{J}_{P_y,P_z} &=\\
    \mathcal{J}_{P_z,P_x} &=\\
    \mathcal{J}_{P_z,P_y} &=\\
    \mathcal{J}_{P_z,P_z} &=
 \end{aligned}
\end{equation}

## Example Input File Syntax

!! Describe and include an example of how to use the ElectrostrictiveCouplingPolarDerivative object.

!syntax parameters /Kernels/ElectrostrictiveCouplingPolarDerivative

!syntax inputs /Kernels/ElectrostrictiveCouplingPolarDerivative

!syntax children /Kernels/ElectrostrictiveCouplingPolarDerivative
